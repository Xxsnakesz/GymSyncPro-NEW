{"file_contents":{"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/App.tsx":{"content":"import { Switch, Route, Redirect } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { CookieConsentBanner } from \"@/components/cookie-consent-banner\";\nimport { useEffect } from \"react\";\nimport Login from \"@/pages/login\";\nimport LoginAdmin from \"@/pages/login-admin\";\nimport Register from \"@/pages/register\";\nimport RegisterAdmin from \"@/pages/register-admin\";\nimport ForgotPassword from \"@/pages/forgot-password\";\nimport ResetPassword from \"@/pages/reset-password\";\nimport VerifyEmail from \"@/pages/verify-email\";\nimport MemberDashboard from \"@/pages/member-dashboard\";\nimport AdminOverview from \"@/pages/admin-overview\";\nimport AdminMembers from \"@/pages/admin-members\";\nimport AdminClasses from \"@/pages/admin-classes\";\nimport AdminTrainers from \"@/pages/admin-trainers\";\nimport AdminPlans from \"@/pages/admin-plans\";\nimport AdminCheckIns from \"@/pages/admin-checkins\";\nimport AdminFeedback from \"@/pages/admin-feedback\";\nimport AdminPTBookings from \"@/pages/admin-pt-bookings\";\nimport AdminPTSessions from \"@/pages/admin-pt-sessions\";\nimport AdminClassBookings from \"@/pages/admin-class-bookings\";\nimport Checkout from \"@/pages/checkout\";\nimport MyBookings from \"@/pages/my-bookings\";\nimport MyPtSessions from \"@/pages/my-pt-sessions\";\nimport CheckInVerify from \"@/pages/checkin-verify\";\nimport CookieSettings from \"@/pages/cookie-settings\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading, user } = useAuth();\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  return (\n    <Switch>\n      {/* Public routes */}\n      <Route path=\"/checkin/verify/:code\" component={CheckInVerify} />\n      <Route path=\"/cookie-settings\" component={CookieSettings} />\n      <Route path=\"/forgot-password\" component={ForgotPassword} />\n      <Route path=\"/reset-password\" component={ResetPassword} />\n      <Route path=\"/verify-email\" component={VerifyEmail} />\n      \n      {!isAuthenticated ? (\n        <>\n          <Route path=\"/login\" component={Login} />\n          <Route path=\"/login-admin\" component={LoginAdmin} />\n          <Route path=\"/register\" component={Register} />\n          <Route path=\"/register-admin\" component={RegisterAdmin} />\n          <Route path=\"/\">\n            <Redirect to=\"/login\" />\n          </Route>\n        </>\n      ) : (\n        <>\n          <Route path=\"/\" component={user?.role === 'admin' ? AdminOverview : MemberDashboard} />\n          <Route path=\"/admin\" component={AdminOverview} />\n          <Route path=\"/admin/members\" component={AdminMembers} />\n          <Route path=\"/admin/classes\" component={AdminClasses} />\n          <Route path=\"/admin/trainers\" component={AdminTrainers} />\n          <Route path=\"/admin/plans\" component={AdminPlans} />\n          <Route path=\"/admin/checkins\" component={AdminCheckIns} />\n          <Route path=\"/admin/feedback\" component={AdminFeedback} />\n          <Route path=\"/admin/pt-bookings\" component={AdminPTBookings} />\n          <Route path=\"/admin/pt-sessions\" component={AdminPTSessions} />\n          <Route path=\"/admin/class-bookings\" component={AdminClassBookings} />\n          <Route path=\"/checkout\" component={Checkout} />\n          <Route path=\"/my-bookings\" component={MyBookings} />\n          <Route path=\"/my-pt-sessions\" component={MyPtSessions} />\n          <Route path=\"/login\">\n            <Redirect to=\"/\" />\n          </Route>\n          <Route path=\"/login-admin\">\n            <Redirect to=\"/\" />\n          </Route>\n          <Route path=\"/register\">\n            <Redirect to=\"/\" />\n          </Route>\n          <Route path=\"/register-admin\">\n            <Redirect to=\"/\" />\n          </Route>\n        </>\n      )}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  useEffect(() => {\n    document.documentElement.classList.add('dark');\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n        <CookieConsentBanner />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":4482},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  /* Permanent Dark Navy Theme */\n  --background: hsl(225, 59%, 11%);\n  --foreground: hsl(0, 0%, 98%);\n  --card: hsl(225, 50%, 15%);\n  --card-foreground: hsl(0, 0%, 98%);\n  --popover: hsl(225, 55%, 13%);\n  --popover-foreground: hsl(0, 0%, 98%);\n  \n  /* Neon Green Primary */\n  --primary: hsl(142, 76%, 45%);\n  --primary-foreground: hsl(225, 59%, 11%);\n  \n  /* Secondary with purple tint */\n  --secondary: hsl(225, 45%, 20%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  \n  --muted: hsl(225, 40%, 18%);\n  --muted-foreground: hsl(0, 0%, 70%);\n  \n  /* Neon Purple Accent */\n  --accent: hsl(271, 76%, 60%);\n  --accent-foreground: hsl(0, 0%, 100%);\n  \n  /* Neon colors for highlights */\n  --neon-green: hsl(142, 76%, 50%);\n  --neon-purple: hsl(271, 80%, 65%);\n  \n  --destructive: hsl(0, 70%, 50%);\n  --destructive-foreground: hsl(0, 0%, 100%);\n  \n  --border: hsl(225, 40%, 25%);\n  --input: hsl(225, 40%, 20%);\n  --ring: hsl(142, 76%, 50%);\n  \n  /* Chart colors with neon theme */\n  --chart-1: hsl(142, 76%, 50%);\n  --chart-2: hsl(271, 76%, 60%);\n  --chart-3: hsl(38, 92%, 50%);\n  --chart-4: hsl(217, 91%, 60%);\n  --chart-5: hsl(340, 75%, 55%);\n  \n  --radius: 1rem;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n    transition-property: background-color, border-color, color, fill, stroke, box-shadow;\n    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n    transition-duration: 200ms;\n  }\n\n  html {\n    @apply bg-background;\n  }\n\n  body {\n    @apply bg-background text-foreground antialiased;\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;\n    font-feature-settings: 'cv11', 'ss01';\n    font-variation-settings: 'opsz' 32;\n  }\n\n  h1, h2, h3, h4, h5, h6 {\n    @apply font-semibold tracking-tight;\n  }\n\n  h1 {\n    @apply text-3xl lg:text-4xl;\n  }\n\n  h2 {\n    @apply text-2xl lg:text-3xl;\n  }\n\n  h3 {\n    @apply text-xl lg:text-2xl;\n  }\n}\n\n@layer components {\n  .glass-effect {\n    @apply bg-card/80 backdrop-blur-xl border border-border/50 shadow-lg;\n  }\n\n  .modern-card {\n    @apply bg-card border border-border rounded-xl shadow-sm hover:shadow-lg hover:shadow-primary/5 transition-all duration-300;\n  }\n\n  .sidebar-item {\n    @apply flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-200 text-sm font-medium;\n  }\n\n  .sidebar-item-active {\n    @apply text-primary shadow-sm;\n    background-color: hsl(var(--primary) / 0.1);\n    box-shadow: 0 1px 2px 0 hsl(var(--primary) / 0.2);\n  }\n\n  .sidebar-item-inactive {\n    @apply text-muted-foreground hover:bg-muted hover:text-foreground;\n  }\n\n  .smooth-transition {\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  }\n\n  .gradient-border {\n    @apply relative overflow-hidden;\n  }\n\n  .gradient-border::before {\n    content: '';\n    @apply absolute inset-0 rounded-lg p-[1px] bg-gradient-to-r from-neon-green via-neon-purple to-neon-green;\n    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);\n    -webkit-mask-composite: xor;\n    mask-composite: exclude;\n  }\n\n  .neon-glow {\n    box-shadow: 0 0 10px currentColor, 0 0 20px currentColor;\n  }\n\n  .neon-glow-green {\n    box-shadow: 0 0 10px hsl(142, 76%, 50%), 0 0 20px hsl(142, 76%, 50%);\n  }\n\n  .neon-glow-purple {\n    box-shadow: 0 0 10px hsl(271, 80%, 65%), 0 0 20px hsl(271, 80%, 65%);\n  }\n}\n\n@layer utilities {\n  .animate-fade-in {\n    animation: fadeIn 0.3s ease-in-out;\n  }\n\n  .animate-slide-in {\n    animation: slideIn 0.3s ease-out;\n  }\n\n  .animate-scale-in {\n    animation: scaleIn 0.2s ease-out;\n  }\n\n  .animate-pulse-subtle {\n    animation: pulseSubtle 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n  }\n\n  @keyframes slideIn {\n    from {\n      transform: translateY(-10px);\n      opacity: 0;\n    }\n    to {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n\n  @keyframes scaleIn {\n    from {\n      transform: scale(0.95);\n      opacity: 0;\n    }\n    to {\n      transform: scale(1);\n      opacity: 1;\n    }\n  }\n\n  @keyframes pulseSubtle {\n    0%, 100% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.8;\n    }\n  }\n}\n\n/* Scrollbar Styling */\n::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n\n::-webkit-scrollbar-track {\n  @apply bg-transparent;\n}\n\n::-webkit-scrollbar-thumb {\n  @apply bg-muted rounded-full;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  @apply bg-muted-foreground rounded-full;\n  opacity: 0.5;\n}\n\n/* Loading spinner */\n.spinner {\n  @apply animate-spin w-5 h-5 border-2 border-primary border-t-transparent rounded-full;\n}\n\n/* Selection color */\n::selection {\n  @apply text-foreground;\n  background-color: hsl(var(--primary) / 0.3);\n}\n\n/* Focus visible for accessibility */\n:focus-visible {\n  @apply outline-none ring-2 ring-primary ring-offset-2 ring-offset-background;\n}\n","size_bytes":5005},"client/src/pages/member-dashboard.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport QRModal from \"@/components/qr-modal\";\nimport FeedbackModal from \"@/components/feedback-modal\";\nimport BottomNavigation from \"@/components/ui/bottom-navigation\";\nimport {\n  QrCode,\n  MessageSquarePlus,\n  Activity,\n  TrendingUp,\n  Dumbbell,\n  Clock,\n  Calendar,\n  Users,\n  Crown,\n  Zap,\n  ChevronRight,\n} from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { cn } from \"@/lib/utils\";\n\nexport default function MemberDashboard() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [showQRModal, setShowQRModal] = useState(false);\n  const [showFeedbackModal, setShowFeedbackModal] = useState(false);\n\n  useEffect(() => {\n    if (!isLoading && !isAuthenticated) {\n      toast({\n        title: \"Session Expired\",\n        description: \"Please log in again\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => window.location.href = \"/api/login\", 500);\n    }\n  }, [isAuthenticated, isLoading, toast]);\n\n  const { data: dashboardData, isLoading: dashboardLoading } = useQuery<any>({\n    queryKey: [\"/api/member/dashboard\"],\n    enabled: isAuthenticated,\n    retry: false,\n  });\n\n  const generateQRMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/checkin/generate\");\n      return await response.json();\n    },\n    onSuccess: () => setShowQRModal(true),\n    onError: () => toast({\n      title: \"Error\",\n      description: \"Failed to generate QR code\",\n      variant: \"destructive\",\n    }),\n  });\n\n  if (isLoading || dashboardLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"flex flex-col items-center gap-3\">\n          <div className=\"w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin\" />\n          <p className=\"text-sm text-muted-foreground font-medium\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user) return null;\n\n  const membership = dashboardData?.membership;\n  const checkIns = dashboardData?.checkIns || [];\n  const stats = dashboardData?.stats || {};\n  \n  const getDaysUntilExpiry = () => {\n    if (!membership?.endDate) return 0;\n    const now = new Date();\n    const expiry = new Date(membership.endDate);\n    const diffTime = expiry.getTime() - now.getTime();\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  };\n\n  const daysLeft = getDaysUntilExpiry();\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      {/* Modern Header with Greeting */}\n      <header className=\"bg-gradient-to-br from-primary/15 via-neon-purple/10 to-background border-b border-border sticky top-0 z-10 backdrop-blur-xl shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 py-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-3\">\n              <Avatar className=\"h-14 w-14 border-4 border-background shadow-lg ring-2 ring-primary/30\">\n                <AvatarImage src={user?.profileImageUrl || undefined} alt={user?.firstName} />\n                <AvatarFallback className=\"bg-gradient-to-br from-primary to-neon-purple text-white font-bold text-lg\">\n                  {user?.firstName?.[0]}{user?.lastName?.[0]}\n                </AvatarFallback>\n              </Avatar>\n              <div>\n                <h1 className=\"text-2xl font-bold text-foreground\">\n                  Hey, {user.firstName}! ðŸ‘‹\n                </h1>\n                <p className=\"text-sm text-muted-foreground font-medium\">Ready to crush it today?</p>\n              </div>\n            </div>\n          </div>\n\n          {/* Membership Status Banner */}\n          {membership && (\n            <div className=\"bg-gradient-to-r from-primary to-neon-purple p-4 rounded-2xl text-white\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-white/20 rounded-xl backdrop-blur-sm\">\n                    <Crown className=\"h-5 w-5\" />\n                  </div>\n                  <div>\n                    <p className=\"text-xs font-medium opacity-90\">Active Membership</p>\n                    <p className=\"text-sm font-bold\">{membership.plan?.name}</p>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-xs opacity-90\">{daysLeft} days left</p>\n                  <p className=\"text-xs font-semibold\">\n                    Exp: {format(new Date(membership.endDate), \"MMM dd\")}\n                  </p>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto px-4 py-6 space-y-6\">\n        {/* Quick Actions */}\n        <section>\n          <h2 className=\"text-lg font-bold text-foreground mb-4\">Quick Actions</h2>\n          <div className=\"grid grid-cols-2 gap-3\">\n            <button\n              onClick={() => generateQRMutation.mutate()}\n              disabled={generateQRMutation.isPending}\n              className={cn(\n                \"group relative overflow-hidden rounded-2xl p-6 text-left transition-all active:scale-98\",\n                \"bg-gradient-to-br from-neon-green to-green-600 dark:from-neon-green dark:to-green-700\",\n                \"shadow-lg shadow-green-500/20 hover:shadow-xl hover:shadow-green-500/30\"\n              )}\n              data-testid=\"button-generate-qr\"\n            >\n              <div className=\"relative z-10\">\n                <div className=\"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center mb-3 backdrop-blur-sm\">\n                  <QrCode className=\"h-6 w-6 text-white\" />\n                </div>\n                <p className=\"text-white font-bold text-lg\">Check-In</p>\n                <p className=\"text-white/80 text-xs mt-1\">\n                  {generateQRMutation.isPending ? \"Generating...\" : \"Scan QR Code\"}\n                </p>\n              </div>\n              <div className=\"absolute bottom-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-2xl\" />\n            </button>\n\n            <button\n              onClick={() => setShowFeedbackModal(true)}\n              className={cn(\n                \"group relative overflow-hidden rounded-2xl p-6 text-left transition-all active:scale-98\",\n                \"bg-gradient-to-br from-neon-purple to-purple-600 dark:from-neon-purple dark:to-purple-700\",\n                \"shadow-lg shadow-purple-500/20 hover:shadow-xl hover:shadow-purple-500/30\"\n              )}\n              data-testid=\"button-feedback\"\n            >\n              <div className=\"relative z-10\">\n                <div className=\"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center mb-3 backdrop-blur-sm\">\n                  <MessageSquarePlus className=\"h-6 w-6 text-white\" />\n                </div>\n                <p className=\"text-white font-bold text-lg\">Feedback</p>\n                <p className=\"text-white/80 text-xs mt-1\">Share your thoughts</p>\n              </div>\n              <div className=\"absolute bottom-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-2xl\" />\n            </button>\n          </div>\n        </section>\n\n        {/* Stats Grid */}\n        <section>\n          <h2 className=\"text-lg font-bold text-foreground mb-4\">Your Activity</h2>\n          <div className=\"grid grid-cols-2 gap-3\">\n            <Card className=\"p-4 border-border bg-card shadow-sm\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-primary/15 dark:bg-primary/10 rounded-xl border border-primary/20\">\n                  <Activity className=\"h-5 w-5 text-primary\" />\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold text-foreground\">{checkIns.length}</p>\n                  <p className=\"text-xs text-muted-foreground font-medium\">Check-ins</p>\n                </div>\n              </div>\n            </Card>\n\n            <Card className=\"p-4 border-border bg-card shadow-sm\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-neon-purple/15 dark:bg-neon-purple/10 rounded-xl border border-neon-purple/20\">\n                  <TrendingUp className=\"h-5 w-5 text-neon-purple\" />\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold text-foreground\">{stats.weeklyCheckIns || 0}</p>\n                  <p className=\"text-xs text-muted-foreground font-medium\">This Week</p>\n                </div>\n              </div>\n            </Card>\n\n            <Card className=\"p-4 border-border bg-card shadow-sm\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-orange-500/15 dark:bg-orange-500/10 rounded-xl border border-orange-500/20\">\n                  <Dumbbell className=\"h-5 w-5 text-orange-500\" />\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold text-foreground\">{stats.monthlyCheckIns || 0}</p>\n                  <p className=\"text-xs text-muted-foreground font-medium\">This Month</p>\n                </div>\n              </div>\n            </Card>\n\n            <Card className=\"p-4 border-border bg-card shadow-sm\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-blue-500/15 dark:bg-blue-500/10 rounded-xl border border-blue-500/20\">\n                  <Zap className=\"h-5 w-5 text-blue-500\" />\n                </div>\n                <div>\n                  <p className=\"text-2xl font-bold text-foreground\">{stats.currentStreak || 0}</p>\n                  <p className=\"text-xs text-muted-foreground font-medium\">Day Streak</p>\n                </div>\n              </div>\n            </Card>\n          </div>\n        </section>\n\n        {/* Recent Activity */}\n        {checkIns.length > 0 && (\n          <section>\n            <div className=\"flex items-center justify-between mb-4\">\n              <h2 className=\"text-lg font-bold text-foreground\">Recent Check-ins</h2>\n              <ChevronRight className=\"h-5 w-5 text-muted-foreground\" />\n            </div>\n            <div className=\"space-y-2\">\n              {checkIns.slice(0, 3).map((checkIn: any) => (\n                <Card key={checkIn.id} className=\"p-4 border-border bg-card shadow-sm\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"p-2 bg-neon-green/15 dark:bg-neon-green/10 rounded-xl border border-neon-green/20\">\n                        <Clock className=\"h-4 w-4 text-neon-green\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm font-semibold text-foreground\">\n                          {format(new Date(checkIn.checkInTime), \"MMM dd, yyyy\")}\n                        </p>\n                        <p className=\"text-xs text-muted-foreground\">\n                          {format(new Date(checkIn.checkInTime), \"h:mm a\")}\n                        </p>\n                      </div>\n                    </div>\n                    <Badge variant={checkIn.status === 'active' ? 'default' : 'secondary'} className=\"text-xs\">\n                      {checkIn.status === 'active' ? 'Active' : 'Completed'}\n                    </Badge>\n                  </div>\n                </Card>\n              ))}\n            </div>\n          </section>\n        )}\n\n        {/* Gym Crowd Status */}\n        {stats.currentCrowd !== undefined && (\n          <Card className=\"p-6 border-border/50 bg-gradient-to-br from-card to-muted/20 backdrop-blur-sm\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"p-2 bg-primary/10 rounded-xl\">\n                  <Users className=\"h-5 w-5 text-primary\" />\n                </div>\n                <div>\n                  <p className=\"text-sm font-semibold text-foreground\">Gym Crowd</p>\n                  <p className=\"text-xs text-muted-foreground\">Current occupancy</p>\n                </div>\n              </div>\n              <div className=\"text-right\">\n                <p className=\"text-2xl font-bold text-primary\">{stats.currentCrowd}</p>\n                <p className=\"text-xs text-muted-foreground\">people</p>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <div className=\"flex-1 h-2 bg-muted rounded-full overflow-hidden\">\n                <div \n                  className={cn(\n                    \"h-full rounded-full transition-all\",\n                    stats.currentCrowd < 10 ? \"bg-neon-green\" : \n                    stats.currentCrowd < 25 ? \"bg-yellow-500\" : \"bg-red-500\"\n                  )}\n                  style={{ width: `${Math.min((stats.currentCrowd / 40) * 100, 100)}%` }}\n                />\n              </div>\n              <Badge variant=\"outline\" className=\"text-xs\">\n                {stats.currentCrowd < 10 ? 'Quiet' : stats.currentCrowd < 25 ? 'Moderate' : 'Busy'}\n              </Badge>\n            </div>\n          </Card>\n        )}\n      </main>\n\n      {/* Modals */}\n      <QRModal\n        isOpen={showQRModal}\n        onClose={() => setShowQRModal(false)}\n      />\n      <FeedbackModal\n        open={showFeedbackModal}\n        onOpenChange={setShowFeedbackModal}\n      />\n\n      {/* Bottom Navigation */}\n      <BottomNavigation notificationCount={0} />\n    </div>\n  );\n}\n","size_bytes":14051},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/qr-modal.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { QrCode, RefreshCw, CheckCircle2, XCircle } from \"lucide-react\";\nimport QRCode from \"qrcode\";\n\ninterface QRModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  qrData?: any;\n}\n\nexport default function QRModal({ isOpen, onClose, qrData }: QRModalProps) {\n  const { toast } = useToast();\n  const [currentQRData, setCurrentQRData] = useState(qrData);\n  const [qrCodeDataURL, setQrCodeDataURL] = useState<string>(\"\");\n  const [timeRemaining, setTimeRemaining] = useState<number>(0);\n  const [checkInSuccess, setCheckInSuccess] = useState(false);\n  const [checkInData, setCheckInData] = useState<any>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  const generateNewQRMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/checkin/generate\");\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      setCurrentQRData(data);\n      toast({\n        title: \"Success\",\n        description: \"New QR code generated\",\n      });\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to generate new QR code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Generate QR code image when data changes\n  useEffect(() => {\n    if (currentQRData?.qrCode) {\n      // Create a URL for the QR code that member can scan to check-in\n      const checkInUrl = `${window.location.origin}/checkin/verify/${currentQRData.qrCode}`;\n      \n      QRCode.toDataURL(checkInUrl, {\n        width: 256,\n        margin: 2,\n        color: {\n          dark: '#000000',\n          light: '#FFFFFF'\n        }\n      })\n      .then(url => {\n        setQrCodeDataURL(url);\n      })\n      .catch(err => {\n        console.error('Error generating QR code:', err);\n      });\n    }\n  }, [currentQRData]);\n\n  // Update currentQRData when qrData prop changes\n  useEffect(() => {\n    if (qrData && qrData !== currentQRData) {\n      setCurrentQRData(qrData);\n    }\n  }, [qrData, currentQRData]);\n\n  // Countdown timer for QR expiry\n  useEffect(() => {\n    if (!currentQRData?.expiresAt) return;\n\n    const calculateTimeRemaining = () => {\n      const now = new Date().getTime();\n      const expires = new Date(currentQRData.expiresAt).getTime();\n      const remaining = Math.max(0, Math.floor((expires - now) / 1000));\n      return remaining;\n    };\n\n    // Initial calculation\n    setTimeRemaining(calculateTimeRemaining());\n\n    // Track if refresh is already in progress\n    let refreshInProgress = false;\n\n    // Update every second\n    const interval = setInterval(() => {\n      const remaining = calculateTimeRemaining();\n      setTimeRemaining(remaining);\n\n      // Auto-refresh QR 30 seconds before expiry (or when expired)\n      // Only trigger once and avoid flood of requests\n      if (remaining <= 30 && !refreshInProgress && !generateNewQRMutation.isPending) {\n        refreshInProgress = true;\n        generateNewQRMutation.mutate();\n      }\n    }, 1000);\n\n    return () => clearInterval(interval);\n  }, [currentQRData?.expiresAt, generateNewQRMutation]);\n\n  // Poll QR code status to detect when admin scans it\n  useEffect(() => {\n    if (!currentQRData?.qrCode || checkInSuccess) return;\n\n    const pollStatus = async () => {\n      try {\n        const response = await fetch(`/api/checkin/status/${currentQRData.qrCode}`);\n        const data = await response.json();\n        \n        if (data.success && data.status === 'used') {\n          // QR code has been scanned and check-in is successful\n          setCheckInSuccess(true);\n          setCheckInData(data);\n          \n          toast({\n            title: \"Check-in Berhasil! ðŸŽ‰\",\n            description: \"Selamat berolahraga!\",\n          });\n        }\n      } catch (error) {\n        console.error(\"Error polling QR status:\", error);\n      }\n    };\n\n    // Poll every 2 seconds\n    const pollInterval = setInterval(pollStatus, 2000);\n    \n    // Also poll immediately\n    pollStatus();\n\n    return () => clearInterval(pollInterval);\n  }, [currentQRData?.qrCode, checkInSuccess, toast]);\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"sm:max-w-md\" data-testid=\"modal-qr-code\">\n        <DialogHeader>\n          <DialogTitle className=\"text-center\">Check-in QR Code</DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"flex flex-col items-center space-y-6 p-6\">\n          {/* Check-in Success UI */}\n          {checkInSuccess ? (\n            <div className=\"flex flex-col items-center space-y-6 w-full\" data-testid=\"checkin-success-view\">\n              <div className=\"relative\">\n                <div className=\"absolute inset-0 bg-green-400 rounded-full blur-xl opacity-50 animate-pulse\"></div>\n                <div className=\"relative bg-green-500 rounded-full p-6\">\n                  <CheckCircle2 className=\"w-20 h-20 text-white\" data-testid=\"icon-checkin-success\" />\n                </div>\n              </div>\n              \n              <div className=\"text-center space-y-2\">\n                <h1 className=\"text-3xl font-bold text-green-600 dark:text-green-400\" data-testid=\"text-checkin-success\">\n                  CHECK-IN BERHASIL! ðŸŽ‰\n                </h1>\n                <p className=\"text-lg text-gray-700 dark:text-gray-300\">\n                  Selamat berolahraga!\n                </p>\n              </div>\n\n              {checkInData?.user && (\n                <div className=\"w-full bg-green-50 dark:bg-green-950/20 rounded-lg p-4 border border-green-200 dark:border-green-800\">\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Member</p>\n                  <p className=\"text-lg font-semibold text-gray-800 dark:text-gray-100\" data-testid=\"text-member-name-success\">\n                    {checkInData.user.firstName} {checkInData.user.lastName}\n                  </p>\n                </div>\n              )}\n              \n              <Button\n                onClick={onClose}\n                className=\"w-full gym-gradient text-white\"\n                data-testid=\"button-close-success\"\n              >\n                Tutup\n              </Button>\n            </div>\n          ) : (\n            <>\n              {/* Membership Status Badge */}\n              {currentQRData?.hasActiveMembership !== undefined && (\n                <div className={`w-full flex items-center justify-center gap-3 p-4 rounded-lg border-2 ${\n                  currentQRData.hasActiveMembership \n                    ? 'bg-green-50 dark:bg-green-950/20 border-green-500' \n                    : 'bg-red-50 dark:bg-red-950/20 border-red-500'\n                }`} data-testid=\"membership-status-banner\">\n                  {currentQRData.hasActiveMembership ? (\n                    <>\n                      <div className=\"bg-green-500 rounded-full p-2\">\n                        <CheckCircle2 className=\"w-6 h-6 text-white\" data-testid=\"icon-membership-active\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"font-bold text-green-600 dark:text-green-400\" data-testid=\"text-membership-active\">\n                          Membership Active\n                        </h3>\n                        {currentQRData.membership && (\n                          <p className=\"text-sm text-green-600 dark:text-green-400\">\n                            {currentQRData.membership.plan?.name}\n                          </p>\n                        )}\n                      </div>\n                    </>\n                  ) : (\n                    <>\n                      <div className=\"bg-red-500 rounded-full p-2\">\n                        <XCircle className=\"w-6 h-6 text-white\" data-testid=\"icon-no-membership\" />\n                      </div>\n                      <div className=\"flex-1\">\n                        <h3 className=\"font-bold text-red-600 dark:text-red-400\" data-testid=\"text-no-membership\">\n                          Belum Terdaftar Membership\n                        </h3>\n                        <p className=\"text-sm text-red-600 dark:text-red-400\">\n                          Silakan daftar membership terlebih dahulu\n                        </p>\n                      </div>\n                    </>\n                  )}\n                </div>\n              )}\n              \n              {/* QR Code Display */}\n              <div className=\"bg-white p-6 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center\">\n                <div className=\"text-center\">\n                  {qrCodeDataURL ? (\n                    <div className=\"flex flex-col items-center\">\n                      <img \n                        src={qrCodeDataURL} \n                        alt=\"Check-in QR Code\" \n                        className=\"w-48 h-48 rounded-lg\"\n                        data-testid=\"img-qr-code\"\n                      />\n                      <p className=\"text-xs text-gray-500 mt-2\">Scan to Check-in</p>\n                      {currentQRData?.qrCode && (\n                        <p className=\"text-xs text-gray-400 mt-1 font-mono\" data-testid=\"text-qr-code\">\n                          ID: {currentQRData.qrCode.slice(-8)}\n                        </p>\n                      )}\n                    </div>\n                  ) : (\n                    <div className=\"w-48 h-48 bg-gray-100 rounded-lg flex items-center justify-center\">\n                      <div className=\"text-center\">\n                        <QrCode size={64} className=\"text-gray-400 mx-auto mb-2\" />\n                        <p className=\"text-xs text-gray-500\">Generating QR Code...</p>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </>\n          )}\n\n          {/* Countdown Timer - Only show when not checked in */}\n          {!checkInSuccess && timeRemaining > 0 && (\n            <div className={`w-full p-3 rounded-lg border-2 ${\n              timeRemaining <= 60 ? 'bg-red-50 dark:bg-red-950/20 border-red-500' : 'bg-blue-50 dark:bg-blue-950/20 border-blue-500'\n            }`} data-testid=\"countdown-timer\">\n              <div className=\"flex items-center justify-center gap-2\">\n                <span className={`font-bold ${\n                  timeRemaining <= 60 ? 'text-red-600 dark:text-red-400' : 'text-blue-600 dark:text-blue-400'\n                }`} data-testid=\"text-time-remaining\">\n                  {formatTime(timeRemaining)}\n                </span>\n                <span className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  {timeRemaining <= 60 ? 'QR akan expired!' : 'berlaku'}\n                </span>\n              </div>\n            </div>\n          )}\n          \n          {!checkInSuccess && (\n            <>\n              <p className=\"text-sm text-muted-foreground text-center\">\n                Scan QR code ini untuk check-in otomatis. QR sekali pakai berlaku 5 menit.\n              </p>\n              \n              <div className=\"flex gap-3 w-full\">\n                <Button\n                  onClick={() => generateNewQRMutation.mutate()}\n                  disabled={generateNewQRMutation.isPending}\n                  className=\"flex-1 gym-gradient text-white\"\n                  data-testid=\"button-refresh-qr\"\n                >\n                  <RefreshCw \n                    size={16} \n                    className={`mr-2 ${generateNewQRMutation.isPending ? 'animate-spin' : ''}`} \n                  />\n                  {generateNewQRMutation.isPending ? \"Generating...\" : \"Generate New Code\"}\n                </Button>\n                \n                <Button\n                  variant=\"outline\"\n                  onClick={onClose}\n                  className=\"flex-1\"\n                  data-testid=\"button-close-qr-modal\"\n                >\n                  Close\n                </Button>\n              </div>\n            </>\n          )}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":12861},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });","size_bytes":482},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\", \"Inter\", \"system-ui\", \"sans-serif\"],\n        serif: [\"var(--font-serif)\", \"Georgia\", \"serif\"],\n        mono: [\"var(--font-mono)\", \"Menlo\", \"monospace\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2833},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User | null>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":314},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/pages/admin-dashboard.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport Navigation from \"@/components/ui/navigation\";\nimport AdminCheckInModal from \"@/components/admin-checkin-modal\";\nimport AdminPTDialog from \"@/components/admin-pt-dialog\";\nimport AdminClassDialog from \"@/components/admin-class-dialog\";\nimport AdminMemberDialog from \"@/components/admin-member-dialog\";\nimport AdminEditMemberDialog from \"@/components/admin-edit-member-dialog\";\nimport AdminMembershipPlanDialog from \"@/components/admin-membership-plan-dialog\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { format } from \"date-fns\";\nimport type { PersonalTrainer, GymClass, MembershipPlan } from \"@shared/schema\";\nimport {\n  Users,\n  CalendarCheck,\n  TriangleAlert,\n  DollarSign,\n  ShieldQuestion,\n  Edit,\n  Trash2,\n  UserPlus,\n  TrendingUp,\n  QrCode,\n  Clock,\n  LogIn,\n  MessageSquare,\n  Star,\n  Dumbbell,\n  UserX,\n  UserCheck,\n} from \"lucide-react\";\n\ninterface AdminDashboardStats {\n  totalMembers?: number;\n  activeToday?: number;\n  expiringSoon?: number;\n  revenue?: {\n    thisMonth?: number;\n    lastMonth?: number;\n    total?: number;\n  };\n}\n\ninterface AdminDashboardResponse {\n  stats?: AdminDashboardStats;\n  users?: MemberWithMembership[];\n}\n\ninterface MemberWithMembership {\n  id: string;\n  email?: string;\n  username?: string;\n  phone?: string;\n  firstName?: string;\n  lastName?: string;\n  profileImageUrl?: string;\n  active?: boolean;\n  membership?: {\n    status?: string;\n    endDate?: string;\n    plan?: {\n      name?: string;\n    };\n  };\n}\n\ninterface CheckInRecord {\n  id: string;\n  checkInTime: string;\n  status?: string;\n  user?: {\n    firstName?: string;\n    lastName?: string;\n    profileImageUrl?: string;\n  };\n  membership?: {\n    plan?: {\n      name?: string;\n    };\n  };\n}\n\ninterface FeedbackRecord {\n  id: string;\n  subject?: string;\n  message: string;\n  rating?: number;\n  category?: string;\n  createdAt: string;\n  member?: {\n    firstName?: string;\n    lastName?: string;\n    email?: string;\n    profileImageUrl?: string;\n  };\n}\n\nexport default function AdminDashboard() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [memberFilter, setMemberFilter] = useState(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [showCheckInModal, setShowCheckInModal] = useState(false);\n  const [showPTDialog, setShowPTDialog] = useState(false);\n  const [selectedTrainer, setSelectedTrainer] = useState<PersonalTrainer | null>(null);\n  const [showClassDialog, setShowClassDialog] = useState(false);\n  const [selectedClass, setSelectedClass] = useState<GymClass | null>(null);\n  const [showMemberDialog, setShowMemberDialog] = useState(false);\n  const [showEditMemberDialog, setShowEditMemberDialog] = useState(false);\n  const [selectedMember, setSelectedMember] = useState<MemberWithMembership | null>(null);\n  const [showMembershipPlanDialog, setShowMembershipPlanDialog] = useState(false);\n  const [selectedMembershipPlan, setSelectedMembershipPlan] = useState<MembershipPlan | null>(null);\n\n  // Redirect if not authenticated or not admin\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData, isLoading: dashboardLoading } = useQuery<AdminDashboardResponse>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: members } = useQuery<MemberWithMembership[]>({\n    queryKey: [\"/api/admin/members\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: recentCheckIns } = useQuery<CheckInRecord[]>({\n    queryKey: [\"/api/admin/checkins\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n    refetchInterval: 10000,\n  });\n\n  const { data: feedbacks } = useQuery<FeedbackRecord[]>({\n    queryKey: [\"/api/admin/feedbacks\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: trainers } = useQuery<PersonalTrainer[]>({\n    queryKey: [\"/api/admin/trainers\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: gymClasses } = useQuery<GymClass[]>({\n    queryKey: [\"/api/admin/classes\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: classBookings } = useQuery<any[]>({\n    queryKey: [\"/api/admin/class-bookings\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: ptBookings } = useQuery<any[]>({\n    queryKey: [\"/api/admin/pt-bookings\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: membershipPlans } = useQuery<MembershipPlan[]>({\n    queryKey: [\"/api/admin/membership-plans\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const suspendMutation = useMutation({\n    mutationFn: (memberId: string) => apiRequest(\"PUT\", `/api/admin/members/${memberId}/suspend`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Member berhasil dinonaktifkan\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menonaktifkan member\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const activateMutation = useMutation({\n    mutationFn: (memberId: string) => apiRequest(\"PUT\", `/api/admin/members/${memberId}/activate`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Member berhasil diaktifkan kembali\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal mengaktifkan member\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  if (isLoading || dashboardLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n  const users = dashboardData?.users || [];\n\n  const isExpiringSoon = (endDate: string) => {\n    const now = new Date();\n    const expiry = new Date(endDate);\n    const diffTime = expiry.getTime() - now.getTime();\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    return diffDays <= 20 && diffDays > 0;\n  };\n\n  const getMembershipStatus = (member: MemberWithMembership) => {\n    if (!member.membership) return \"No Membership\";\n    if (member.membership.status === \"expired\") return \"Expired\";\n    if (member.membership.endDate && isExpiringSoon(member.membership.endDate)) return \"Expiring Soon\";\n    if (member.membership.status === \"active\") return \"Active\";\n    return member.membership.status || \"Unknown\";\n  };\n\n  const filteredMembers = members?.filter((member) => {\n    const matchesSearch = !searchTerm || \n      member.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      member.username?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      member.phone?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      `${member.firstName || ''} ${member.lastName || ''}`.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesFilter = memberFilter === \"all\" ||\n      (memberFilter === \"active\" && member.membership?.status === \"active\") ||\n      (memberFilter === \"expiring\" && member.membership && isExpiringSoon(member.membership.endDate || \"\")) ||\n      (memberFilter === \"expired\" && member.membership?.status === \"expired\");\n\n    return matchesSearch && matchesFilter;\n  }) || [];\n\n  const getStatusVariant = (status: string) => {\n    switch (status) {\n      case \"Active\": return \"default\";\n      case \"Expiring Soon\": return \"secondary\";\n      case \"Expired\": return \"destructive\";\n      default: return \"outline\";\n    }\n  };\n\n  const handleAddTrainer = () => {\n    setSelectedTrainer(null);\n    setShowPTDialog(true);\n  };\n\n  const handleEditTrainer = (trainer: PersonalTrainer) => {\n    setSelectedTrainer(trainer);\n    setShowPTDialog(true);\n  };\n\n  const handleDeleteTrainer = async (trainerId: string) => {\n    if (!confirm(\"Apakah Anda yakin ingin menghapus personal trainer ini?\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/trainers/${trainerId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/trainers\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trainers\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Personal trainer berhasil dihapus\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menghapus personal trainer\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleAddClass = () => {\n    setSelectedClass(null);\n    setShowClassDialog(true);\n  };\n\n  const handleEditClass = (gymClass: GymClass) => {\n    setSelectedClass(gymClass);\n    setShowClassDialog(true);\n  };\n\n  const handleDeleteClass = async (classId: string) => {\n    if (!confirm(\"Apakah Anda yakin ingin menghapus class ini?\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/classes/${classId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/classes\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/classes\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Gym class berhasil dihapus\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menghapus gym class\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleAddMember = () => {\n    setShowMemberDialog(true);\n  };\n\n  const handleEditMember = (member: MemberWithMembership) => {\n    setSelectedMember(member);\n    setShowEditMemberDialog(true);\n  };\n\n  const handleDeleteMember = async (memberId: string) => {\n    if (!confirm(\"Apakah Anda yakin ingin menghapus member ini? Data member akan dihapus permanen.\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/members/${memberId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Member berhasil dihapus\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menghapus member\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleSuspendMember = async (memberId: string) => {\n    if (!confirm(\"Apakah Anda yakin ingin menonaktifkan member ini sementara?\")) {\n      return;\n    }\n    suspendMutation.mutate(memberId);\n  };\n\n  const handleActivateMember = async (memberId: string) => {\n    activateMutation.mutate(memberId);\n  };\n\n  const handleAddMembershipPlan = () => {\n    setSelectedMembershipPlan(null);\n    setShowMembershipPlanDialog(true);\n  };\n\n  const handleEditMembershipPlan = (plan: MembershipPlan) => {\n    setSelectedMembershipPlan(plan);\n    setShowMembershipPlanDialog(true);\n  };\n\n  const handleDeleteMembershipPlan = async (planId: string) => {\n    if (!confirm(\"Apakah Anda yakin ingin menghapus paket membership ini?\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/membership-plans/${planId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/membership-plans\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/membership-plans\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Paket membership berhasil dihapus\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menghapus paket membership\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-muted/30\">\n      <Navigation \n        user={user} \n        isAdmin={true}\n        notificationCount={stats.expiringSoon || 0}\n      />\n      \n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        {/* Admin Header */}\n        <div className=\"mb-8 flex justify-between items-center\">\n          <div>\n            <h2 className=\"text-3xl font-bold text-foreground\">Admin Dashboard</h2>\n            <p className=\"text-muted-foreground mt-1\">Manage gym operations and member accounts</p>\n          </div>\n          <Button \n            onClick={() => setShowCheckInModal(true)}\n            className=\"gym-gradient text-white\"\n            data-testid=\"button-validate-checkin\"\n          >\n            <QrCode className=\"mr-2\" size={16} />\n            Validasi Check-in\n          </Button>\n        </div>\n\n        {/* Admin Stats */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Total Members</p>\n                  <p className=\"text-2xl font-bold text-foreground\" data-testid=\"text-total-members\">\n                    {stats.totalMembers || 0}\n                  </p>\n                  <p className=\"text-xs text-green-600\">+12 this month</p>\n                </div>\n                <div className=\"gym-gradient w-12 h-12 rounded-lg flex items-center justify-center\">\n                  <Users className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Active Today</p>\n                  <p className=\"text-2xl font-bold text-foreground\" data-testid=\"text-active-today\">\n                    {stats.activeToday || 0}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">Current check-ins</p>\n                </div>\n                <div className=\"success-gradient w-12 h-12 rounded-lg flex items-center justify-center\">\n                  <CalendarCheck className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Expiring Soon</p>\n                  <p className=\"text-2xl font-bold text-destructive\" data-testid=\"text-expiring-soon\">\n                    {stats.expiringSoon || 0}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground\">{\"< 20 days\"}</p>\n                </div>\n                <div className=\"bg-gradient-to-r from-red-500 to-red-600 w-12 h-12 rounded-lg flex items-center justify-center\">\n                  <TriangleAlert className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">Monthly Revenue</p>\n                  <p className=\"text-2xl font-bold text-foreground\" data-testid=\"text-monthly-revenue\">\n                    ${stats.revenue?.thisMonth || 0}\n                  </p>\n                  <p className=\"text-xs text-green-600\">+8% vs last month</p>\n                </div>\n                <div className=\"warning-gradient w-12 h-12 rounded-lg flex items-center justify-center\">\n                  <DollarSign className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Main Admin Content */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Member Management */}\n          <div className=\"lg:col-span-2\">\n            <Card>\n              <CardHeader>\n                <div className=\"flex justify-between items-center\">\n                  <div>\n                    <CardTitle>Member Management</CardTitle>\n                    <p className=\"text-sm text-muted-foreground\">Manage gym member accounts</p>\n                  </div>\n                  <Button \n                    className=\"gym-gradient text-white\" \n                    onClick={handleAddMember}\n                    data-testid=\"button-add-member\"\n                  >\n                    <UserPlus className=\"mr-2\" size={16} />\n                    Add New Member\n                  </Button>\n                </div>\n              </CardHeader>\n\n              <CardContent>\n                {/* Search and Filter */}\n                <div className=\"flex space-x-4 mb-6\">\n                  <div className=\"flex-1\">\n                    <Input\n                      placeholder=\"Search members...\"\n                      value={searchTerm}\n                      onChange={(e) => setSearchTerm(e.target.value)}\n                      data-testid=\"input-search-members\"\n                    />\n                  </div>\n                  <Select value={memberFilter} onValueChange={setMemberFilter}>\n                    <SelectTrigger className=\"w-48\" data-testid=\"select-filter-members\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"all\">All Members</SelectItem>\n                      <SelectItem value=\"active\">Active</SelectItem>\n                      <SelectItem value=\"expiring\">Expiring Soon</SelectItem>\n                      <SelectItem value=\"expired\">Expired</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n\n                {/* Members Table */}\n                {filteredMembers.length === 0 ? (\n                  <p className=\"text-center text-muted-foreground py-8\">No members found</p>\n                ) : (\n                  <div className=\"overflow-x-auto\">\n                    <table className=\"w-full\">\n                      <thead className=\"bg-muted/50\">\n                        <tr>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Member\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Username\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Phone\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Membership\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Expires\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Status\n                          </th>\n                          <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                            Actions\n                          </th>\n                        </tr>\n                      </thead>\n                      <tbody className=\"divide-y divide-border\">\n                        {filteredMembers.map((member: any) => (\n                          <tr key={member.id} data-testid={`row-member-${member.id}`}>\n                            <td className=\"px-6 py-4\">\n                              <div className=\"flex items-center\">\n                                <Avatar className=\"h-10 w-10\">\n                                  <AvatarImage src={member.profileImageUrl} />\n                                  <AvatarFallback>\n                                    {`${member.firstName?.[0] || ''}${member.lastName?.[0] || ''}` || 'M'}\n                                  </AvatarFallback>\n                                </Avatar>\n                                <div className=\"ml-4\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <p className=\"text-sm font-medium text-foreground\">\n                                      {`${member.firstName || ''} ${member.lastName || ''}`.trim() || 'No Name'}\n                                    </p>\n                                    {member.active === false && (\n                                      <Badge variant=\"outline\" className=\"text-orange-600 border-orange-600\">\n                                        Suspended\n                                      </Badge>\n                                    )}\n                                  </div>\n                                  <p className=\"text-sm text-muted-foreground\">{member.email}</p>\n                                </div>\n                              </div>\n                            </td>\n                            <td className=\"px-6 py-4 text-sm text-foreground\" data-testid={`text-username-${member.id}`}>\n                              {member.username || '-'}\n                            </td>\n                            <td className=\"px-6 py-4 text-sm text-foreground\" data-testid={`text-phone-${member.id}`}>\n                              {member.phone || '-'}\n                            </td>\n                            <td className=\"px-6 py-4 text-sm text-foreground\">\n                              {member.membership?.plan?.name || 'None'}\n                            </td>\n                            <td className=\"px-6 py-4 text-sm text-foreground\">\n                              {member.membership?.endDate \n                                ? new Date(member.membership.endDate).toLocaleDateString()\n                                : 'N/A'\n                              }\n                            </td>\n                            <td className=\"px-6 py-4\">\n                              <Badge variant={getStatusVariant(getMembershipStatus(member))}>\n                                {getMembershipStatus(member)}\n                              </Badge>\n                            </td>\n                            <td className=\"px-6 py-4 text-sm\">\n                              <div className=\"flex space-x-2\">\n                                <Button\n                                  variant=\"outline\"\n                                  size=\"sm\"\n                                  onClick={() => handleEditMember(member)}\n                                  data-testid={`button-edit-${member.id}`}\n                                >\n                                  <Edit size={16} />\n                                </Button>\n                                {member.active !== false ? (\n                                  <Button\n                                    variant=\"outline\"\n                                    size=\"sm\"\n                                    onClick={() => handleSuspendMember(member.id)}\n                                    data-testid={`button-suspend-${member.id}`}\n                                    title=\"Nonaktifkan sementara\"\n                                  >\n                                    <UserX size={16} className=\"text-orange-500\" />\n                                  </Button>\n                                ) : (\n                                  <Button\n                                    variant=\"outline\"\n                                    size=\"sm\"\n                                    onClick={() => handleActivateMember(member.id)}\n                                    data-testid={`button-activate-${member.id}`}\n                                    title=\"Aktifkan kembali\"\n                                  >\n                                    <UserCheck size={16} className=\"text-green-500\" />\n                                  </Button>\n                                )}\n                                <Button\n                                  variant=\"outline\"\n                                  size=\"sm\"\n                                  onClick={() => handleDeleteMember(member.id)}\n                                  data-testid={`button-delete-${member.id}`}\n                                >\n                                  <Trash2 size={16} className=\"text-destructive\" />\n                                </Button>\n                              </div>\n                            </td>\n                          </tr>\n                        ))}\n                      </tbody>\n                    </table>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Right Column */}\n          <div className=\"space-y-8\">\n            {/* Financial Overview */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Financial Overview</CardTitle>\n                <p className=\"text-sm text-muted-foreground\">Revenue tracking</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">This Month</span>\n                    <span className=\"text-sm font-bold text-foreground\">\n                      ${stats.revenue?.thisMonth || 0}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Last Month</span>\n                    <span className=\"text-sm font-medium text-muted-foreground\">\n                      ${stats.revenue?.lastMonth || 0}\n                    </span>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm text-muted-foreground\">Total Revenue</span>\n                    <span className=\"text-sm font-medium text-green-600\">\n                      ${stats.revenue?.total || 0}\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"mt-6\">\n                  <Button className=\"w-full gym-gradient text-white\" data-testid=\"button-generate-report\">\n                    <TrendingUp className=\"mr-2\" size={16} />\n                    Generate Report\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Membership Plans */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Membership Plans</CardTitle>\n                <p className=\"text-sm text-muted-foreground\">Current pricing tiers</p>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"border border-border rounded-lg p-4\">\n                    <div className=\"flex justify-between items-start mb-2\">\n                      <h4 className=\"font-semibold text-foreground\">Basic</h4>\n                      <span className=\"text-lg font-bold text-foreground\">$49/mo</span>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">Gym access only</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">89 active members</p>\n                  </div>\n\n                  <div className=\"border border-border rounded-lg p-4\">\n                    <div className=\"flex justify-between items-start mb-2\">\n                      <h4 className=\"font-semibold text-foreground\">Premium</h4>\n                      <span className=\"text-lg font-bold text-foreground\">$99/mo</span>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">Gym + Classes</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">142 active members</p>\n                  </div>\n\n                  <div className=\"border border-border rounded-lg p-4\">\n                    <div className=\"flex justify-between items-start mb-2\">\n                      <h4 className=\"font-semibold text-foreground\">Elite</h4>\n                      <span className=\"text-lg font-bold text-foreground\">$149/mo</span>\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">All access + PT</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">16 active members</p>\n                  </div>\n                </div>\n\n                <Button variant=\"outline\" className=\"mt-6 w-full\" data-testid=\"button-manage-plans\">\n                  Manage Plans\n                </Button>\n              </CardContent>\n            </Card>\n\n            {/* Recent Check-ins */}\n            <Card>\n              <CardHeader>\n                <CardTitle>Recent Check-ins</CardTitle>\n                <p className=\"text-sm text-muted-foreground\">Live member activity</p>\n              </CardHeader>\n              <CardContent>\n                {!recentCheckIns || recentCheckIns.length === 0 ? (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <LogIn className=\"mx-auto mb-2\" size={32} />\n                    <p>No recent check-ins</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3 max-h-[400px] overflow-y-auto\">\n                    {recentCheckIns.slice(0, 10).map((checkIn: any) => (\n                      <div \n                        key={checkIn.id} \n                        className=\"flex items-start space-x-3 pb-3 border-b border-border last:border-0\"\n                        data-testid={`checkin-item-${checkIn.id}`}\n                      >\n                        <Avatar className=\"h-8 w-8\">\n                          <AvatarImage src={checkIn.user?.profileImageUrl} />\n                          <AvatarFallback className=\"text-xs\">\n                            {`${checkIn.user?.firstName?.[0] || ''}${checkIn.user?.lastName?.[0] || ''}`}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"flex-1 min-w-0\">\n                          <p className=\"text-sm font-medium text-foreground truncate\">\n                            {checkIn.user?.firstName} {checkIn.user?.lastName}\n                          </p>\n                          <p className=\"text-xs text-muted-foreground truncate\">\n                            {checkIn.membership?.plan?.name || 'No membership'}\n                          </p>\n                          <div className=\"flex items-center gap-1 mt-1\">\n                            <Clock size={10} className=\"text-muted-foreground\" />\n                            <p className=\"text-xs text-muted-foreground\">\n                              {format(new Date(checkIn.checkInTime), \"HH:mm\")}\n                            </p>\n                          </div>\n                        </div>\n                        <Badge \n                          variant={checkIn.status === 'active' ? 'default' : 'secondary'}\n                          className=\"text-xs\"\n                        >\n                          {checkIn.status === 'active' ? 'In' : 'Out'}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n\n        {/* Membership Plans Management Section */}\n        <div className=\"mt-8\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <CalendarCheck className=\"text-primary\" size={20} />\n                    Paket Membership\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-1\">Kelola paket membership dan masa aktif</p>\n                </div>\n                <Button \n                  onClick={handleAddMembershipPlan}\n                  className=\"gym-gradient text-white\"\n                  data-testid=\"button-add-plan\"\n                >\n                  <UserPlus className=\"mr-2\" size={16} />\n                  Tambah Paket\n                </Button>\n              </div>\n            </CardHeader>\n\n            <CardContent>\n              {!membershipPlans || membershipPlans.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <CalendarCheck className=\"mx-auto mb-3\" size={48} />\n                  <p className=\"text-lg font-medium\">Belum Ada Paket Membership</p>\n                  <p className=\"text-sm mt-1\">Tambahkan paket membership pertama Anda</p>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                  {membershipPlans.map((plan: MembershipPlan) => (\n                    <div \n                      key={plan.id} \n                      className=\"border border-border rounded-lg p-5 hover:shadow-md transition-shadow\"\n                      data-testid={`card-plan-${plan.id}`}\n                    >\n                      <div className=\"mb-4\">\n                        <h4 className=\"font-bold text-foreground text-xl\">{plan.name}</h4>\n                        {plan.description && (\n                          <p className=\"text-sm text-muted-foreground mt-1 line-clamp-2\">\n                            {plan.description}\n                          </p>\n                        )}\n                      </div>\n                      \n                      <div className=\"space-y-3 mb-4\">\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"text-sm text-muted-foreground\">Harga</span>\n                          <span className=\"text-lg font-bold text-foreground\" data-testid={`text-price-${plan.id}`}>\n                            Rp {Number(plan.price).toLocaleString('id-ID')}\n                          </span>\n                        </div>\n                        <div className=\"flex items-center justify-between\">\n                          <span className=\"text-sm text-muted-foreground\">Masa Aktif</span>\n                          <span className=\"font-medium text-foreground\">\n                            {plan.durationMonths} {plan.durationMonths === 1 ? 'bulan' : 'bulan'}\n                          </span>\n                        </div>\n                      </div>\n\n                      {(() => {\n                        const features = plan.features as string[] | null;\n                        if (features && Array.isArray(features) && features.length > 0) {\n                          return (\n                            <div className=\"mb-4\">\n                              <p className=\"text-sm font-medium text-muted-foreground mb-2\">Fitur:</p>\n                              <ul className=\"space-y-1\">\n                                {features.slice(0, 3).map((feature: string, index: number) => (\n                                  <li key={index} className=\"text-xs text-muted-foreground flex items-center gap-2\">\n                                    <span className=\"w-1 h-1 rounded-full bg-primary\"></span>\n                                    {feature}\n                                  </li>\n                                ))}\n                              </ul>\n                              {features.length > 3 && (\n                                <p className=\"text-xs text-muted-foreground mt-1\">+{features.length - 3} lainnya</p>\n                              )}\n                            </div>\n                          );\n                        }\n                        return null;\n                      })()}\n\n                      <div className=\"flex items-center justify-between pt-3 border-t border-border\">\n                        <Badge \n                          variant={plan.active ? \"default\" : \"secondary\"}\n                        >\n                          {plan.active ? \"Aktif\" : \"Tidak Aktif\"}\n                        </Badge>\n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleEditMembershipPlan(plan)}\n                            data-testid={`button-edit-plan-${plan.id}`}\n                          >\n                            <Edit size={16} />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleDeleteMembershipPlan(plan.id)}\n                            data-testid={`button-delete-plan-${plan.id}`}\n                          >\n                            <Trash2 size={16} className=\"text-destructive\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Personal Trainers Management Section */}\n        <div className=\"mt-8\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Dumbbell className=\"text-primary\" size={20} />\n                    Personal Trainers\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-1\">Kelola personal trainer dan harga sesi</p>\n                </div>\n                <Button \n                  onClick={handleAddTrainer}\n                  className=\"gym-gradient text-white\"\n                  data-testid=\"button-add-trainer\"\n                >\n                  <UserPlus className=\"mr-2\" size={16} />\n                  Tambah Trainer\n                </Button>\n              </div>\n            </CardHeader>\n\n            <CardContent>\n              {!trainers || trainers.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <Dumbbell className=\"mx-auto mb-3\" size={48} />\n                  <p className=\"text-lg font-medium\">Belum Ada Personal Trainer</p>\n                  <p className=\"text-sm mt-1\">Tambahkan personal trainer pertama Anda</p>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                  {trainers.map((trainer: PersonalTrainer) => (\n                    <div \n                      key={trainer.id} \n                      className=\"border border-border rounded-lg p-4 hover:shadow-md transition-shadow\"\n                      data-testid={`card-trainer-${trainer.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar className=\"h-12 w-12\">\n                            <AvatarImage src={trainer.imageUrl || undefined} />\n                            <AvatarFallback className=\"gym-gradient text-white\">\n                              {trainer.name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2)}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div>\n                            <p className=\"font-semibold text-foreground\">{trainer.name}</p>\n                            <p className=\"text-xs text-muted-foreground\">{trainer.specialization}</p>\n                          </div>\n                        </div>\n                      </div>\n                      \n                      {trainer.bio && (\n                        <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                          {trainer.bio}\n                        </p>\n                      )}\n                      \n                      <div className=\"space-y-2 mb-4\">\n                        {trainer.experience && (\n                          <div className=\"flex items-center gap-2 text-sm\">\n                            <Clock size={14} className=\"text-muted-foreground\" />\n                            <span className=\"text-muted-foreground\">{trainer.experience} tahun pengalaman</span>\n                          </div>\n                        )}\n                        {trainer.certification && (\n                          <div className=\"flex items-center gap-2 text-sm\">\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              {trainer.certification}\n                            </Badge>\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"flex items-center justify-between pt-3 border-t border-border\">\n                        <div>\n                          <p className=\"text-xs text-muted-foreground\">Harga per Sesi</p>\n                          <p className=\"text-lg font-bold text-foreground\" data-testid={`text-price-${trainer.id}`}>\n                            ${trainer.pricePerSession}\n                          </p>\n                        </div>\n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleEditTrainer(trainer)}\n                            data-testid={`button-edit-trainer-${trainer.id}`}\n                          >\n                            <Edit size={16} />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleDeleteTrainer(trainer.id)}\n                            data-testid={`button-delete-trainer-${trainer.id}`}\n                          >\n                            <Trash2 size={16} className=\"text-destructive\" />\n                          </Button>\n                        </div>\n                      </div>\n\n                      <Badge \n                        variant={trainer.active ? \"default\" : \"secondary\"}\n                        className=\"mt-3 w-full justify-center\"\n                      >\n                        {trainer.active ? \"Aktif\" : \"Tidak Aktif\"}\n                      </Badge>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Gym Classes Management Section */}\n        <div className=\"mt-8\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"text-primary\" size={20} />\n                    Gym Classes\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-1\">Kelola kelas gym dan jadwal</p>\n                </div>\n                <Button \n                  onClick={handleAddClass}\n                  className=\"gym-gradient text-white\"\n                  data-testid=\"button-add-class\"\n                >\n                  <UserPlus className=\"mr-2\" size={16} />\n                  Tambah Class\n                </Button>\n              </div>\n            </CardHeader>\n\n            <CardContent>\n              {!gymClasses || gymClasses.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <Users className=\"mx-auto mb-3\" size={48} />\n                  <p className=\"text-lg font-medium\">Belum Ada Gym Class</p>\n                  <p className=\"text-sm mt-1\">Tambahkan gym class pertama Anda</p>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                  {gymClasses.map((gymClass: GymClass) => (\n                    <div \n                      key={gymClass.id} \n                      className=\"border border-border rounded-lg p-4 hover:shadow-md transition-shadow\"\n                      data-testid={`card-class-${gymClass.id}`}\n                    >\n                      <div className=\"mb-3\">\n                        <h4 className=\"font-semibold text-foreground text-lg\">{gymClass.name}</h4>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          Instruktur: {gymClass.instructorName}\n                        </p>\n                      </div>\n                      \n                      {gymClass.description && (\n                        <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">\n                          {gymClass.description}\n                        </p>\n                      )}\n                      \n                      <div className=\"space-y-2 mb-4\">\n                        <div className=\"flex items-center gap-2 text-sm\">\n                          <Clock size={14} className=\"text-muted-foreground\" />\n                          <span className=\"text-muted-foreground\">{gymClass.schedule}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm\">\n                          <Users size={14} className=\"text-muted-foreground\" />\n                          <span className=\"text-muted-foreground\">\n                            {gymClass.currentEnrollment}/{gymClass.maxCapacity} peserta\n                          </span>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center justify-between pt-3 border-t border-border\">\n                        <Badge \n                          variant={gymClass.active ? \"default\" : \"secondary\"}\n                        >\n                          {gymClass.active ? \"Aktif\" : \"Tidak Aktif\"}\n                        </Badge>\n                        <div className=\"flex gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleEditClass(gymClass)}\n                            data-testid={`button-edit-class-${gymClass.id}`}\n                          >\n                            <Edit size={16} />\n                          </Button>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            onClick={() => handleDeleteClass(gymClass.id)}\n                            data-testid={`button-delete-class-${gymClass.id}`}\n                          >\n                            <Trash2 size={16} className=\"text-destructive\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Member Feedback Section */}\n        <div className=\"mt-8\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <MessageSquare className=\"text-primary\" size={20} />\n                    Member Feedback\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-1\">Review member suggestions and feedback</p>\n                </div>\n                <Badge variant=\"outline\" className=\"text-sm\" data-testid=\"text-feedback-count\">\n                  {feedbacks?.length || 0} Total\n                </Badge>\n              </div>\n            </CardHeader>\n\n            <CardContent>\n              {!feedbacks || feedbacks.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <MessageSquare className=\"mx-auto mb-3\" size={48} />\n                  <p className=\"text-lg font-medium\">No Feedback Yet</p>\n                  <p className=\"text-sm mt-1\">Member feedback will appear here</p>\n                </div>\n              ) : (\n                <div className=\"space-y-4\">\n                  {feedbacks.map((feedback: any) => (\n                    <div \n                      key={feedback.id} \n                      className=\"border border-border rounded-lg p-4 hover:bg-muted/50 transition-colors\"\n                      data-testid={`feedback-item-${feedback.id}`}\n                    >\n                      <div className=\"flex items-start justify-between mb-3\">\n                        <div className=\"flex items-center gap-3\">\n                          <Avatar className=\"h-10 w-10\">\n                            <AvatarImage src={feedback.member?.profileImageUrl} />\n                            <AvatarFallback>\n                              {`${feedback.member?.firstName?.[0] || ''}${feedback.member?.lastName?.[0] || ''}`}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div>\n                            <p className=\"font-medium text-foreground\">\n                              {feedback.member?.firstName} {feedback.member?.lastName}\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {feedback.member?.email}\n                            </p>\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"flex items-center gap-1\">\n                            {[...Array(5)].map((_, i) => (\n                              <Star\n                                key={i}\n                                size={14}\n                                className={i < feedback.rating ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-300\"}\n                              />\n                            ))}\n                          </div>\n                          <Badge variant=\"outline\" className=\"ml-2\">\n                            {feedback.category}\n                          </Badge>\n                        </div>\n                      </div>\n                      \n                      <div className=\"bg-muted/30 rounded-md p-3\">\n                        <p className=\"text-sm text-foreground whitespace-pre-wrap\">\n                          {feedback.message}\n                        </p>\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between mt-3\">\n                        <p className=\"text-xs text-muted-foreground\">\n                          {new Date(feedback.createdAt).toLocaleString('id-ID', {\n                            year: 'numeric',\n                            month: 'long',\n                            day: 'numeric',\n                            hour: '2-digit',\n                            minute: '2-digit'\n                          })}\n                        </p>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Class Bookings Section */}\n        <div className=\"mt-8\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <CalendarCheck className=\"text-primary\" size={20} />\n                    Class Bookings\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-1\">Lihat semua booking class dari member</p>\n                </div>\n                <Badge variant=\"outline\" className=\"text-sm\" data-testid=\"text-class-bookings-count\">\n                  {classBookings?.length || 0} Total\n                </Badge>\n              </div>\n            </CardHeader>\n\n            <CardContent>\n              {!classBookings || classBookings.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <CalendarCheck className=\"mx-auto mb-3\" size={48} />\n                  <p className=\"text-lg font-medium\">Belum Ada Booking Class</p>\n                  <p className=\"text-sm mt-1\">Booking class dari member akan muncul di sini</p>\n                </div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full\">\n                    <thead className=\"bg-muted/50\">\n                      <tr>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Member\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Class\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Tanggal\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Status\n                        </th>\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-border\">\n                      {classBookings.map((booking: any) => (\n                        <tr key={booking.id} data-testid={`class-booking-row-${booking.id}`}>\n                          <td className=\"px-6 py-4\">\n                            <p className=\"text-sm font-medium text-foreground\">\n                              {`${booking.user?.firstName || ''} ${booking.user?.lastName || ''}`.trim()}\n                            </p>\n                            <p className=\"text-sm text-muted-foreground\">{booking.user?.email}</p>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <p className=\"text-sm font-medium text-foreground\">{booking.gymClass?.name}</p>\n                            <p className=\"text-sm text-muted-foreground\">\n                              {booking.gymClass?.instructorName}\n                            </p>\n                          </td>\n                          <td className=\"px-6 py-4 text-sm text-foreground\">\n                            {new Date(booking.bookingDate).toLocaleDateString('id-ID', {\n                              year: 'numeric',\n                              month: 'short',\n                              day: 'numeric'\n                            })}\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <Badge \n                              variant={\n                                booking.status === 'booked' ? 'default' :\n                                booking.status === 'cancelled' ? 'destructive' :\n                                'secondary'\n                              }\n                            >\n                              {booking.status === 'booked' ? 'Terdaftar' :\n                               booking.status === 'cancelled' ? 'Dibatalkan' :\n                               booking.status === 'attended' ? 'Hadir' : booking.status}\n                            </Badge>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* PT Bookings Section */}\n        <div className=\"mt-8\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Dumbbell className=\"text-primary\" size={20} />\n                    Personal Trainer Bookings\n                  </CardTitle>\n                  <p className=\"text-sm text-muted-foreground mt-1\">Lihat semua booking sesi PT dari member</p>\n                </div>\n                <Badge variant=\"outline\" className=\"text-sm\" data-testid=\"text-pt-bookings-count\">\n                  {ptBookings?.length || 0} Total\n                </Badge>\n              </div>\n            </CardHeader>\n\n            <CardContent>\n              {!ptBookings || ptBookings.length === 0 ? (\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  <Dumbbell className=\"mx-auto mb-3\" size={48} />\n                  <p className=\"text-lg font-medium\">Belum Ada Booking PT</p>\n                  <p className=\"text-sm mt-1\">Booking sesi PT dari member akan muncul di sini</p>\n                </div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <table className=\"w-full\">\n                    <thead className=\"bg-muted/50\">\n                      <tr>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Member\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Trainer\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Tanggal & Waktu\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Durasi\n                        </th>\n                        <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n                          Status\n                        </th>\n                      </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-border\">\n                      {ptBookings.map((booking: any) => (\n                        <tr key={booking.id} data-testid={`pt-booking-row-${booking.id}`}>\n                          <td className=\"px-6 py-4\">\n                            <p className=\"text-sm font-medium text-foreground\">\n                              {`${booking.user?.firstName || ''} ${booking.user?.lastName || ''}`.trim()}\n                            </p>\n                            <p className=\"text-sm text-muted-foreground\">{booking.user?.email}</p>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <p className=\"text-sm font-medium text-foreground\">{booking.trainer?.name}</p>\n                            <p className=\"text-sm text-muted-foreground\">\n                              {booking.trainer?.specialization}\n                            </p>\n                          </td>\n                          <td className=\"px-6 py-4 text-sm text-foreground\">\n                            {new Date(booking.bookingDate).toLocaleString('id-ID', {\n                              year: 'numeric',\n                              month: 'short',\n                              day: 'numeric',\n                              hour: '2-digit',\n                              minute: '2-digit'\n                            })}\n                          </td>\n                          <td className=\"px-6 py-4 text-sm text-foreground\">\n                            {booking.duration} menit\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <Badge \n                              variant={\n                                booking.status === 'confirmed' ? 'default' :\n                                booking.status === 'cancelled' ? 'destructive' :\n                                booking.status === 'pending' ? 'outline' :\n                                'secondary'\n                              }\n                            >\n                              {booking.status === 'pending' ? 'Menunggu' :\n                               booking.status === 'confirmed' ? 'Dikonfirmasi' :\n                               booking.status === 'cancelled' ? 'Dibatalkan' :\n                               booking.status === 'completed' ? 'Selesai' : booking.status}\n                            </Badge>\n                          </td>\n                        </tr>\n                      ))}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n\n      {/* Check-in Modal */}\n      <AdminCheckInModal \n        open={showCheckInModal} \n        onClose={() => setShowCheckInModal(false)}\n        onSuccess={() => {\n          queryClient.invalidateQueries({ queryKey: [\"/api/admin/checkins\"] });\n        }}\n      />\n\n      {/* Personal Trainer Dialog */}\n      <AdminPTDialog\n        open={showPTDialog}\n        onOpenChange={setShowPTDialog}\n        trainer={selectedTrainer}\n      />\n\n      {/* Gym Class Dialog */}\n      <AdminClassDialog\n        open={showClassDialog}\n        onOpenChange={setShowClassDialog}\n        gymClass={selectedClass}\n      />\n\n      {/* Add Member Dialog */}\n      <AdminMemberDialog\n        open={showMemberDialog}\n        onOpenChange={setShowMemberDialog}\n      />\n\n      {/* Edit Member Dialog */}\n      <AdminEditMemberDialog\n        open={showEditMemberDialog}\n        onOpenChange={setShowEditMemberDialog}\n        member={selectedMember}\n      />\n\n      {/* Membership Plan Dialog */}\n      <AdminMembershipPlanDialog\n        open={showMembershipPlanDialog}\n        onOpenChange={setShowMembershipPlanDialog}\n        plan={selectedMembershipPlan}\n      />\n    </div>\n  );\n}\n","size_bytes":63837},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { storage } from \"./storage\";\n\nconst app = express();\napp.use(express.json({ limit: '10mb' }));\napp.use(express.urlencoded({ extended: false, limit: '10mb' }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"â€¦\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    if (!res.headersSent) {\n      res.status(status).json({ message });\n    }\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    setInterval(async () => {\n      try {\n        const checkedOutCount = await storage.autoCheckoutExpiredSessions();\n        if (checkedOutCount > 0) {\n          log(`Auto-checkout job: ${checkedOutCount} member(s) automatically checked out`);\n        }\n      } catch (error) {\n        console.error(\"Error in auto-checkout job:\", error);\n      }\n    }, 60000);\n    \n    log(\"Auto-checkout job started - runs every 1 minute\");\n    \n    // Inactivity reminder job - runs once every 24 hours\n    setInterval(async () => {\n      try {\n        const reminderCount = await storage.sendInactivityReminders(7);\n        if (reminderCount > 0) {\n          log(`Inactivity reminder job: ${reminderCount} reminder(s) sent to inactive members`);\n        }\n      } catch (error) {\n        console.error(\"Error in inactivity reminder job:\", error);\n      }\n    }, 24 * 60 * 60 * 1000); // 24 hours in milliseconds\n    \n    log(\"Inactivity reminder job started - runs every 24 hours\");\n  });\n})();\n","size_bytes":3149},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"replit.md":{"content":"# Idachi Fitness Gym Management System\n\n## Overview\n\nIdachi Fitness is a comprehensive gym management platform designed to streamline gym operations and enhance member experience. The system provides dual interfaces - a member portal for workout tracking, class bookings, and membership management, and an administrative dashboard for gym operations, member management, and business analytics. The platform supports modern payment processing, QR-based check-ins, class scheduling, and membership lifecycle management.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\nThe client application uses React with TypeScript, built with Vite for development and bundling. The UI follows a component-based architecture using shadcn/ui components with Radix UI primitives and Tailwind CSS for styling. State management is handled through TanStack React Query for server state and React hooks for local state. Routing is implemented with Wouter for a lightweight solution.\n\n#### UI/UX Design\nThe application features modern, responsive design with:\n- **Authentication Pages**: Split-screen layouts with gradient backgrounds, glassmorphism effects, and hero sections featuring brand messaging. All forms include icon-enhanced inputs, password visibility toggles, and smooth transitions.\n- **Password Security**: Real-time password strength indicators on registration forms with visual feedback (weak/medium/strong) based on length, character variety, and complexity.\n- **Selfie Verification**: Mandatory selfie capture during registration using device camera. The system enforces front-facing camera (selfie mode) only, with no file upload option. Registration cannot proceed without capturing a selfie photo, which is automatically saved as the user's profile image.\n- **Cookie Consent System**: GDPR-compliant cookie management with consent banner, granular preference controls, and persistent storage. Users can customize analytics, marketing, and preference cookies independently.\n- **Responsive Design**: Mobile-first approach with adaptive layouts that progressively enhance for larger screens, ensuring optimal UX across all devices.\n\n### Backend Architecture\nThe server uses Express.js with TypeScript in an ESM environment. The API follows RESTful patterns with route-based organization. Authentication is implemented using Passport.js with local strategy (email/username/phone + password), supporting secure password hashing with bcryptjs. Session storage is handled by connect-pg-simple with PostgreSQL backing.\n\n### Database Design\nData persistence uses PostgreSQL with Drizzle ORM for type-safe database operations. The schema includes comprehensive entities for users, memberships, membership plans, gym classes, class bookings, check-ins, and payments. Relations are properly defined between entities, and the system supports both session storage and application data in the same database.\n\n### Payment Integration\nThe system supports multiple payment gateways:\n- **Stripe Integration**: For international payments with full subscription management\n- **Midtrans Integration**: For Indonesian market payment processing\n- **QRIS Support**: QR code-based payments popular in Indonesian market\nBoth payment systems are designed as optional modules that can be configured based on deployment requirements.\n\n### Authentication & Authorization\nAuthentication uses Passport.js local strategy supporting login with email, username, or phone number. Passwords are securely hashed using bcryptjs. The system implements role-based access control with \"member\" and \"admin\" roles. Email verification is required for new members (admin accounts bypass verification). Session management includes secure cookie handling (HTTPS-only in production) and automatic session cleanup via PostgreSQL. Unauthorized access returns 401/403 status codes.\n\n### File Organization\nThe codebase follows a monorepo structure with clear separation:\n- `/client` - React frontend application\n- `/server` - Express backend API\n- `/shared` - Shared TypeScript schemas and types\nThis structure enables type sharing between frontend and backend while maintaining clear boundaries.\n\n## Key Features\n\n### Member Inactivity Reminders\nThe system automatically tracks member activity and sends reminders to inactive members:\n- **Auto-detection**: Identifies members who haven't checked in for 7 days\n- **Dual Notifications**: \n  - In-app notification with message: \"Ayo nge-gym lagi! Jangan tunggu nanti â€” mulai hari ini! ðŸ’ª\"\n  - Email notification with motivational message and booking link\n- **Scheduled Task**: Runs automatically every 24 hours to check and notify inactive members\n- **Admin Controls**: \n  - Manual trigger: `POST /api/admin/send-inactivity-reminders` (with optional `daysInactive` parameter)\n  - View inactive members: `GET /api/admin/inactive-members?days=7`\n\n## External Dependencies\n\n### Core Infrastructure\n- **PostgreSQL Database**: Any PostgreSQL hosting (Neon, Supabase, self-hosted) with connection pooling via @neondatabase/serverless\n- **Session Store**: PostgreSQL-backed sessions using connect-pg-simple\n- **Development Tools**: Vite for hot reloading, TypeScript for type safety, and ESLint for code quality\n\n### Payment Providers\n- **Stripe**: International payment processing with webhook support\n- **Midtrans**: Indonesian payment gateway supporting multiple local payment methods\n- **QRIS**: QR code payment system integration\n\n### UI & Styling Framework\n- **shadcn/ui**: Pre-built component library built on Radix UI primitives\n- **Tailwind CSS**: Utility-first CSS framework with custom theme configuration\n- **Radix UI**: Headless component primitives for accessibility and behavior\n\n### Development & Build Tools\n- **Vite**: Frontend build tool and development server\n- **TypeScript**: Type safety across the entire stack\n- **Drizzle ORM**: Type-safe database operations with migration support\n- **TanStack React Query**: Server state management and caching\n\n### Email Service\n- **Resend**: Transactional email service for password reset, email verification, and member inactivity notifications\n  - **Configuration Required**: \n    - Set `RESEND_API_KEY` environment variable (get from https://resend.com/api-keys)\n    - Set `RESEND_FROM_EMAIL` environment variable (e.g., \"noreply@yourdomain.com\")\n    - Verify your sending domain at https://resend.com/domains for production use\n  - **Default**: Falls back to \"onboarding@resend.dev\" if RESEND_FROM_EMAIL is not set (development only)","size_bytes":6571},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Eye, EyeOff } from \"lucide-react\";\nimport { SiGoogle } from \"react-icons/si\";\nimport { useState } from \"react\";\nimport logoPath from \"@assets/image_1759411904981.png\";\n\nexport default function Landing() {\n  const [showPassword, setShowPassword] = useState(false);\n  const [rememberMe, setRememberMe] = useState(false);\n  const [agreedToTerms, setAgreedToTerms] = useState(false);\n\n  const handleLogin = () => {\n    window.location.href = \"/api/login\";\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-[#1a1047] via-[#2d1b69] to-[#1e3a8a] p-4\">\n      <div className=\"w-full max-w-lg\">\n        <div className=\"text-center mb-8\">\n          {/* Logo */}\n          <div className=\"flex justify-center mb-6\">\n            <img \n              src={logoPath} \n              alt=\"Idachi Fitness Logo\" \n              className=\"w-40 h-40 object-contain\"\n              data-testid=\"img-logo\"\n            />\n          </div>\n          \n          {/* Title */}\n          <h1 className=\"text-3xl font-bold text-yellow-400 mb-2\" data-testid=\"text-title\">\n            Idachi Fitness Jakarta\n          </h1>\n          <p className=\"text-gray-300 text-sm\" data-testid=\"text-subtitle\">\n            Sign in for access member portal\n          </p>\n        </div>\n\n        {/* Login Form */}\n        <div className=\"space-y-4\">\n          {/* Username Input */}\n          <Input\n            type=\"text\"\n            placeholder=\"Username\"\n            className=\"bg-[#2a3a4a] border-none text-white placeholder:text-gray-400 h-14\"\n            data-testid=\"input-username\"\n          />\n\n          {/* Password Input */}\n          <div className=\"relative\">\n            <Input\n              type={showPassword ? \"text\" : \"password\"}\n              placeholder=\"Password\"\n              className=\"bg-[#2a3a4a] border-none text-white placeholder:text-gray-400 h-14 pr-12\"\n              data-testid=\"input-password\"\n            />\n            <button\n              type=\"button\"\n              onClick={() => setShowPassword(!showPassword)}\n              className=\"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white\"\n              data-testid=\"button-toggle-password\"\n            >\n              {showPassword ? <EyeOff size={20} /> : <Eye size={20} />}\n            </button>\n          </div>\n\n          {/* Terms and Conditions Checkbox */}\n          <div className=\"flex items-start space-x-3\">\n            <Checkbox\n              id=\"terms\"\n              checked={agreedToTerms}\n              onCheckedChange={(checked) => setAgreedToTerms(checked as boolean)}\n              className=\"mt-1 border-gray-400 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500\"\n              data-testid=\"checkbox-terms\"\n            />\n            <label htmlFor=\"terms\" className=\"text-xs text-gray-300 leading-tight cursor-pointer\">\n              By signing in as a member, I confirm that I have read, understood, and agree to the{\" \"}\n              <span className=\"text-yellow-400 font-semibold\">Idachi Fitness Jakarta Terms and Conditions</span>.\n            </label>\n          </div>\n\n          {/* Sign In Button */}\n          <Button\n            onClick={handleLogin}\n            className=\"w-full bg-cyan-500 hover:bg-cyan-600 text-white font-bold h-12 text-base\"\n            data-testid=\"button-signin\"\n          >\n            SIGN - IN\n          </Button>\n\n          {/* Login with Google */}\n          <Button\n            onClick={handleLogin}\n            variant=\"outline\"\n            className=\"w-full bg-white hover:bg-gray-100 text-gray-800 font-medium h-12 border-none\"\n            data-testid=\"button-google\"\n          >\n            <SiGoogle className=\"mr-2\" size={18} />\n            Login dengan Google\n          </Button>\n\n          {/* Remember Me & Forgot Password */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-2\">\n              <Checkbox\n                id=\"remember\"\n                checked={rememberMe}\n                onCheckedChange={(checked) => setRememberMe(checked as boolean)}\n                className=\"border-gray-400 data-[state=checked]:bg-cyan-500 data-[state=checked]:border-cyan-500\"\n                data-testid=\"checkbox-remember\"\n              />\n              <label htmlFor=\"remember\" className=\"text-sm text-gray-300 cursor-pointer\">\n                Remember Me\n              </label>\n            </div>\n            <a href=\"#\" className=\"text-sm text-gray-300 hover:text-white\" data-testid=\"link-forgot-password\">\n              Forgot Password?\n            </a>\n          </div>\n\n          {/* Register Button */}\n          <Button\n            onClick={handleLogin}\n            variant=\"outline\"\n            className=\"w-full bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium h-12 border-none\"\n            data-testid=\"button-register\"\n          >\n            ðŸ‘¤ Register as Member\n          </Button>\n\n          {/* Need Help */}\n          <p className=\"text-center text-sm text-gray-400\" data-testid=\"text-help\">\n            Need Help?{\" \"}\n            <a href=\"#\" className=\"text-cyan-400 hover:text-cyan-300 font-medium\">\n              Contact Us\n            </a>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5465},"server/storage.ts":{"content":"import {\n  users,\n  memberships,\n  membershipPlans,\n  gymClasses,\n  classBookings,\n  checkIns,\n  payments,\n  feedbacks,\n  personalTrainers,\n  ptBookings,\n  ptSessionPackages,\n  ptSessionAttendance,\n  oneTimeQrCodes,\n  passwordResetTokens,\n  notifications,\n  pushSubscriptions,\n  type User,\n  type UpsertUser,\n  type Membership,\n  type InsertMembership,\n  type MembershipPlan,\n  type InsertMembershipPlan,\n  type GymClass,\n  type InsertGymClass,\n  type ClassBooking,\n  type InsertClassBooking,\n  type CheckIn,\n  type InsertCheckIn,\n  type Payment,\n  type InsertPayment,\n  type Feedback,\n  type InsertFeedback,\n  type PersonalTrainer,\n  type InsertPersonalTrainer,\n  type PtBooking,\n  type InsertPtBooking,\n  type PtSessionPackage,\n  type InsertPtSessionPackage,\n  type PtSessionAttendance,\n  type InsertPtSessionAttendance,\n  type OneTimeQrCode,\n  type InsertOneTimeQrCode,\n  type PasswordResetToken,\n  type InsertPasswordResetToken,\n  type Notification,\n  type InsertNotification,\n  type PushSubscription,\n  type InsertPushSubscription,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, gte, lte, and, or, count, sum } from \"drizzle-orm\";\nimport { sendInactivityReminderEmail } from \"./email/resend\";\n\nexport interface IStorage {\n  // User operations\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByEmailOrPhoneOrUsername(identifier: string): Promise<User | undefined>;\n  getUserByPermanentQrCode(qrCode: string): Promise<User | undefined>;\n  createUser(user: UpsertUser): Promise<User>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  updateUser(id: string, user: Partial<UpsertUser>): Promise<User>;\n  deleteUser(id: string): Promise<void>;\n  updateUserStripeInfo(userId: string, customerId: string, subscriptionId?: string): Promise<User>;\n  ensureUserPermanentQrCode(userId: string): Promise<string>;\n  \n  // Membership operations\n  getMembershipPlans(): Promise<MembershipPlan[]>;\n  getAllMembershipPlans(): Promise<MembershipPlan[]>;\n  createMembershipPlan(plan: InsertMembershipPlan): Promise<MembershipPlan>;\n  updateMembershipPlan(id: string, plan: Partial<InsertMembershipPlan>): Promise<MembershipPlan>;\n  deleteMembershipPlan(id: string): Promise<void>;\n  getUserMembership(userId: string): Promise<(Membership & { plan: MembershipPlan }) | undefined>;\n  createMembership(membership: InsertMembership): Promise<Membership>;\n  updateMembership(id: string, membership: Partial<InsertMembership>): Promise<void>;\n  updateMembershipStatus(id: string, status: string): Promise<void>;\n  cancelUserMemberships(userId: string): Promise<void>;\n  getExpiringMemberships(days: number): Promise<(Membership & { user: User; plan: MembershipPlan })[]>;\n  \n  // Class operations\n  getGymClasses(): Promise<GymClass[]>;\n  createGymClass(gymClass: InsertGymClass): Promise<GymClass>;\n  updateGymClass(id: string, gymClass: Partial<InsertGymClass>): Promise<void>;\n  deleteGymClass(id: string): Promise<void>;\n  getUserClassBookings(userId: string): Promise<(ClassBooking & { gymClass: GymClass })[]>;\n  getAllClassBookings(): Promise<(ClassBooking & { user: User; gymClass: GymClass })[]>;\n  bookClass(booking: InsertClassBooking): Promise<ClassBooking>;\n  updateClassBookingStatus(id: string, status: string): Promise<void>;\n  cancelClassBooking(id: string): Promise<void>;\n  \n  // Check-in operations\n  getUserCheckIns(userId: string, limit?: number): Promise<CheckIn[]>;\n  createCheckIn(checkIn: InsertCheckIn): Promise<CheckIn>;\n  updateCheckOut(id: string): Promise<void>;\n  getCurrentCrowdCount(): Promise<number>;\n  validateCheckInQR(qrCode: string): Promise<(CheckIn & { user: User; membership?: Membership & { plan: MembershipPlan } }) | undefined>;\n  validateMemberQrAndCheckIn(qrCode: string): Promise<(CheckIn & { user: User; membership?: Membership & { plan: MembershipPlan } }) | undefined>;\n  getRecentCheckIns(limit?: number): Promise<(CheckIn & { user: User; membership?: Membership & { plan: MembershipPlan } })[]>;\n  autoCheckoutExpiredSessions(): Promise<number>;\n  \n  // One-time QR code operations\n  generateOneTimeQrCode(userId: string): Promise<OneTimeQrCode>;\n  validateOneTimeQrCode(qrCode: string): Promise<(OneTimeQrCode & { user: User; membership?: Membership & { plan: MembershipPlan } }) | undefined>;\n  markQrCodeAsUsed(qrCode: string): Promise<void>;\n  cleanupExpiredQrCodes(): Promise<number>;\n  \n  // Payment operations\n  getUserPayments(userId: string): Promise<Payment[]>;\n  createPayment(payment: InsertPayment): Promise<Payment>;\n  updatePaymentStatus(id: string, status: string): Promise<void>;\n  updatePaymentStatusByTransactionId(transactionId: string, status: string): Promise<void>;\n  getPaymentByOrderId(orderId: string): Promise<Payment | undefined>;\n  \n  // Admin operations\n  getAllUsers(): Promise<User[]>;\n  getUsersWithMemberships(): Promise<(User & { membership?: Membership & { plan: MembershipPlan } })[]>;\n  getRevenueStats(): Promise<{ total: number; thisMonth: number; lastMonth: number }>;\n  getMembershipStats(): Promise<{ total: number; active: number; expiringSoon: number }>;\n  \n  // Feedback operations\n  createFeedback(feedback: InsertFeedback): Promise<Feedback>;\n  getUserFeedbacks(userId: string): Promise<Feedback[]>;\n  getAllFeedbacks(): Promise<(Feedback & { user: User })[]>;\n  updateFeedbackStatus(id: string, status: string, adminResponse?: string): Promise<void>;\n  \n  // Personal Trainer operations\n  getAllTrainers(): Promise<PersonalTrainer[]>;\n  getActiveTrainers(): Promise<PersonalTrainer[]>;\n  getTrainerById(id: string): Promise<PersonalTrainer | undefined>;\n  createTrainer(trainer: InsertPersonalTrainer): Promise<PersonalTrainer>;\n  updateTrainer(id: string, trainer: Partial<InsertPersonalTrainer>): Promise<void>;\n  deleteTrainer(id: string): Promise<void>;\n  \n  // PT Booking operations\n  getUserPtBookings(userId: string): Promise<(PtBooking & { trainer: PersonalTrainer })[]>;\n  getAllPtBookings(): Promise<(PtBooking & { user: User; trainer: PersonalTrainer })[]>;\n  getPtBookingById(id: string): Promise<(PtBooking & { user: User; trainer: PersonalTrainer }) | undefined>;\n  createPtBooking(booking: InsertPtBooking): Promise<PtBooking>;\n  updatePtBookingStatus(id: string, status: string): Promise<void>;\n  cancelPtBooking(id: string): Promise<void>;\n  \n  // PT Session Package operations\n  createPtSessionPackage(packageData: InsertPtSessionPackage): Promise<PtSessionPackage>;\n  getUserPtSessionPackages(userId: string): Promise<(PtSessionPackage & { trainer: PersonalTrainer })[]>;\n  getPtSessionPackageById(id: string): Promise<(PtSessionPackage & { trainer: PersonalTrainer; user: User }) | undefined>;\n  updatePtSessionPackage(id: string, packageData: Partial<InsertPtSessionPackage>): Promise<void>;\n  \n  // PT Session Attendance operations\n  createPtSessionAttendance(attendanceData: InsertPtSessionAttendance): Promise<PtSessionAttendance>;\n  getPackageAttendanceSessions(packageId: string): Promise<(PtSessionAttendance & { trainer: PersonalTrainer })[]>;\n  getUserPtAttendanceSessions(userId: string): Promise<(PtSessionAttendance & { trainer: PersonalTrainer; package: PtSessionPackage })[]>;\n  getPtSessionAttendanceById(id: string): Promise<(PtSessionAttendance & { trainer: PersonalTrainer; user: User; package: PtSessionPackage }) | undefined>;\n  updatePtSessionAttendance(id: string, attendanceData: Partial<InsertPtSessionAttendance>): Promise<void>;\n  confirmPtSessionAttendance(id: string, adminId: string): Promise<void>;\n  \n  // Password Reset operations\n  createPasswordResetToken(email: string, token: string): Promise<PasswordResetToken>;\n  getPasswordResetToken(token: string): Promise<PasswordResetToken | undefined>;\n  markTokenAsUsed(token: string): Promise<void>;\n  cleanupExpiredResetTokens(): Promise<number>;\n  updateUserPassword(email: string, newPassword: string): Promise<void>;\n  \n  // Email verification operations\n  storeVerificationCode(email: string, code: string): Promise<void>;\n  verifyEmailCode(email: string, code: string): Promise<boolean>;\n  \n  // Notification operations\n  getUserNotifications(userId: string): Promise<Notification[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationAsRead(id: string, userId: string): Promise<void>;\n  markAllNotificationsAsRead(userId: string): Promise<void>;\n  deleteNotification(id: string, userId: string): Promise<void>;\n  \n  // Push Subscription operations\n  getUserPushSubscriptions(userId: string): Promise<PushSubscription[]>;\n  createPushSubscription(subscription: InsertPushSubscription): Promise<PushSubscription>;\n  deletePushSubscription(endpoint: string, userId: string): Promise<void>;\n  getAllPushSubscriptions(userId: string): Promise<PushSubscription[]>;\n  \n  // Inactive member operations\n  getInactiveMembers(daysInactive: number): Promise<(User & { membership: Membership & { plan: MembershipPlan } })[]>;\n  sendInactivityReminders(daysInactive: number): Promise<number>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.username, username));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async getUserByEmailOrPhoneOrUsername(identifier: string): Promise<User | undefined> {\n    // Normalize identifier (trim)\n    const normalizedIdentifier = identifier.trim();\n    \n    // Try to find user by username first\n    let user = await this.getUserByUsername(normalizedIdentifier);\n    if (user) return user;\n    \n    // Try to find user by email\n    user = await this.getUserByEmail(normalizedIdentifier);\n    if (user) return user;\n    \n    // Try to find user by phone (only if identifier is not empty and phone exists)\n    const [userByPhone] = await db\n      .select()\n      .from(users)\n      .where(eq(users.phone, normalizedIdentifier))\n      .limit(1);\n    \n    return userByPhone;\n  }\n\n  async createUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(userData).returning();\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  async updateUser(id: string, userData: Partial<UpsertUser>): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({\n        ...userData,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  async deleteUser(id: string): Promise<void> {\n    await db.delete(users).where(eq(users.id, id));\n  }\n\n  async updateUserStripeInfo(userId: string, customerId: string, subscriptionId?: string): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({\n        stripeCustomerId: customerId,\n        stripeSubscriptionId: subscriptionId,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, userId))\n      .returning();\n    return user;\n  }\n\n  async getUserByPermanentQrCode(qrCode: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.permanentQrCode, qrCode));\n    return user;\n  }\n\n  async ensureUserPermanentQrCode(userId: string): Promise<string> {\n    const user = await this.getUser(userId);\n    if (!user) {\n      throw new Error('User not found');\n    }\n    \n    // If user already has a permanent QR code, return it\n    if (user.permanentQrCode) {\n      return user.permanentQrCode;\n    }\n    \n    // Generate a new permanent QR code\n    const { randomUUID } = await import('crypto');\n    const qrCode = randomUUID();\n    \n    // Update user with new permanent QR code\n    await db\n      .update(users)\n      .set({\n        permanentQrCode: qrCode,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.id, userId));\n    \n    return qrCode;\n  }\n\n  // Membership operations\n  async getMembershipPlans(): Promise<MembershipPlan[]> {\n    return await db.select().from(membershipPlans).where(eq(membershipPlans.active, true));\n  }\n\n  async getAllMembershipPlans(): Promise<MembershipPlan[]> {\n    return await db.select().from(membershipPlans);\n  }\n\n  async createMembershipPlan(plan: InsertMembershipPlan): Promise<MembershipPlan> {\n    const [newPlan] = await db.insert(membershipPlans).values(plan).returning();\n    return newPlan;\n  }\n\n  async updateMembershipPlan(id: string, plan: Partial<InsertMembershipPlan>): Promise<MembershipPlan> {\n    const [updatedPlan] = await db\n      .update(membershipPlans)\n      .set(plan)\n      .where(eq(membershipPlans.id, id))\n      .returning();\n    return updatedPlan;\n  }\n\n  async deleteMembershipPlan(id: string): Promise<void> {\n    await db.update(membershipPlans).set({ active: false }).where(eq(membershipPlans.id, id));\n  }\n\n  async getUserMembership(userId: string): Promise<(Membership & { plan: MembershipPlan }) | undefined> {\n    const result = await db\n      .select({\n        id: memberships.id,\n        userId: memberships.userId,\n        planId: memberships.planId,\n        startDate: memberships.startDate,\n        endDate: memberships.endDate,\n        status: memberships.status,\n        autoRenewal: memberships.autoRenewal,\n        createdAt: memberships.createdAt,\n        plan: membershipPlans,\n      })\n      .from(memberships)\n      .innerJoin(membershipPlans, eq(memberships.planId, membershipPlans.id))\n      .where(and(eq(memberships.userId, userId), eq(memberships.status, \"active\")))\n      .limit(1);\n\n    return result[0];\n  }\n\n  async createMembership(membership: InsertMembership): Promise<Membership> {\n    const [newMembership] = await db.insert(memberships).values(membership).returning();\n    return newMembership;\n  }\n\n  async updateMembership(id: string, membershipData: Partial<InsertMembership>): Promise<void> {\n    await db.update(memberships).set(membershipData).where(eq(memberships.id, id));\n  }\n\n  async updateMembershipStatus(id: string, status: string): Promise<void> {\n    await db.update(memberships).set({ status }).where(eq(memberships.id, id));\n  }\n\n  async cancelUserMemberships(userId: string): Promise<void> {\n    await db.update(memberships)\n      .set({ status: 'cancelled' })\n      .where(eq(memberships.userId, userId));\n  }\n\n  async getExpiringMemberships(days: number): Promise<(Membership & { user: User; plan: MembershipPlan })[]> {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() + days);\n\n    return await db\n      .select({\n        id: memberships.id,\n        userId: memberships.userId,\n        planId: memberships.planId,\n        startDate: memberships.startDate,\n        endDate: memberships.endDate,\n        status: memberships.status,\n        autoRenewal: memberships.autoRenewal,\n        createdAt: memberships.createdAt,\n        user: users,\n        plan: membershipPlans,\n      })\n      .from(memberships)\n      .innerJoin(users, eq(memberships.userId, users.id))\n      .innerJoin(membershipPlans, eq(memberships.planId, membershipPlans.id))\n      .where(\n        and(\n          eq(memberships.status, \"active\"),\n          lte(memberships.endDate, cutoffDate)\n        )\n      );\n  }\n\n  // Class operations\n  async getGymClasses(): Promise<GymClass[]> {\n    return await db.select().from(gymClasses).where(eq(gymClasses.active, true));\n  }\n\n  async createGymClass(gymClass: InsertGymClass): Promise<GymClass> {\n    const [newClass] = await db.insert(gymClasses).values(gymClass).returning();\n    return newClass;\n  }\n\n  async updateGymClass(id: string, gymClass: Partial<InsertGymClass>): Promise<void> {\n    await db.update(gymClasses).set(gymClass).where(eq(gymClasses.id, id));\n  }\n\n  async deleteGymClass(id: string): Promise<void> {\n    await db.update(gymClasses).set({ active: false }).where(eq(gymClasses.id, id));\n  }\n\n  async getUserClassBookings(userId: string): Promise<(ClassBooking & { gymClass: GymClass })[]> {\n    return await db\n      .select({\n        id: classBookings.id,\n        userId: classBookings.userId,\n        classId: classBookings.classId,\n        bookingDate: classBookings.bookingDate,\n        status: classBookings.status,\n        createdAt: classBookings.createdAt,\n        gymClass: gymClasses,\n      })\n      .from(classBookings)\n      .innerJoin(gymClasses, eq(classBookings.classId, gymClasses.id))\n      .where(eq(classBookings.userId, userId))\n      .orderBy(desc(classBookings.bookingDate));\n  }\n\n  async getAllClassBookings(): Promise<(ClassBooking & { user: User; gymClass: GymClass })[]> {\n    return await db\n      .select({\n        id: classBookings.id,\n        userId: classBookings.userId,\n        classId: classBookings.classId,\n        bookingDate: classBookings.bookingDate,\n        status: classBookings.status,\n        createdAt: classBookings.createdAt,\n        user: users,\n        gymClass: gymClasses,\n      })\n      .from(classBookings)\n      .innerJoin(users, eq(classBookings.userId, users.id))\n      .innerJoin(gymClasses, eq(classBookings.classId, gymClasses.id))\n      .orderBy(desc(classBookings.bookingDate));\n  }\n\n  async bookClass(booking: InsertClassBooking): Promise<ClassBooking> {\n    const [newBooking] = await db.insert(classBookings).values(booking).returning();\n    \n    // Update class enrollment count - get current count first\n    const currentBookings = await db\n      .select({ count: count() })\n      .from(classBookings)\n      .where(and(eq(classBookings.classId, booking.classId), eq(classBookings.status, \"booked\")));\n    \n    await db\n      .update(gymClasses)\n      .set({ currentEnrollment: currentBookings[0]?.count || 0 })\n      .where(eq(gymClasses.id, booking.classId));\n    \n    return newBooking;\n  }\n\n  async updateClassBookingStatus(id: string, status: string): Promise<void> {\n    const [booking] = await db.select().from(classBookings).where(eq(classBookings.id, id));\n    \n    if (!booking) {\n      return;\n    }\n\n    await db.update(classBookings).set({ status }).where(eq(classBookings.id, id));\n    \n    // Update class enrollment count\n    const currentBookings = await db\n      .select({ count: count() })\n      .from(classBookings)\n      .where(and(eq(classBookings.classId, booking.classId), eq(classBookings.status, \"booked\")));\n    \n    await db\n      .update(gymClasses)\n      .set({ currentEnrollment: currentBookings[0]?.count || 0 })\n      .where(eq(gymClasses.id, booking.classId));\n  }\n\n  async cancelClassBooking(id: string): Promise<void> {\n    const [booking] = await db.select().from(classBookings).where(eq(classBookings.id, id));\n    \n    if (!booking || booking.status === 'cancelled') {\n      return;\n    }\n\n    await db.update(classBookings).set({ status: \"cancelled\" }).where(eq(classBookings.id, id));\n    \n    const currentBookings = await db\n      .select({ count: count() })\n      .from(classBookings)\n      .where(and(eq(classBookings.classId, booking.classId), eq(classBookings.status, \"booked\")));\n    \n    await db\n      .update(gymClasses)\n      .set({ currentEnrollment: currentBookings[0]?.count || 0 })\n      .where(eq(gymClasses.id, booking.classId));\n  }\n\n  // Check-in operations\n  async getUserCheckIns(userId: string, limit = 10): Promise<CheckIn[]> {\n    return await db\n      .select()\n      .from(checkIns)\n      .where(eq(checkIns.userId, userId))\n      .orderBy(desc(checkIns.checkInTime))\n      .limit(limit);\n  }\n\n  async createCheckIn(checkIn: InsertCheckIn): Promise<CheckIn> {\n    const [newCheckIn] = await db.insert(checkIns).values(checkIn).returning();\n    return newCheckIn;\n  }\n\n  async updateCheckOut(id: string): Promise<void> {\n    await db\n      .update(checkIns)\n      .set({ checkOutTime: new Date(), status: \"completed\" })\n      .where(eq(checkIns.id, id));\n  }\n\n  async getCurrentCrowdCount(): Promise<number> {\n    const result = await db\n      .select({ count: count() })\n      .from(checkIns)\n      .where(eq(checkIns.status, \"active\"));\n    \n    return result[0]?.count || 0;\n  }\n\n  async validateCheckInQR(qrCode: string): Promise<(CheckIn & { user: User; membership?: Membership & { plan: MembershipPlan } }) | undefined> {\n    const result = await db\n      .select({\n        id: checkIns.id,\n        userId: checkIns.userId,\n        checkInTime: checkIns.checkInTime,\n        checkOutTime: checkIns.checkOutTime,\n        qrCode: checkIns.qrCode,\n        status: checkIns.status,\n        createdAt: checkIns.createdAt,\n        user: users,\n        membershipId: memberships.id,\n        membershipUserId: memberships.userId,\n        membershipPlanId: memberships.planId,\n        membershipStartDate: memberships.startDate,\n        membershipEndDate: memberships.endDate,\n        membershipStatus: memberships.status,\n        membershipAutoRenewal: memberships.autoRenewal,\n        membershipCreatedAt: memberships.createdAt,\n        planId: membershipPlans.id,\n        planName: membershipPlans.name,\n        planDescription: membershipPlans.description,\n        planPrice: membershipPlans.price,\n        planDurationMonths: membershipPlans.durationMonths,\n        planFeatures: membershipPlans.features,\n        planStripePriceId: membershipPlans.stripePriceId,\n        planActive: membershipPlans.active,\n        planCreatedAt: membershipPlans.createdAt,\n      })\n      .from(checkIns)\n      .innerJoin(users, eq(checkIns.userId, users.id))\n      .leftJoin(memberships, and(eq(users.id, memberships.userId), eq(memberships.status, \"active\")))\n      .leftJoin(membershipPlans, eq(memberships.planId, membershipPlans.id))\n      .where(and(eq(checkIns.qrCode, qrCode), eq(checkIns.status, \"active\")))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n\n    const row = result[0];\n    return {\n      id: row.id,\n      userId: row.userId,\n      checkInTime: row.checkInTime,\n      checkOutTime: row.checkOutTime,\n      qrCode: row.qrCode,\n      status: row.status,\n      createdAt: row.createdAt,\n      user: row.user,\n      membership: row.membershipId ? {\n        id: row.membershipId,\n        userId: row.membershipUserId!,\n        planId: row.membershipPlanId!,\n        startDate: row.membershipStartDate!,\n        endDate: row.membershipEndDate!,\n        status: row.membershipStatus!,\n        autoRenewal: row.membershipAutoRenewal!,\n        createdAt: row.membershipCreatedAt!,\n        plan: {\n          id: row.planId!,\n          name: row.planName!,\n          description: row.planDescription,\n          price: row.planPrice!,\n          durationMonths: row.planDurationMonths!,\n          features: row.planFeatures,\n          stripePriceId: row.planStripePriceId,\n          active: row.planActive!,\n          createdAt: row.planCreatedAt!,\n        }\n      } : undefined\n    };\n  }\n\n  async validateMemberQrAndCheckIn(qrCode: string): Promise<(CheckIn & { user: User; membership?: Membership & { plan: MembershipPlan } }) | undefined> {\n    // Find user by permanent QR code\n    const user = await this.getUserByPermanentQrCode(qrCode);\n    if (!user) {\n      return undefined;\n    }\n\n    // Check if user has an active check-in today\n    const existingCheckIn = await db\n      .select({\n        id: checkIns.id,\n        userId: checkIns.userId,\n        checkInTime: checkIns.checkInTime,\n        checkOutTime: checkIns.checkOutTime,\n        qrCode: checkIns.qrCode,\n        status: checkIns.status,\n        createdAt: checkIns.createdAt,\n      })\n      .from(checkIns)\n      .where(and(eq(checkIns.userId, user.id), eq(checkIns.status, \"active\")))\n      .limit(1);\n\n    let checkIn: CheckIn;\n    \n    if (existingCheckIn.length > 0) {\n      // User already has an active check-in\n      checkIn = existingCheckIn[0];\n    } else {\n      // Create new check-in\n      const { randomUUID } = await import('crypto');\n      const newCheckInQr = randomUUID();\n      const [newCheckIn] = await db\n        .insert(checkIns)\n        .values({\n          userId: user.id,\n          qrCode: newCheckInQr,\n          status: 'active',\n        })\n        .returning();\n      checkIn = newCheckIn;\n    }\n\n    // Get membership info\n    const membership = await this.getUserMembership(user.id);\n\n    return {\n      ...checkIn,\n      user,\n      membership,\n    };\n  }\n\n  async getRecentCheckIns(limit = 20): Promise<(CheckIn & { user: User; membership?: Membership & { plan: MembershipPlan } })[]> {\n    const result = await db\n      .select({\n        id: checkIns.id,\n        userId: checkIns.userId,\n        checkInTime: checkIns.checkInTime,\n        checkOutTime: checkIns.checkOutTime,\n        qrCode: checkIns.qrCode,\n        status: checkIns.status,\n        createdAt: checkIns.createdAt,\n        user: users,\n        membershipId: memberships.id,\n        membershipUserId: memberships.userId,\n        membershipPlanId: memberships.planId,\n        membershipStartDate: memberships.startDate,\n        membershipEndDate: memberships.endDate,\n        membershipStatus: memberships.status,\n        membershipAutoRenewal: memberships.autoRenewal,\n        membershipCreatedAt: memberships.createdAt,\n        planId: membershipPlans.id,\n        planName: membershipPlans.name,\n        planDescription: membershipPlans.description,\n        planPrice: membershipPlans.price,\n        planDurationMonths: membershipPlans.durationMonths,\n        planFeatures: membershipPlans.features,\n        planStripePriceId: membershipPlans.stripePriceId,\n        planActive: membershipPlans.active,\n        planCreatedAt: membershipPlans.createdAt,\n      })\n      .from(checkIns)\n      .innerJoin(users, eq(checkIns.userId, users.id))\n      .leftJoin(memberships, and(eq(users.id, memberships.userId), eq(memberships.status, \"active\")))\n      .leftJoin(membershipPlans, eq(memberships.planId, membershipPlans.id))\n      .orderBy(desc(checkIns.checkInTime))\n      .limit(limit);\n\n    return result.map(row => ({\n      id: row.id,\n      userId: row.userId,\n      checkInTime: row.checkInTime,\n      checkOutTime: row.checkOutTime,\n      qrCode: row.qrCode,\n      status: row.status,\n      createdAt: row.createdAt,\n      user: row.user,\n      membership: row.membershipId ? {\n        id: row.membershipId,\n        userId: row.membershipUserId!,\n        planId: row.membershipPlanId!,\n        startDate: row.membershipStartDate!,\n        endDate: row.membershipEndDate!,\n        status: row.membershipStatus!,\n        autoRenewal: row.membershipAutoRenewal!,\n        createdAt: row.membershipCreatedAt!,\n        plan: {\n          id: row.planId!,\n          name: row.planName!,\n          description: row.planDescription,\n          price: row.planPrice!,\n          durationMonths: row.planDurationMonths!,\n          features: row.planFeatures,\n          stripePriceId: row.planStripePriceId,\n          active: row.planActive!,\n          createdAt: row.planCreatedAt!,\n        }\n      } : undefined\n    }));\n  }\n\n  async autoCheckoutExpiredSessions(): Promise<number> {\n    const threeHoursAgo = new Date();\n    threeHoursAgo.setHours(threeHoursAgo.getHours() - 3);\n\n    const expiredCheckIns = await db\n      .select()\n      .from(checkIns)\n      .where(\n        and(\n          eq(checkIns.status, \"active\"),\n          lte(checkIns.checkInTime, threeHoursAgo)\n        )\n      );\n\n    if (expiredCheckIns.length === 0) {\n      return 0;\n    }\n\n    for (const checkIn of expiredCheckIns) {\n      await db\n        .update(checkIns)\n        .set({ \n          checkOutTime: new Date(), \n          status: \"completed\" \n        })\n        .where(eq(checkIns.id, checkIn.id));\n    }\n\n    console.log(`Auto-checkout: ${expiredCheckIns.length} member(s) checked out automatically after 3 hours`);\n    return expiredCheckIns.length;\n  }\n\n  // Payment operations\n  async getUserPayments(userId: string): Promise<Payment[]> {\n    return await db\n      .select()\n      .from(payments)\n      .where(eq(payments.userId, userId))\n      .orderBy(desc(payments.createdAt));\n  }\n\n  async createPayment(payment: InsertPayment): Promise<Payment> {\n    const [newPayment] = await db.insert(payments).values(payment).returning();\n    return newPayment;\n  }\n\n  async updatePaymentStatus(id: string, status: string): Promise<void> {\n    await db.update(payments).set({ status }).where(eq(payments.id, id));\n  }\n\n  async updatePaymentStatusByTransactionId(transactionId: string, status: string): Promise<void> {\n    await db.update(payments).set({ status }).where(eq(payments.stripePaymentIntentId, transactionId));\n  }\n\n  async getPaymentByOrderId(orderId: string): Promise<Payment | undefined> {\n    // For now, we'll use the description field to store order ID\n    // In production, you might want to add a separate orderId column\n    const [payment] = await db\n      .select()\n      .from(payments)\n      .where(eq(payments.description, orderId));\n    return payment;\n  }\n\n  // Admin operations\n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users);\n  }\n\n  async getUsersWithMemberships(): Promise<(User & { membership?: Membership & { plan: MembershipPlan } })[]> {\n    const result = await db\n      .select({\n        id: users.id,\n        username: users.username,\n        email: users.email,\n        firstName: users.firstName,\n        lastName: users.lastName,\n        phone: users.phone,\n        profileImageUrl: users.profileImageUrl,\n        role: users.role,\n        active: users.active,\n        stripeCustomerId: users.stripeCustomerId,\n        stripeSubscriptionId: users.stripeSubscriptionId,\n        createdAt: users.createdAt,\n        updatedAt: users.updatedAt,\n        membershipId: memberships.id,\n        membershipUserId: memberships.userId,\n        membershipPlanId: memberships.planId,\n        membershipStartDate: memberships.startDate,\n        membershipEndDate: memberships.endDate,\n        membershipStatus: memberships.status,\n        membershipAutoRenewal: memberships.autoRenewal,\n        membershipCreatedAt: memberships.createdAt,\n        planId: membershipPlans.id,\n        planName: membershipPlans.name,\n        planDescription: membershipPlans.description,\n        planPrice: membershipPlans.price,\n        planDurationMonths: membershipPlans.durationMonths,\n        planFeatures: membershipPlans.features,\n        planStripePriceId: membershipPlans.stripePriceId,\n        planActive: membershipPlans.active,\n        planCreatedAt: membershipPlans.createdAt,\n      })\n      .from(users)\n      .leftJoin(memberships, and(eq(users.id, memberships.userId), eq(memberships.status, \"active\")))\n      .leftJoin(membershipPlans, eq(memberships.planId, membershipPlans.id));\n\n    return result.map(row => ({\n      id: row.id,\n      username: row.username,\n      password: '', // Never expose password hashes\n      email: row.email,\n      firstName: row.firstName,\n      lastName: row.lastName,\n      phone: row.phone,\n      profileImageUrl: row.profileImageUrl,\n      permanentQrCode: null,\n      emailVerified: false,\n      verificationCode: null,\n      verificationCodeExpiry: null,\n      role: row.role,\n      active: row.active,\n      stripeCustomerId: row.stripeCustomerId,\n      stripeSubscriptionId: row.stripeSubscriptionId,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      membership: row.membershipId ? {\n        id: row.membershipId,\n        userId: row.membershipUserId!,\n        planId: row.membershipPlanId!,\n        startDate: row.membershipStartDate!,\n        endDate: row.membershipEndDate!,\n        status: row.membershipStatus!,\n        autoRenewal: row.membershipAutoRenewal!,\n        createdAt: row.membershipCreatedAt!,\n        plan: {\n          id: row.planId!,\n          name: row.planName!,\n          description: row.planDescription,\n          price: row.planPrice!,\n          durationMonths: row.planDurationMonths!,\n          features: row.planFeatures,\n          stripePriceId: row.planStripePriceId,\n          active: row.planActive!,\n          createdAt: row.planCreatedAt!,\n        }\n      } : undefined\n    }));\n  }\n\n  async getRevenueStats(): Promise<{ total: number; thisMonth: number; lastMonth: number }> {\n    const now = new Date();\n    const firstDayThisMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n    const firstDayLastMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const lastDayLastMonth = new Date(now.getFullYear(), now.getMonth(), 0);\n\n    const [totalResult] = await db\n      .select({ total: sum(payments.amount) })\n      .from(payments)\n      .where(eq(payments.status, \"completed\"));\n\n    const [thisMonthResult] = await db\n      .select({ total: sum(payments.amount) })\n      .from(payments)\n      .where(\n        and(\n          eq(payments.status, \"completed\"),\n          gte(payments.createdAt, firstDayThisMonth)\n        )\n      );\n\n    const [lastMonthResult] = await db\n      .select({ total: sum(payments.amount) })\n      .from(payments)\n      .where(\n        and(\n          eq(payments.status, \"completed\"),\n          gte(payments.createdAt, firstDayLastMonth),\n          lte(payments.createdAt, lastDayLastMonth)\n        )\n      );\n\n    return {\n      total: Number(totalResult?.total || 0),\n      thisMonth: Number(thisMonthResult?.total || 0),\n      lastMonth: Number(lastMonthResult?.total || 0),\n    };\n  }\n\n  async getMembershipStats(): Promise<{ total: number; active: number; expiringSoon: number }> {\n    const [totalResult] = await db.select({ count: count() }).from(memberships);\n    \n    const [activeResult] = await db\n      .select({ count: count() })\n      .from(memberships)\n      .where(eq(memberships.status, \"active\"));\n\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() + 20);\n\n    const [expiringSoonResult] = await db\n      .select({ count: count() })\n      .from(memberships)\n      .where(\n        and(\n          eq(memberships.status, \"active\"),\n          lte(memberships.endDate, cutoffDate)\n        )\n      );\n\n    return {\n      total: totalResult?.count || 0,\n      active: activeResult?.count || 0,\n      expiringSoon: expiringSoonResult?.count || 0,\n    };\n  }\n\n  // Feedback operations\n  async createFeedback(feedbackData: InsertFeedback): Promise<Feedback> {\n    const [feedback] = await db.insert(feedbacks).values(feedbackData).returning();\n    return feedback;\n  }\n\n  async getUserFeedbacks(userId: string): Promise<Feedback[]> {\n    return await db.select().from(feedbacks).where(eq(feedbacks.userId, userId)).orderBy(desc(feedbacks.createdAt));\n  }\n\n  async getAllFeedbacks(): Promise<(Feedback & { user: User })[]> {\n    const result = await db\n      .select({\n        id: feedbacks.id,\n        userId: feedbacks.userId,\n        subject: feedbacks.subject,\n        message: feedbacks.message,\n        rating: feedbacks.rating,\n        status: feedbacks.status,\n        adminResponse: feedbacks.adminResponse,\n        createdAt: feedbacks.createdAt,\n        updatedAt: feedbacks.updatedAt,\n        user: users,\n      })\n      .from(feedbacks)\n      .leftJoin(users, eq(feedbacks.userId, users.id))\n      .orderBy(desc(feedbacks.createdAt));\n\n    return result.map(row => ({\n      id: row.id,\n      userId: row.userId,\n      subject: row.subject,\n      message: row.message,\n      rating: row.rating,\n      status: row.status,\n      adminResponse: row.adminResponse,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      user: row.user!,\n    }));\n  }\n\n  async updateFeedbackStatus(id: string, status: string, adminResponse?: string): Promise<void> {\n    await db\n      .update(feedbacks)\n      .set({\n        status,\n        adminResponse,\n        updatedAt: new Date(),\n      })\n      .where(eq(feedbacks.id, id));\n  }\n\n  // Personal Trainer operations\n  async getAllTrainers(): Promise<PersonalTrainer[]> {\n    return await db.select().from(personalTrainers).orderBy(desc(personalTrainers.createdAt));\n  }\n\n  async getActiveTrainers(): Promise<PersonalTrainer[]> {\n    return await db.select().from(personalTrainers).where(eq(personalTrainers.active, true)).orderBy(desc(personalTrainers.createdAt));\n  }\n\n  async getTrainerById(id: string): Promise<PersonalTrainer | undefined> {\n    const [trainer] = await db.select().from(personalTrainers).where(eq(personalTrainers.id, id));\n    return trainer;\n  }\n\n  async createTrainer(trainerData: InsertPersonalTrainer): Promise<PersonalTrainer> {\n    const [trainer] = await db.insert(personalTrainers).values(trainerData).returning();\n    return trainer;\n  }\n\n  async updateTrainer(id: string, trainerData: Partial<InsertPersonalTrainer>): Promise<void> {\n    await db\n      .update(personalTrainers)\n      .set({\n        ...trainerData,\n        updatedAt: new Date(),\n      })\n      .where(eq(personalTrainers.id, id));\n  }\n\n  async deleteTrainer(id: string): Promise<void> {\n    await db.update(personalTrainers).set({ active: false, updatedAt: new Date() }).where(eq(personalTrainers.id, id));\n  }\n\n  // PT Booking operations\n  async getUserPtBookings(userId: string): Promise<(PtBooking & { trainer: PersonalTrainer })[]> {\n    const result = await db\n      .select({\n        id: ptBookings.id,\n        userId: ptBookings.userId,\n        trainerId: ptBookings.trainerId,\n        bookingDate: ptBookings.bookingDate,\n        duration: ptBookings.duration,\n        sessionCount: ptBookings.sessionCount,\n        status: ptBookings.status,\n        notes: ptBookings.notes,\n        createdAt: ptBookings.createdAt,\n        updatedAt: ptBookings.updatedAt,\n        trainer: personalTrainers,\n      })\n      .from(ptBookings)\n      .innerJoin(personalTrainers, eq(ptBookings.trainerId, personalTrainers.id))\n      .where(eq(ptBookings.userId, userId))\n      .orderBy(desc(ptBookings.bookingDate));\n\n    return result.map(row => ({\n      id: row.id,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      bookingDate: row.bookingDate,\n      duration: row.duration,\n      sessionCount: row.sessionCount,\n      status: row.status,\n      notes: row.notes,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      trainer: row.trainer,\n    }));\n  }\n\n  async getAllPtBookings(): Promise<(PtBooking & { user: User; trainer: PersonalTrainer })[]> {\n    const result = await db\n      .select({\n        id: ptBookings.id,\n        userId: ptBookings.userId,\n        trainerId: ptBookings.trainerId,\n        bookingDate: ptBookings.bookingDate,\n        duration: ptBookings.duration,\n        sessionCount: ptBookings.sessionCount,\n        status: ptBookings.status,\n        notes: ptBookings.notes,\n        createdAt: ptBookings.createdAt,\n        updatedAt: ptBookings.updatedAt,\n        user: users,\n        trainer: personalTrainers,\n      })\n      .from(ptBookings)\n      .innerJoin(users, eq(ptBookings.userId, users.id))\n      .innerJoin(personalTrainers, eq(ptBookings.trainerId, personalTrainers.id))\n      .orderBy(desc(ptBookings.bookingDate));\n\n    return result.map(row => ({\n      id: row.id,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      bookingDate: row.bookingDate,\n      duration: row.duration,\n      sessionCount: row.sessionCount,\n      status: row.status,\n      notes: row.notes,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      user: row.user,\n      trainer: row.trainer,\n    }));\n  }\n\n  async getPtBookingById(id: string): Promise<(PtBooking & { user: User; trainer: PersonalTrainer }) | undefined> {\n    const result = await db\n      .select({\n        id: ptBookings.id,\n        userId: ptBookings.userId,\n        trainerId: ptBookings.trainerId,\n        bookingDate: ptBookings.bookingDate,\n        duration: ptBookings.duration,\n        sessionCount: ptBookings.sessionCount,\n        status: ptBookings.status,\n        notes: ptBookings.notes,\n        createdAt: ptBookings.createdAt,\n        updatedAt: ptBookings.updatedAt,\n        user: users,\n        trainer: personalTrainers,\n      })\n      .from(ptBookings)\n      .innerJoin(users, eq(ptBookings.userId, users.id))\n      .innerJoin(personalTrainers, eq(ptBookings.trainerId, personalTrainers.id))\n      .where(eq(ptBookings.id, id))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n\n    const row = result[0];\n    return {\n      id: row.id,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      bookingDate: row.bookingDate,\n      duration: row.duration,\n      sessionCount: row.sessionCount,\n      status: row.status,\n      notes: row.notes,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      user: row.user,\n      trainer: row.trainer,\n    };\n  }\n\n  async createPtBooking(bookingData: InsertPtBooking): Promise<PtBooking> {\n    const [booking] = await db.insert(ptBookings).values(bookingData).returning();\n    return booking;\n  }\n\n  async updatePtBookingStatus(id: string, status: string): Promise<void> {\n    await db\n      .update(ptBookings)\n      .set({\n        status,\n        updatedAt: new Date(),\n      })\n      .where(eq(ptBookings.id, id));\n  }\n\n  async cancelPtBooking(id: string): Promise<void> {\n    await db\n      .update(ptBookings)\n      .set({\n        status: \"cancelled\",\n        updatedAt: new Date(),\n      })\n      .where(eq(ptBookings.id, id));\n  }\n\n  // PT Session Package operations\n  async createPtSessionPackage(packageData: InsertPtSessionPackage): Promise<PtSessionPackage> {\n    const [pkg] = await db.insert(ptSessionPackages).values(packageData).returning();\n    return pkg;\n  }\n\n  async getUserPtSessionPackages(userId: string): Promise<(PtSessionPackage & { trainer: PersonalTrainer })[]> {\n    const result = await db\n      .select({\n        id: ptSessionPackages.id,\n        userId: ptSessionPackages.userId,\n        trainerId: ptSessionPackages.trainerId,\n        totalSessions: ptSessionPackages.totalSessions,\n        usedSessions: ptSessionPackages.usedSessions,\n        remainingSessions: ptSessionPackages.remainingSessions,\n        pricePerSession: ptSessionPackages.pricePerSession,\n        totalPrice: ptSessionPackages.totalPrice,\n        status: ptSessionPackages.status,\n        purchaseDate: ptSessionPackages.purchaseDate,\n        expiryDate: ptSessionPackages.expiryDate,\n        createdAt: ptSessionPackages.createdAt,\n        updatedAt: ptSessionPackages.updatedAt,\n        trainer: personalTrainers,\n      })\n      .from(ptSessionPackages)\n      .innerJoin(personalTrainers, eq(ptSessionPackages.trainerId, personalTrainers.id))\n      .where(eq(ptSessionPackages.userId, userId))\n      .orderBy(desc(ptSessionPackages.createdAt));\n\n    return result.map(row => ({\n      id: row.id,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      totalSessions: row.totalSessions,\n      usedSessions: row.usedSessions,\n      remainingSessions: row.remainingSessions,\n      pricePerSession: row.pricePerSession,\n      totalPrice: row.totalPrice,\n      status: row.status,\n      purchaseDate: row.purchaseDate,\n      expiryDate: row.expiryDate,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      trainer: row.trainer,\n    }));\n  }\n\n  async getPtSessionPackageById(id: string): Promise<(PtSessionPackage & { trainer: PersonalTrainer; user: User }) | undefined> {\n    const result = await db\n      .select({\n        id: ptSessionPackages.id,\n        userId: ptSessionPackages.userId,\n        trainerId: ptSessionPackages.trainerId,\n        totalSessions: ptSessionPackages.totalSessions,\n        usedSessions: ptSessionPackages.usedSessions,\n        remainingSessions: ptSessionPackages.remainingSessions,\n        pricePerSession: ptSessionPackages.pricePerSession,\n        totalPrice: ptSessionPackages.totalPrice,\n        status: ptSessionPackages.status,\n        purchaseDate: ptSessionPackages.purchaseDate,\n        expiryDate: ptSessionPackages.expiryDate,\n        createdAt: ptSessionPackages.createdAt,\n        updatedAt: ptSessionPackages.updatedAt,\n        trainer: personalTrainers,\n        user: users,\n      })\n      .from(ptSessionPackages)\n      .innerJoin(personalTrainers, eq(ptSessionPackages.trainerId, personalTrainers.id))\n      .innerJoin(users, eq(ptSessionPackages.userId, users.id))\n      .where(eq(ptSessionPackages.id, id))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n\n    const row = result[0];\n    return {\n      id: row.id,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      totalSessions: row.totalSessions,\n      usedSessions: row.usedSessions,\n      remainingSessions: row.remainingSessions,\n      pricePerSession: row.pricePerSession,\n      totalPrice: row.totalPrice,\n      status: row.status,\n      purchaseDate: row.purchaseDate,\n      expiryDate: row.expiryDate,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      trainer: row.trainer,\n      user: row.user,\n    };\n  }\n\n  async updatePtSessionPackage(id: string, packageData: Partial<InsertPtSessionPackage>): Promise<void> {\n    await db\n      .update(ptSessionPackages)\n      .set({\n        ...packageData,\n        updatedAt: new Date(),\n      })\n      .where(eq(ptSessionPackages.id, id));\n  }\n\n  // PT Session Attendance operations\n  async createPtSessionAttendance(attendanceData: InsertPtSessionAttendance): Promise<PtSessionAttendance> {\n    const [attendance] = await db.insert(ptSessionAttendance).values(attendanceData).returning();\n    return attendance;\n  }\n\n  async getPackageAttendanceSessions(packageId: string): Promise<(PtSessionAttendance & { trainer: PersonalTrainer })[]> {\n    const result = await db\n      .select({\n        id: ptSessionAttendance.id,\n        packageId: ptSessionAttendance.packageId,\n        userId: ptSessionAttendance.userId,\n        trainerId: ptSessionAttendance.trainerId,\n        sessionDate: ptSessionAttendance.sessionDate,\n        sessionNumber: ptSessionAttendance.sessionNumber,\n        status: ptSessionAttendance.status,\n        checkInTime: ptSessionAttendance.checkInTime,\n        checkOutTime: ptSessionAttendance.checkOutTime,\n        notes: ptSessionAttendance.notes,\n        adminConfirmed: ptSessionAttendance.adminConfirmed,\n        confirmedBy: ptSessionAttendance.confirmedBy,\n        confirmedAt: ptSessionAttendance.confirmedAt,\n        createdAt: ptSessionAttendance.createdAt,\n        updatedAt: ptSessionAttendance.updatedAt,\n        trainer: personalTrainers,\n      })\n      .from(ptSessionAttendance)\n      .innerJoin(personalTrainers, eq(ptSessionAttendance.trainerId, personalTrainers.id))\n      .where(eq(ptSessionAttendance.packageId, packageId))\n      .orderBy(desc(ptSessionAttendance.sessionNumber));\n\n    return result.map(row => ({\n      id: row.id,\n      packageId: row.packageId,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      sessionDate: row.sessionDate,\n      sessionNumber: row.sessionNumber,\n      status: row.status,\n      checkInTime: row.checkInTime,\n      checkOutTime: row.checkOutTime,\n      notes: row.notes,\n      adminConfirmed: row.adminConfirmed,\n      confirmedBy: row.confirmedBy,\n      confirmedAt: row.confirmedAt,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      trainer: row.trainer,\n    }));\n  }\n\n  async getUserPtAttendanceSessions(userId: string): Promise<(PtSessionAttendance & { trainer: PersonalTrainer; package: PtSessionPackage })[]> {\n    const result = await db\n      .select({\n        id: ptSessionAttendance.id,\n        packageId: ptSessionAttendance.packageId,\n        userId: ptSessionAttendance.userId,\n        trainerId: ptSessionAttendance.trainerId,\n        sessionDate: ptSessionAttendance.sessionDate,\n        sessionNumber: ptSessionAttendance.sessionNumber,\n        status: ptSessionAttendance.status,\n        checkInTime: ptSessionAttendance.checkInTime,\n        checkOutTime: ptSessionAttendance.checkOutTime,\n        notes: ptSessionAttendance.notes,\n        adminConfirmed: ptSessionAttendance.adminConfirmed,\n        confirmedBy: ptSessionAttendance.confirmedBy,\n        confirmedAt: ptSessionAttendance.confirmedAt,\n        createdAt: ptSessionAttendance.createdAt,\n        updatedAt: ptSessionAttendance.updatedAt,\n        trainer: personalTrainers,\n        package: ptSessionPackages,\n      })\n      .from(ptSessionAttendance)\n      .innerJoin(personalTrainers, eq(ptSessionAttendance.trainerId, personalTrainers.id))\n      .innerJoin(ptSessionPackages, eq(ptSessionAttendance.packageId, ptSessionPackages.id))\n      .where(eq(ptSessionAttendance.userId, userId))\n      .orderBy(desc(ptSessionAttendance.sessionDate));\n\n    return result.map(row => ({\n      id: row.id,\n      packageId: row.packageId,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      sessionDate: row.sessionDate,\n      sessionNumber: row.sessionNumber,\n      status: row.status,\n      checkInTime: row.checkInTime,\n      checkOutTime: row.checkOutTime,\n      notes: row.notes,\n      adminConfirmed: row.adminConfirmed,\n      confirmedBy: row.confirmedBy,\n      confirmedAt: row.confirmedAt,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      trainer: row.trainer,\n      package: row.package,\n    }));\n  }\n\n  async getPtSessionAttendanceById(id: string): Promise<(PtSessionAttendance & { trainer: PersonalTrainer; user: User; package: PtSessionPackage }) | undefined> {\n    const result = await db\n      .select({\n        id: ptSessionAttendance.id,\n        packageId: ptSessionAttendance.packageId,\n        userId: ptSessionAttendance.userId,\n        trainerId: ptSessionAttendance.trainerId,\n        sessionDate: ptSessionAttendance.sessionDate,\n        sessionNumber: ptSessionAttendance.sessionNumber,\n        status: ptSessionAttendance.status,\n        checkInTime: ptSessionAttendance.checkInTime,\n        checkOutTime: ptSessionAttendance.checkOutTime,\n        notes: ptSessionAttendance.notes,\n        adminConfirmed: ptSessionAttendance.adminConfirmed,\n        confirmedBy: ptSessionAttendance.confirmedBy,\n        confirmedAt: ptSessionAttendance.confirmedAt,\n        createdAt: ptSessionAttendance.createdAt,\n        updatedAt: ptSessionAttendance.updatedAt,\n        trainer: personalTrainers,\n        user: users,\n        package: ptSessionPackages,\n      })\n      .from(ptSessionAttendance)\n      .innerJoin(personalTrainers, eq(ptSessionAttendance.trainerId, personalTrainers.id))\n      .innerJoin(users, eq(ptSessionAttendance.userId, users.id))\n      .innerJoin(ptSessionPackages, eq(ptSessionAttendance.packageId, ptSessionPackages.id))\n      .where(eq(ptSessionAttendance.id, id))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n\n    const row = result[0];\n    return {\n      id: row.id,\n      packageId: row.packageId,\n      userId: row.userId,\n      trainerId: row.trainerId,\n      sessionDate: row.sessionDate,\n      sessionNumber: row.sessionNumber,\n      status: row.status,\n      checkInTime: row.checkInTime,\n      checkOutTime: row.checkOutTime,\n      notes: row.notes,\n      adminConfirmed: row.adminConfirmed,\n      confirmedBy: row.confirmedBy,\n      confirmedAt: row.confirmedAt,\n      createdAt: row.createdAt,\n      updatedAt: row.updatedAt,\n      trainer: row.trainer,\n      user: row.user,\n      package: row.package,\n    };\n  }\n\n  async updatePtSessionAttendance(id: string, attendanceData: Partial<InsertPtSessionAttendance>): Promise<void> {\n    await db\n      .update(ptSessionAttendance)\n      .set({\n        ...attendanceData,\n        updatedAt: new Date(),\n      })\n      .where(eq(ptSessionAttendance.id, id));\n  }\n\n  async confirmPtSessionAttendance(id: string, adminId: string): Promise<void> {\n    await db\n      .update(ptSessionAttendance)\n      .set({\n        adminConfirmed: true,\n        confirmedBy: adminId,\n        confirmedAt: new Date(),\n        status: 'completed',\n        updatedAt: new Date(),\n      })\n      .where(eq(ptSessionAttendance.id, id));\n  }\n\n  // One-time QR code operations\n  async generateOneTimeQrCode(userId: string): Promise<OneTimeQrCode> {\n    const { randomUUID } = await import('crypto');\n    const qrCode = randomUUID();\n    const now = new Date();\n    const expiresAt = new Date(now.getTime() + 5 * 60 * 1000); // 5 minutes from now\n\n    const [newQrCode] = await db\n      .insert(oneTimeQrCodes)\n      .values({\n        userId,\n        qrCode,\n        expiresAt,\n        status: 'valid',\n      })\n      .returning();\n    \n    return newQrCode;\n  }\n\n  async validateOneTimeQrCode(qrCode: string): Promise<(OneTimeQrCode & { user: User; membership?: Membership & { plan: MembershipPlan } }) | undefined> {\n    const result = await db\n      .select({\n        id: oneTimeQrCodes.id,\n        userId: oneTimeQrCodes.userId,\n        qrCode: oneTimeQrCodes.qrCode,\n        expiresAt: oneTimeQrCodes.expiresAt,\n        usedAt: oneTimeQrCodes.usedAt,\n        status: oneTimeQrCodes.status,\n        createdAt: oneTimeQrCodes.createdAt,\n        user: users,\n        membershipId: memberships.id,\n        membershipUserId: memberships.userId,\n        membershipPlanId: memberships.planId,\n        membershipStartDate: memberships.startDate,\n        membershipEndDate: memberships.endDate,\n        membershipStatus: memberships.status,\n        membershipAutoRenewal: memberships.autoRenewal,\n        membershipCreatedAt: memberships.createdAt,\n        planId: membershipPlans.id,\n        planName: membershipPlans.name,\n        planDescription: membershipPlans.description,\n        planPrice: membershipPlans.price,\n        planDurationMonths: membershipPlans.durationMonths,\n        planFeatures: membershipPlans.features,\n        planStripePriceId: membershipPlans.stripePriceId,\n        planActive: membershipPlans.active,\n        planCreatedAt: membershipPlans.createdAt,\n      })\n      .from(oneTimeQrCodes)\n      .innerJoin(users, eq(oneTimeQrCodes.userId, users.id))\n      .leftJoin(memberships, and(eq(users.id, memberships.userId), eq(memberships.status, \"active\")))\n      .leftJoin(membershipPlans, eq(memberships.planId, membershipPlans.id))\n      .where(eq(oneTimeQrCodes.qrCode, qrCode))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n\n    const row = result[0];\n    return {\n      id: row.id,\n      userId: row.userId,\n      qrCode: row.qrCode,\n      expiresAt: row.expiresAt,\n      usedAt: row.usedAt,\n      status: row.status,\n      createdAt: row.createdAt,\n      user: row.user,\n      membership: row.membershipId ? {\n        id: row.membershipId,\n        userId: row.membershipUserId!,\n        planId: row.membershipPlanId!,\n        startDate: row.membershipStartDate!,\n        endDate: row.membershipEndDate!,\n        status: row.membershipStatus!,\n        autoRenewal: row.membershipAutoRenewal!,\n        createdAt: row.membershipCreatedAt!,\n        plan: {\n          id: row.planId!,\n          name: row.planName!,\n          description: row.planDescription,\n          price: row.planPrice!,\n          durationMonths: row.planDurationMonths!,\n          features: row.planFeatures,\n          stripePriceId: row.planStripePriceId,\n          active: row.planActive!,\n          createdAt: row.planCreatedAt!,\n        }\n      } : undefined\n    };\n  }\n\n  async markQrCodeAsUsed(qrCode: string): Promise<void> {\n    // Atomic update: only mark as used if status is still 'valid'\n    // This prevents race conditions where two concurrent requests try to use the same QR\n    const result = await db\n      .update(oneTimeQrCodes)\n      .set({\n        status: 'used',\n        usedAt: new Date(),\n      })\n      .where(and(\n        eq(oneTimeQrCodes.qrCode, qrCode),\n        eq(oneTimeQrCodes.status, 'valid')\n      ))\n      .returning();\n    \n    if (result.length === 0) {\n      // Check if QR code exists and what its status is\n      const existingQr = await db\n        .select()\n        .from(oneTimeQrCodes)\n        .where(eq(oneTimeQrCodes.qrCode, qrCode))\n        .limit(1);\n      \n      if (existingQr.length > 0) {\n        console.error(`QR code ${qrCode} has status: ${existingQr[0].status}`);\n      } else {\n        console.error(`QR code ${qrCode} not found in database`);\n      }\n      \n      throw new Error('QR code already used or invalid');\n    }\n  }\n\n  async cleanupExpiredQrCodes(): Promise<number> {\n    const now = new Date();\n    \n    // Mark expired QR codes\n    const result = await db\n      .update(oneTimeQrCodes)\n      .set({ status: 'expired' })\n      .where(and(\n        eq(oneTimeQrCodes.status, 'valid'),\n        lte(oneTimeQrCodes.expiresAt, now)\n      ))\n      .returning();\n    \n    return result.length;\n  }\n\n  // Password Reset operations\n  async createPasswordResetToken(email: string, token: string): Promise<PasswordResetToken> {\n    const now = new Date();\n    const expiresAt = new Date(now.getTime() + 15 * 60 * 1000); // 15 minutes from now\n\n    const [resetToken] = await db\n      .insert(passwordResetTokens)\n      .values({\n        email,\n        token,\n        expiresAt,\n        status: 'valid',\n      })\n      .returning();\n    \n    return resetToken;\n  }\n\n  async getPasswordResetToken(token: string): Promise<PasswordResetToken | undefined> {\n    const [resetToken] = await db\n      .select()\n      .from(passwordResetTokens)\n      .where(eq(passwordResetTokens.token, token))\n      .limit(1);\n    \n    return resetToken;\n  }\n\n  async markTokenAsUsed(token: string): Promise<void> {\n    await db\n      .update(passwordResetTokens)\n      .set({\n        status: 'used',\n        usedAt: new Date(),\n      })\n      .where(and(\n        eq(passwordResetTokens.token, token),\n        eq(passwordResetTokens.status, 'valid')\n      ));\n  }\n\n  async cleanupExpiredResetTokens(): Promise<number> {\n    const now = new Date();\n    \n    const result = await db\n      .update(passwordResetTokens)\n      .set({ status: 'expired' })\n      .where(and(\n        eq(passwordResetTokens.status, 'valid'),\n        lte(passwordResetTokens.expiresAt, now)\n      ))\n      .returning();\n    \n    return result.length;\n  }\n\n  async updateUserPassword(email: string, newPassword: string): Promise<void> {\n    await db\n      .update(users)\n      .set({ \n        password: newPassword,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.email, email));\n  }\n\n  async storeVerificationCode(email: string, code: string): Promise<void> {\n    const expiresAt = new Date(Date.now() + 15 * 60 * 1000); // 15 minutes from now\n    await db\n      .update(users)\n      .set({\n        verificationCode: code,\n        verificationCodeExpiry: expiresAt,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.email, email));\n  }\n\n  async verifyEmailCode(email: string, code: string): Promise<boolean> {\n    const [user] = await db\n      .select()\n      .from(users)\n      .where(eq(users.email, email))\n      .limit(1);\n\n    if (!user) return false;\n    if (!user.verificationCode) return false;\n    if (user.verificationCode !== code) return false;\n    if (!user.verificationCodeExpiry) return false;\n    if (new Date() > user.verificationCodeExpiry) return false;\n\n    // Mark email as verified and clear verification code\n    await db\n      .update(users)\n      .set({\n        emailVerified: true,\n        verificationCode: null,\n        verificationCodeExpiry: null,\n        updatedAt: new Date(),\n      })\n      .where(eq(users.email, email));\n\n    return true;\n  }\n\n  // Notification operations\n  async getUserNotifications(userId: string): Promise<Notification[]> {\n    const userNotifications = await db\n      .select()\n      .from(notifications)\n      .where(eq(notifications.userId, userId))\n      .orderBy(desc(notifications.createdAt));\n    \n    return userNotifications;\n  }\n\n  async createNotification(notification: InsertNotification): Promise<Notification> {\n    const [newNotification] = await db\n      .insert(notifications)\n      .values(notification)\n      .returning();\n    \n    return newNotification;\n  }\n\n  async markNotificationAsRead(id: string, userId: string): Promise<void> {\n    await db\n      .update(notifications)\n      .set({ isRead: true })\n      .where(and(\n        eq(notifications.id, id),\n        eq(notifications.userId, userId)\n      ));\n  }\n\n  async markAllNotificationsAsRead(userId: string): Promise<void> {\n    await db\n      .update(notifications)\n      .set({ isRead: true })\n      .where(and(\n        eq(notifications.userId, userId),\n        eq(notifications.isRead, false)\n      ));\n  }\n\n  async deleteNotification(id: string, userId: string): Promise<void> {\n    await db\n      .delete(notifications)\n      .where(and(\n        eq(notifications.id, id),\n        eq(notifications.userId, userId)\n      ));\n  }\n\n  // Push Subscription operations\n  async getUserPushSubscriptions(userId: string): Promise<PushSubscription[]> {\n    const subscriptions = await db\n      .select()\n      .from(pushSubscriptions)\n      .where(eq(pushSubscriptions.userId, userId));\n    \n    return subscriptions;\n  }\n\n  async createPushSubscription(subscription: InsertPushSubscription): Promise<PushSubscription> {\n    const [existing] = await db\n      .select()\n      .from(pushSubscriptions)\n      .where(eq(pushSubscriptions.endpoint, subscription.endpoint))\n      .limit(1);\n\n    if (existing) {\n      const [updated] = await db\n        .update(pushSubscriptions)\n        .set({\n          p256dh: subscription.p256dh,\n          auth: subscription.auth,\n          userAgent: subscription.userAgent,\n        })\n        .where(eq(pushSubscriptions.endpoint, subscription.endpoint))\n        .returning();\n      return updated;\n    }\n\n    const [newSubscription] = await db\n      .insert(pushSubscriptions)\n      .values(subscription)\n      .returning();\n    \n    return newSubscription;\n  }\n\n  async deletePushSubscription(endpoint: string, userId: string): Promise<void> {\n    await db\n      .delete(pushSubscriptions)\n      .where(and(\n        eq(pushSubscriptions.endpoint, endpoint),\n        eq(pushSubscriptions.userId, userId)\n      ));\n  }\n\n  async getAllPushSubscriptions(userId: string): Promise<PushSubscription[]> {\n    return this.getUserPushSubscriptions(userId);\n  }\n\n  // Inactive member operations\n  async getInactiveMembers(daysInactive: number): Promise<(User & { membership: Membership & { plan: MembershipPlan } })[]> {\n    const cutoffDate = new Date();\n    cutoffDate.setDate(cutoffDate.getDate() - daysInactive);\n\n    const usersWithMemberships = await db\n      .select({\n        user: users,\n        membership: memberships,\n        plan: membershipPlans,\n      })\n      .from(users)\n      .innerJoin(memberships, eq(users.id, memberships.userId))\n      .innerJoin(membershipPlans, eq(memberships.planId, membershipPlans.id))\n      .where(and(\n        eq(memberships.status, 'active'),\n        eq(users.active, true)\n      ));\n\n    const inactiveMembers: (User & { membership: Membership & { plan: MembershipPlan } })[] = [];\n\n    for (const item of usersWithMemberships) {\n      const [recentCheckIn] = await db\n        .select()\n        .from(checkIns)\n        .where(and(\n          eq(checkIns.userId, item.user.id),\n          gte(checkIns.checkInTime, cutoffDate)\n        ))\n        .limit(1);\n\n      if (!recentCheckIn) {\n        inactiveMembers.push({\n          ...item.user,\n          membership: {\n            ...item.membership,\n            plan: item.plan\n          }\n        });\n      }\n    }\n\n    return inactiveMembers;\n  }\n\n  async sendInactivityReminders(daysInactive: number): Promise<number> {\n    const inactiveMembers = await this.getInactiveMembers(daysInactive);\n    let reminderCount = 0;\n\n    for (const member of inactiveMembers) {\n      // Create in-app notification\n      await this.createNotification({\n        userId: member.id,\n        title: 'Reminder Gym ðŸ’ª',\n        message: 'Ayo nge-gym lagi! Jangan tunggu nanti â€” mulai hari ini! ðŸ’ª',\n        type: 'inactivity_reminder',\n        relatedId: member.membership.id,\n      });\n\n      // Send email reminder\n      try {\n        const memberName = member.firstName || member.username;\n        await sendInactivityReminderEmail(member.email, memberName, daysInactive);\n        console.log(`Inactivity reminder email sent to ${member.email}`);\n      } catch (error) {\n        console.error(`Failed to send email reminder to ${member.email}:`, error);\n        // Continue with other members even if one email fails\n      }\n\n      reminderCount++;\n    }\n\n    return reminderCount;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":64525},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/pages/checkout.tsx":{"content":"import { useStripe, Elements, PaymentElement, useElements } from '@stripe/react-stripe-js';\nimport { loadStripe } from '@stripe/stripe-js';\nimport { useEffect, useState } from 'react';\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\n// Stripe integration is optional - redirect to payment modal instead\nconst stripePromise = import.meta.env.VITE_STRIPE_PUBLIC_KEY ? \n  loadStripe(import.meta.env.VITE_STRIPE_PUBLIC_KEY) : null;\n\nconst CheckoutForm = () => {\n  const stripe = useStripe();\n  const elements = useElements();\n  const { toast } = useToast();\n  const [isProcessing, setIsProcessing] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!stripe || !elements) {\n      return;\n    }\n\n    setIsProcessing(true);\n\n    const { error } = await stripe.confirmPayment({\n      elements,\n      confirmParams: {\n        return_url: window.location.origin,\n      },\n    });\n\n    setIsProcessing(false);\n\n    if (error) {\n      toast({\n        title: \"Payment Failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    } else {\n      toast({\n        title: \"Payment Successful\",\n        description: \"Your membership has been activated!\",\n      });\n    }\n  }\n\n  return (\n    <Card className=\"w-full max-w-md mx-auto\">\n      <CardHeader>\n        <CardTitle>Complete Your Payment</CardTitle>\n      </CardHeader>\n      <CardContent>\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <PaymentElement />\n          <Button \n            type=\"submit\" \n            disabled={!stripe || isProcessing}\n            className=\"w-full gym-gradient text-white\"\n            data-testid=\"button-submit-payment\"\n          >\n            {isProcessing ? \"Processing...\" : \"Complete Payment\"}\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  );\n};\n\nexport default function Checkout() {\n  const [clientSecret, setClientSecret] = useState(\"\");\n  const { toast } = useToast();\n\n  useEffect(() => {\n    // This would be called with specific plan data\n    // For now, we'll use a default premium plan\n    apiRequest(\"POST\", \"/api/create-subscription\", { planId: \"premium\" })\n      .then((res) => res.json())\n      .then((data) => {\n        setClientSecret(data.clientSecret);\n      })\n      .catch((error) => {\n        toast({\n          title: \"Error\",\n          description: \"Failed to initialize payment\",\n          variant: \"destructive\",\n        });\n      });\n  }, [toast]);\n\n  if (!clientSecret) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" aria-label=\"Loading\"/>\n      </div>\n    );\n  }\n\n  // Make SURE to wrap the form in <Elements> which provides the stripe context.\n  return (\n    <div className=\"min-h-screen bg-muted/30 flex items-center justify-center p-4\">\n      <Elements stripe={stripePromise} options={{ clientSecret }}>\n        <CheckoutForm />\n      </Elements>\n    </div>\n  );\n}\n","size_bytes":3235},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport Stripe from \"stripe\";\nimport * as midtransClient from 'midtrans-client';\nimport passport from \"passport\";\nimport bcrypt from \"bcryptjs\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated, isAdmin } from \"./auth\";\nimport { insertMembershipPlanSchema, insertGymClassSchema, insertClassBookingSchema, insertCheckInSchema, insertPaymentSchema, registerSchema, loginSchema, forgotPasswordRequestSchema, resetPasswordSchema, verifyEmailSchema } from \"@shared/schema\";\nimport { sendPasswordResetEmail } from \"./email/resend\";\nimport { z } from \"zod\";\nimport { randomUUID } from \"crypto\";\nimport { sendNotificationWithPush } from \"./push\";\n\n// Temporary storage for email verification codes (before user creation)\nconst pendingVerifications = new Map<string, { code: string; expiresAt: Date }>();\n\n// Clean up expired verification codes every 5 minutes\nsetInterval(() => {\n  const now = new Date();\n  const entries = Array.from(pendingVerifications.entries());\n  for (const [email, data] of entries) {\n    if (now > data.expiresAt) {\n      pendingVerifications.delete(email);\n    }\n  }\n}, 5 * 60 * 1000);\n\n// Make Stripe optional - can be added later\nlet stripe: Stripe | null = null;\nif (process.env.STRIPE_SECRET_KEY) {\n  stripe = new Stripe(process.env.STRIPE_SECRET_KEY, {\n    apiVersion: \"2025-08-27.basil\",\n  });\n}\n\n// Indonesian Payment Gateway - Midtrans\nlet midtransCore: any = null;\nlet midtransSnap: any = null;\n\nif (process.env.MIDTRANS_SERVER_KEY) {\n  const isProduction = process.env.MIDTRANS_ENVIRONMENT === 'production';\n  \n  midtransCore = new midtransClient.CoreApi({\n    isProduction,\n    serverKey: process.env.MIDTRANS_SERVER_KEY,\n    clientKey: process.env.MIDTRANS_CLIENT_KEY || '',\n  });\n  \n  midtransSnap = new midtransClient.Snap({\n    isProduction,\n    serverKey: process.env.MIDTRANS_SERVER_KEY,\n    clientKey: process.env.MIDTRANS_CLIENT_KEY || '',\n  });\n}\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Auth middleware\n  await setupAuth(app);\n\n  // Register route\n  app.post('/api/register', async (req, res) => {\n    try {\n      const validatedData = registerSchema.parse(req.body);\n      \n      // Check if username or email already exists\n      const existingUser = await storage.getUserByUsername(validatedData.username);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Username sudah digunakan\" });\n      }\n\n      const existingEmail = await storage.getUserByEmail(validatedData.email);\n      if (existingEmail) {\n        return res.status(400).json({ message: \"Email sudah digunakan\" });\n      }\n\n      // Hash password\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n\n      // Create user (not verified yet)\n      const user = await storage.createUser({\n        username: validatedData.username,\n        email: validatedData.email,\n        firstName: validatedData.firstName,\n        lastName: validatedData.lastName,\n        phone: validatedData.phone ? `+62${validatedData.phone}` : undefined,\n        password: hashedPassword,\n        role: 'member',\n      });\n\n      // Generate 6-digit verification code\n      const verificationCode = Math.floor(100000 + Math.random() * 900000).toString();\n      \n      // Store verification code\n      await storage.storeVerificationCode(user.email, verificationCode);\n      \n      // Send verification email\n      const { sendVerificationEmail } = await import('./email/resend');\n      await sendVerificationEmail(user.email, verificationCode);\n\n      res.json({ \n        message: \"Registrasi berhasil! Silakan cek email Anda untuk kode verifikasi.\",\n        email: user.email,\n        requireVerification: true\n      });\n    } catch (error: any) {\n      console.error(\"Error during registration:\", error);\n      res.status(400).json({ message: error.message || \"Registration failed\" });\n    }\n  });\n\n  // Admin registration route (special endpoint with secret key)\n  app.post('/api/register-admin', async (req, res) => {\n    try {\n      const { adminSecretKey, ...userData } = req.body;\n      \n      console.log(\"Admin registration attempt:\", { username: userData.username, email: userData.email });\n      \n      // Check for admin secret key (you can set this in environment variables)\n      // For now, we'll allow if the key is \"admin123\" or if ADMIN_SECRET_KEY env var matches\n      const validSecretKey = process.env.ADMIN_SECRET_KEY || \"admin123\";\n      \n      if (adminSecretKey !== validSecretKey) {\n        console.log(\"Invalid admin secret key provided\");\n        return res.status(403).json({ message: \"Invalid admin secret key\" });\n      }\n      \n      // Validate data\n      const validatedData = registerSchema.parse(userData);\n      console.log(\"Data validated successfully\");\n      \n      // Check if username already exists\n      const existingUsername = await storage.getUserByUsername(validatedData.username);\n      if (existingUsername) {\n        console.log(\"Username already exists:\", validatedData.username);\n        return res.status(400).json({ message: \"Username sudah digunakan\" });\n      }\n\n      // Check if email already exists\n      const existingEmail = await storage.getUserByEmail(validatedData.email);\n      if (existingEmail) {\n        console.log(\"Email already exists:\", validatedData.email);\n        return res.status(400).json({ message: \"Email sudah digunakan\" });\n      }\n\n      // Hash password\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n      console.log(\"Password hashed successfully\");\n\n      // Create admin user\n      const user = await storage.createUser({\n        username: validatedData.username,\n        email: validatedData.email,\n        firstName: validatedData.firstName,\n        lastName: validatedData.lastName,\n        phone: validatedData.phone ? `+62${validatedData.phone}` : undefined,\n        password: hashedPassword,\n        role: 'admin', // Set role to admin\n      });\n\n      console.log(\"Admin user created successfully:\", user.id);\n\n      // Log user in\n      req.login(user, (err) => {\n        if (err) {\n          console.error(\"Failed to login after admin registration:\", err);\n          return res.status(500).json({ message: \"Failed to login after registration\" });\n        }\n        console.log(\"Admin logged in successfully\");\n        res.json({ message: \"Admin registration successful\", user: { ...user, password: undefined } });\n      });\n    } catch (error: any) {\n      console.error(\"Error during admin registration:\", error);\n      res.status(400).json({ message: error.message || \"Admin registration failed\" });\n    }\n  });\n\n  // Email verification route\n  app.post('/api/verify-email', async (req, res) => {\n    try {\n      const validatedData = verifyEmailSchema.parse(req.body);\n      \n      const verified = await storage.verifyEmailCode(validatedData.email, validatedData.verificationCode);\n      \n      if (!verified) {\n        return res.status(400).json({ message: \"Kode verifikasi tidak valid atau sudah kadaluarsa\" });\n      }\n\n      // Get the verified user\n      const user = await storage.getUserByEmail(validatedData.email);\n      if (!user) {\n        return res.status(404).json({ message: \"User tidak ditemukan\" });\n      }\n\n      // Log user in after verification\n      req.login(user, (err) => {\n        if (err) {\n          return res.status(500).json({ message: \"Failed to login after verification\" });\n        }\n        res.json({ \n          message: \"Email berhasil diverifikasi! Selamat datang di Idachi Fitness!\",\n          user: { ...user, password: undefined }\n        });\n      });\n    } catch (error: any) {\n      console.error(\"Error during email verification:\", error);\n      res.status(400).json({ message: error.message || \"Verifikasi email gagal\" });\n    }\n  });\n\n  // Send verification code (new flow - before registration)\n  app.post('/api/send-verification-code', async (req, res) => {\n    try {\n      const { email } = req.body;\n      \n      if (!email) {\n        return res.status(400).json({ message: \"Email diperlukan\" });\n      }\n\n      // Check if email already exists\n      const existingUser = await storage.getUserByEmail(email);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Email sudah terdaftar\" });\n      }\n\n      // Generate 6-digit verification code\n      const verificationCode = Math.floor(100000 + Math.random() * 900000).toString();\n      const expiresAt = new Date(Date.now() + 15 * 60 * 1000); // 15 minutes\n      \n      // Store in pending verifications\n      pendingVerifications.set(email, { code: verificationCode, expiresAt });\n      \n      // Send verification email\n      const { sendVerificationEmail } = await import('./email/resend');\n      await sendVerificationEmail(email, verificationCode);\n\n      res.json({ \n        message: \"Kode verifikasi telah dikirim ke email Anda\",\n        success: true\n      });\n    } catch (error: any) {\n      console.error(\"Error during send verification:\", error);\n      res.status(500).json({ message: error.message || \"Gagal mengirim kode verifikasi\" });\n    }\n  });\n\n  // Check verification code (without logging in)\n  app.post('/api/check-verification-code', async (req, res) => {\n    try {\n      const { email, verificationCode } = req.body;\n      \n      if (!email || !verificationCode) {\n        return res.status(400).json({ message: \"Email dan kode verifikasi diperlukan\" });\n      }\n\n      const pending = pendingVerifications.get(email);\n      \n      if (!pending) {\n        return res.status(400).json({ message: \"Kode verifikasi tidak ditemukan. Silakan kirim ulang kode.\" });\n      }\n\n      if (new Date() > pending.expiresAt) {\n        pendingVerifications.delete(email);\n        return res.status(400).json({ message: \"Kode verifikasi sudah kadaluarsa. Silakan kirim ulang kode.\" });\n      }\n\n      if (pending.code !== verificationCode) {\n        return res.status(400).json({ message: \"Kode verifikasi tidak valid\" });\n      }\n\n      // Mark as verified by keeping it but adding verified flag\n      pendingVerifications.set(email, { ...pending, verified: true } as any);\n\n      res.json({ \n        message: \"Email berhasil diverifikasi!\",\n        verified: true\n      });\n    } catch (error: any) {\n      console.error(\"Error during check verification:\", error);\n      res.status(400).json({ message: error.message || \"Verifikasi gagal\" });\n    }\n  });\n\n  // Register with verified email (new flow)\n  app.post('/api/register-verified', async (req, res) => {\n    try {\n      const validatedData = registerSchema.parse(req.body);\n      \n      // Check if email was verified\n      const pending = pendingVerifications.get(validatedData.email);\n      if (!pending || !(pending as any).verified) {\n        return res.status(400).json({ message: \"Email belum diverifikasi. Silakan verifikasi email terlebih dahulu.\" });\n      }\n\n      // Check if verification is still valid\n      if (new Date() > pending.expiresAt) {\n        pendingVerifications.delete(validatedData.email);\n        return res.status(400).json({ message: \"Verifikasi email sudah kadaluarsa. Silakan verifikasi ulang.\" });\n      }\n      \n      // Check if username already exists\n      const existingUser = await storage.getUserByUsername(validatedData.username);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Username sudah digunakan\" });\n      }\n\n      const existingEmail = await storage.getUserByEmail(validatedData.email);\n      if (existingEmail) {\n        return res.status(400).json({ message: \"Email sudah digunakan\" });\n      }\n\n      // Hash password\n      const hashedPassword = await bcrypt.hash(validatedData.password, 10);\n\n      // Create user with emailVerified = true and selfie as profile image\n      const user = await storage.createUser({\n        username: validatedData.username,\n        email: validatedData.email,\n        firstName: validatedData.firstName,\n        lastName: validatedData.lastName,\n        phone: validatedData.phone ? `+62${validatedData.phone}` : undefined,\n        password: hashedPassword,\n        role: 'member',\n        emailVerified: true,\n        profileImageUrl: validatedData.selfieImage, // Save selfie as profile image\n      });\n\n      // Clear the pending verification\n      pendingVerifications.delete(validatedData.email);\n\n      // Log user in\n      req.login(user, (err) => {\n        if (err) {\n          return res.status(500).json({ message: \"Failed to login after registration\" });\n        }\n        res.json({ \n          message: \"Registrasi berhasil! Selamat datang di Idachi Fitness!\",\n          user: { ...user, password: undefined }\n        });\n      });\n    } catch (error: any) {\n      console.error(\"Error during registration:\", error);\n      res.status(400).json({ message: error.message || \"Registration failed\" });\n    }\n  });\n\n  // Resend verification code route\n  app.post('/api/resend-verification-code', async (req, res) => {\n    try {\n      const { email } = req.body;\n      \n      if (!email) {\n        return res.status(400).json({ message: \"Email diperlukan\" });\n      }\n\n      // Check if user exists\n      const user = await storage.getUserByEmail(email);\n      if (!user) {\n        return res.status(404).json({ message: \"User tidak ditemukan\" });\n      }\n\n      // Check if user is already verified\n      if (user.emailVerified) {\n        return res.status(400).json({ message: \"Email sudah diverifikasi\" });\n      }\n\n      // Generate new 6-digit verification code\n      const verificationCode = Math.floor(100000 + Math.random() * 900000).toString();\n      \n      // Store new verification code\n      await storage.storeVerificationCode(email, verificationCode);\n      \n      // Send verification email\n      const { sendVerificationEmail } = await import('./email/resend');\n      await sendVerificationEmail(email, verificationCode);\n\n      res.json({ \n        message: \"Kode verifikasi baru telah dikirim ke email Anda\",\n        success: true\n      });\n    } catch (error: any) {\n      console.error(\"Error during resend verification:\", error);\n      res.status(500).json({ message: error.message || \"Gagal mengirim ulang kode verifikasi\" });\n    }\n  });\n\n  // Login route\n  app.post('/api/login', (req, res, next) => {\n    const { rememberMe } = req.body;\n    \n    passport.authenticate('local', (err: any, user: any, info: any) => {\n      if (err) {\n        return res.status(500).json({ message: \"Login error\" });\n      }\n      if (!user) {\n        return res.status(401).json({ message: info?.message || \"Login failed\" });\n      }\n      req.login(user, (err) => {\n        if (err) {\n          return res.status(500).json({ message: \"Login error\" });\n        }\n        \n        // Extend session if remember me is checked\n        if (rememberMe && req.session.cookie) {\n          // Set cookie to expire in 30 days instead of default session lifetime\n          req.session.cookie.maxAge = 30 * 24 * 60 * 60 * 1000; // 30 days in milliseconds\n        }\n        \n        res.json({ message: \"Login successful\", user: { ...user, password: undefined } });\n      });\n    })(req, res, next);\n  });\n\n  // Logout route\n  app.post('/api/logout', (req, res) => {\n    req.logout((err) => {\n      if (err) {\n        return res.status(500).json({ message: \"Logout failed\" });\n      }\n      res.json({ message: \"Logout successful\" });\n    });\n  });\n\n  // Forgot Password route\n  app.post('/api/forgot-password', async (req, res) => {\n    try {\n      const validatedData = forgotPasswordRequestSchema.parse(req.body);\n      \n      // Check if user exists\n      const user = await storage.getUserByEmail(validatedData.email);\n      if (!user) {\n        // Don't reveal if email exists or not for security\n        return res.json({ message: \"Jika email terdaftar, kode verifikasi telah dikirim\" });\n      }\n\n      // Generate 6-digit verification code\n      const resetToken = Math.floor(100000 + Math.random() * 900000).toString();\n      \n      // Store token in database\n      await storage.createPasswordResetToken(validatedData.email, resetToken);\n      \n      // Send email\n      const emailResult = await sendPasswordResetEmail(validatedData.email, resetToken);\n      \n      // Check if email was sent successfully\n      if (emailResult?.error) {\n        console.error('[Forgot Password] Email sending failed:', emailResult.error);\n        return res.status(500).json({ \n          message: \"Terjadi kesalahan saat mengirim email. Silakan hubungi administrator.\",\n          details: emailResult.error.message \n        });\n      }\n      \n      res.json({ message: \"Kode verifikasi telah dikirim ke email Anda\" });\n    } catch (error: any) {\n      console.error(\"Error in forgot password:\", error);\n      res.status(400).json({ message: error.message || \"Gagal mengirim kode verifikasi\" });\n    }\n  });\n\n  // Reset Password route\n  app.post('/api/reset-password', async (req, res) => {\n    try {\n      const validatedData = resetPasswordSchema.parse(req.body);\n      \n      // Validate token\n      const resetToken = await storage.getPasswordResetToken(validatedData.token);\n      \n      if (!resetToken) {\n        return res.status(400).json({ message: \"Kode verifikasi tidak valid\" });\n      }\n      \n      if (resetToken.status !== 'valid') {\n        return res.status(400).json({ message: \"Kode verifikasi sudah digunakan atau kadaluarsa\" });\n      }\n      \n      if (new Date() > resetToken.expiresAt) {\n        await storage.markTokenAsUsed(validatedData.token);\n        return res.status(400).json({ message: \"Kode verifikasi sudah kadaluarsa\" });\n      }\n      \n      // Hash new password\n      const hashedPassword = await bcrypt.hash(validatedData.newPassword, 10);\n      \n      // Update password\n      await storage.updateUserPassword(resetToken.email, hashedPassword);\n      \n      // Mark token as used\n      await storage.markTokenAsUsed(validatedData.token);\n      \n      res.json({ message: \"Password berhasil direset. Silakan login dengan password baru Anda\" });\n    } catch (error: any) {\n      console.error(\"Error in reset password:\", error);\n      res.status(400).json({ message: error.message || \"Gagal mereset password\" });\n    }\n  });\n\n  // Notification routes\n  app.get('/api/notifications', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const notifications = await storage.getUserNotifications(userId);\n      res.json(notifications);\n    } catch (error: any) {\n      console.error(\"Error fetching notifications:\", error);\n      res.status(500).json({ message: error.message || \"Gagal mengambil notifikasi\" });\n    }\n  });\n\n  app.put('/api/notifications/:id/read', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const userId = req.user.id;\n      await storage.markNotificationAsRead(id, userId);\n      res.json({ message: \"Notifikasi ditandai sebagai dibaca\" });\n    } catch (error: any) {\n      console.error(\"Error marking notification as read:\", error);\n      res.status(500).json({ message: error.message || \"Gagal menandai notifikasi\" });\n    }\n  });\n\n  app.put('/api/notifications/read-all', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      await storage.markAllNotificationsAsRead(userId);\n      res.json({ message: \"Semua notifikasi ditandai sebagai dibaca\" });\n    } catch (error: any) {\n      console.error(\"Error marking all notifications as read:\", error);\n      res.status(500).json({ message: error.message || \"Gagal menandai semua notifikasi\" });\n    }\n  });\n\n  app.delete('/api/notifications/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const userId = req.user.id;\n      await storage.deleteNotification(id, userId);\n      res.json({ message: \"Notifikasi berhasil dihapus\" });\n    } catch (error: any) {\n      console.error(\"Error deleting notification:\", error);\n      res.status(500).json({ message: error.message || \"Gagal menghapus notifikasi\" });\n    }\n  });\n\n  // Push Subscription routes\n  app.post('/api/push/subscribe', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { endpoint, keys } = req.body;\n      \n      if (!endpoint || !keys?.p256dh || !keys?.auth) {\n        return res.status(400).json({ message: \"Invalid subscription data\" });\n      }\n\n      const subscription = await storage.createPushSubscription({\n        userId,\n        endpoint,\n        p256dh: keys.p256dh,\n        auth: keys.auth,\n        userAgent: req.headers['user-agent'],\n      });\n\n      res.json({ message: \"Subscription berhasil disimpan\", subscription });\n    } catch (error: any) {\n      console.error(\"Error saving push subscription:\", error);\n      res.status(500).json({ message: error.message || \"Gagal menyimpan subscription\" });\n    }\n  });\n\n  app.delete('/api/push/unsubscribe', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { endpoint } = req.body;\n      \n      if (!endpoint) {\n        return res.status(400).json({ message: \"Endpoint required\" });\n      }\n\n      await storage.deletePushSubscription(endpoint, userId);\n      res.json({ message: \"Subscription berhasil dihapus\" });\n    } catch (error: any) {\n      console.error(\"Error deleting push subscription:\", error);\n      res.status(500).json({ message: error.message || \"Gagal menghapus subscription\" });\n    }\n  });\n\n  app.get('/api/push/public-key', async (_req, res) => {\n    const publicKey = process.env.VAPID_PUBLIC_KEY;\n    if (!publicKey) {\n      return res.status(500).json({ message: \"VAPID keys not configured\" });\n    }\n    res.json({ publicKey });\n  });\n\n  // Auth routes\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      res.json({ ...req.user, password: undefined });\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  // Member routes\n  app.get('/api/member/dashboard', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      \n      const [membership, checkIns, classBookings, payments, crowdCount] = await Promise.all([\n        storage.getUserMembership(userId),\n        storage.getUserCheckIns(userId, 10),\n        storage.getUserClassBookings(userId),\n        storage.getUserPayments(userId),\n        storage.getCurrentCrowdCount(),\n      ]);\n\n      // Calculate stats\n      const now = new Date();\n      const thisMonth = new Date(now.getFullYear(), now.getMonth(), 1);\n      const monthlyCheckIns = checkIns.filter(checkIn => checkIn.checkInTime && checkIn.checkInTime >= thisMonth).length;\n      \n      const upcomingClasses = classBookings.filter(booking => \n        booking.status === 'booked' && booking.bookingDate > now\n      );\n\n      res.json({\n        membership,\n        checkIns,\n        classBookings: upcomingClasses,\n        payments: payments.slice(0, 5), // Recent payments\n        stats: {\n          monthlyCheckIns,\n          upcomingClasses: upcomingClasses.length,\n          currentCrowd: crowdCount,\n        }\n      });\n    } catch (error) {\n      console.error(\"Error fetching dashboard data:\", error);\n      res.status(500).json({ message: \"Failed to fetch dashboard data\" });\n    }\n  });\n\n  // Check-in routes\n  app.post('/api/checkin/generate', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      \n      // Check if user is suspended\n      const user = await storage.getUser(userId);\n      if (user?.active === false) {\n        return res.status(403).json({ \n          message: \"Akun Anda sedang dinonaktifkan. Silakan hubungi admin untuk informasi lebih lanjut.\" \n        });\n      }\n      \n      // Generate one-time QR code with 5 minutes expiry\n      const oneTimeQr = await storage.generateOneTimeQrCode(userId);\n      \n      // Get membership info\n      const membership = await storage.getUserMembership(userId);\n      \n      // Check if membership is active\n      const hasActiveMembership = !!(membership && new Date(membership.endDate) > new Date());\n\n      res.json({ \n        qrCode: oneTimeQr.qrCode,\n        expiresAt: oneTimeQr.expiresAt,\n        membership,\n        hasActiveMembership \n      });\n    } catch (error) {\n      console.error(\"Error generating QR code:\", error);\n      res.status(500).json({ message: \"Failed to generate QR code\" });\n    }\n  });\n\n  app.post('/api/checkin/:id/checkout', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      await storage.updateCheckOut(id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Error checking out:\", error);\n      res.status(500).json({ message: \"Failed to check out\" });\n    }\n  });\n\n  // Check QR code status (for polling)\n  app.get('/api/checkin/status/:qrCode', async (req, res) => {\n    try {\n      const { qrCode } = req.params;\n      \n      if (!qrCode) {\n        return res.status(400).json({ success: false, message: 'QR code is required' });\n      }\n\n      // Check one-time QR code status\n      const qrData = await storage.validateOneTimeQrCode(qrCode);\n      \n      if (!qrData) {\n        return res.json({ success: false, status: 'invalid', message: 'QR code tidak ditemukan' });\n      }\n\n      // If QR code is used, find the check-in record\n      if (qrData.status === 'used') {\n        // Find the most recent check-in for this user\n        const checkIns = await storage.getUserCheckIns(qrData.userId);\n        const latestCheckIn = checkIns && checkIns.length > 0 ? checkIns[0] : null;\n        \n        return res.json({\n          success: true,\n          status: 'used',\n          checkIn: latestCheckIn,\n          user: {\n            firstName: qrData.user.firstName,\n            lastName: qrData.user.lastName\n          }\n        });\n      }\n\n      // QR code is still valid\n      return res.json({\n        success: true,\n        status: qrData.status,\n        expiresAt: qrData.expiresAt\n      });\n    } catch (error) {\n      console.error(\"Error checking QR code status:\", error);\n      res.status(500).json({ success: false, message: \"Failed to check QR code status\" });\n    }\n  });\n\n  // Public check-in verification endpoint (no auth required) - One-time QR\n  app.post('/api/checkin/verify', async (req, res) => {\n    try {\n      const { qrCode } = req.body;\n      \n      if (!qrCode) {\n        return res.status(400).json({ \n          success: false,\n          message: 'Kode QR tidak valid' \n        });\n      }\n\n      // Validate one-time QR code\n      const qrData = await storage.validateOneTimeQrCode(qrCode);\n      \n      if (!qrData) {\n        return res.status(404).json({ \n          success: false,\n          message: 'QR code tidak valid atau tidak ditemukan' \n        });\n      }\n\n      // Check if QR code is already used\n      if (qrData.status === 'used') {\n        return res.json({\n          success: false,\n          message: 'QR code sudah pernah digunakan'\n        });\n      }\n\n      // Check if QR code is expired\n      const now = new Date();\n      if (qrData.status === 'expired' || qrData.expiresAt < now) {\n        return res.json({\n          success: false,\n          message: 'QR code sudah kadaluarsa. Silakan generate QR baru'\n        });\n      }\n\n      const memberUser = qrData.user;\n\n      // Sanitize user data - only return safe fields for display\n      const safeUserData = {\n        firstName: memberUser.firstName,\n        lastName: memberUser.lastName\n      };\n\n      // Check if user is suspended\n      if (memberUser.active === false) {\n        return res.json({\n          success: false,\n          user: safeUserData,\n          message: 'Akun Anda sedang dinonaktifkan. Silakan hubungi admin untuk informasi lebih lanjut.'\n        });\n      }\n\n      // Check membership status\n      const hasActiveMembership = qrData.membership && new Date(qrData.membership.endDate) > now;\n\n      // If no active membership, return failure response with member info\n      if (!hasActiveMembership) {\n        return res.json({\n          success: false,\n          user: safeUserData,\n          message: 'Belum terdaftar membership atau membership sudah expired'\n        });\n      }\n\n      // Mark QR code as used (atomic operation to prevent race conditions)\n      try {\n        await storage.markQrCodeAsUsed(qrCode);\n      } catch (error) {\n        // QR already used by another concurrent request\n        return res.json({\n          success: false,\n          message: 'QR code sudah pernah digunakan'\n        });\n      }\n\n      // Create check-in\n      const { randomUUID } = await import('crypto');\n      const checkInQr = randomUUID();\n      const checkIn = await storage.createCheckIn({\n        userId: memberUser.id,\n        qrCode: checkInQr,\n        status: 'active',\n      });\n\n      // Sanitize check-in data before returning\n      res.json({\n        success: true,\n        user: safeUserData,\n        checkIn: {\n          id: checkIn.id,\n          checkInTime: checkIn.checkInTime\n        }\n      });\n    } catch (error) {\n      console.error(\"Error verifying check-in:\", error);\n      res.status(500).json({ \n        success: false,\n        message: \"Terjadi kesalahan saat check-in\" \n      });\n    }\n  });\n\n  // Class routes\n  app.get('/api/classes', isAuthenticated, async (req, res) => {\n    try {\n      const classes = await storage.getGymClasses();\n      res.json(classes);\n    } catch (error) {\n      console.error(\"Error fetching classes:\", error);\n      res.status(500).json({ message: \"Failed to fetch classes\" });\n    }\n  });\n\n  app.post('/api/classes/:classId/book', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { classId } = req.params;\n      const { bookingDate } = req.body;\n\n      const booking = await storage.bookClass({\n        userId,\n        classId,\n        bookingDate: new Date(bookingDate),\n        status: 'booked',\n      });\n\n      res.json(booking);\n    } catch (error) {\n      console.error(\"Error booking class:\", error);\n      res.status(500).json({ message: \"Failed to book class\" });\n    }\n  });\n\n  app.get('/api/class-bookings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const bookings = await storage.getUserClassBookings(userId);\n      res.json(bookings);\n    } catch (error) {\n      console.error(\"Error fetching class bookings:\", error);\n      res.status(500).json({ message: \"Failed to fetch class bookings\" });\n    }\n  });\n\n  app.put('/api/class-bookings/:id/cancel', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { id } = req.params;\n      \n      const userBookings = await storage.getUserClassBookings(userId);\n      const booking = userBookings.find(b => b.id === id);\n      \n      if (!booking) {\n        return res.status(404).json({ message: 'Booking not found or unauthorized' });\n      }\n      \n      if (booking.status === 'cancelled') {\n        return res.status(400).json({ message: 'Booking already cancelled' });\n      }\n      \n      await storage.cancelClassBooking(id);\n      res.json({ message: 'Class booking cancelled successfully' });\n    } catch (error) {\n      console.error(\"Error cancelling class booking:\", error);\n      res.status(500).json({ message: \"Failed to cancel class booking\" });\n    }\n  });\n\n  // Payment routes\n  app.get('/api/membership-plans', async (req, res) => {\n    try {\n      const plans = await storage.getMembershipPlans();\n      res.json(plans);\n    } catch (error) {\n      console.error(\"Error fetching membership plans:\", error);\n      res.status(500).json({ message: \"Failed to fetch membership plans\" });\n    }\n  });\n\n  app.post('/api/create-subscription', isAuthenticated, async (req: any, res) => {\n    try {\n      if (!stripe) {\n        return res.status(501).json({ \n          message: 'Payment gateway not configured. Please contact administrator.' \n        });\n      }\n\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      const { planId } = req.body;\n\n      if (!user?.email) {\n        return res.status(400).json({ message: 'User email required' });\n      }\n\n      let customerId = user.stripeCustomerId;\n\n      // Create Stripe customer if doesn't exist\n      if (!customerId) {\n        const customer = await stripe.customers.create({\n          email: user.email,\n          name: `${user.firstName || ''} ${user.lastName || ''}`.trim(),\n        });\n        customerId = customer.id;\n      }\n\n      // Get membership plan\n      const plans = await storage.getMembershipPlans();\n      const plan = plans.find(p => p.id === planId);\n      if (!plan || !plan.stripePriceId) {\n        return res.status(400).json({ message: 'Invalid membership plan' });\n      }\n\n      // Create subscription\n      const subscription = await stripe.subscriptions.create({\n        customer: customerId,\n        items: [{ price: plan.stripePriceId }],\n        payment_behavior: 'default_incomplete',\n        expand: ['latest_invoice.payment_intent'],\n      });\n\n      // Update user with Stripe info\n      await storage.updateUserStripeInfo(userId, customerId, subscription.id);\n\n      // Create membership record\n      const startDate = new Date();\n      const endDate = new Date();\n      endDate.setMonth(endDate.getMonth() + plan.durationMonths);\n\n      await storage.createMembership({\n        userId,\n        planId,\n        startDate,\n        endDate,\n        status: 'active',\n        autoRenewal: true,\n      });\n\n      const invoice = subscription.latest_invoice as Stripe.Invoice & {\n        payment_intent?: Stripe.PaymentIntent | string;\n      };\n      const paymentIntent = typeof invoice.payment_intent === 'string' \n        ? null \n        : invoice.payment_intent;\n      \n      if (!paymentIntent?.client_secret) {\n        throw new Error('No payment intent found');\n      }\n\n      res.json({\n        subscriptionId: subscription.id,\n        clientSecret: paymentIntent.client_secret,\n      });\n    } catch (error) {\n      console.error(\"Error creating subscription:\", error);\n      res.status(500).json({ message: \"Failed to create subscription\" });\n    }\n  });\n\n  // Admin routes\n  app.get('/api/admin/dashboard', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const [users, revenue, membershipStats] = await Promise.all([\n        storage.getUsersWithMemberships(),\n        storage.getRevenueStats(),\n        storage.getMembershipStats(),\n      ]);\n\n      // Calculate active members today (simplified - users with recent check-ins)\n      const today = new Date();\n      today.setHours(0, 0, 0, 0);\n      const activeToday = 0; // This would need a more complex query\n\n      res.json({\n        users,\n        stats: {\n          totalMembers: users.length,\n          activeToday,\n          expiringSoon: membershipStats.expiringSoon,\n          revenue,\n        }\n      });\n    } catch (error) {\n      console.error(\"Error fetching admin dashboard:\", error);\n      res.status(500).json({ message: \"Failed to fetch admin dashboard\" });\n    }\n  });\n\n  app.get('/api/admin/members', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const members = await storage.getUsersWithMemberships();\n      \n      // Add last check-in and activity info to each member\n      const membersWithActivity = await Promise.all(\n        members.map(async (member) => {\n          const checkIns = await storage.getUserCheckIns(member.id, 1);\n          const lastCheckIn = checkIns[0];\n          \n          let daysInactive = null;\n          if (lastCheckIn?.checkInTime) {\n            const now = new Date();\n            const lastCheckInDate = new Date(lastCheckIn.checkInTime);\n            const diffTime = now.getTime() - lastCheckInDate.getTime();\n            daysInactive = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n          }\n          \n          return {\n            ...member,\n            lastCheckIn: lastCheckIn?.checkInTime || null,\n            daysInactive,\n          };\n        })\n      );\n      \n      res.json(membersWithActivity);\n    } catch (error) {\n      console.error(\"Error fetching members:\", error);\n      res.status(500).json({ message: \"Failed to fetch members\" });\n    }\n  });\n\n  app.post('/api/admin/members', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { password, ...memberData } = req.body;\n      \n      const existingUsername = await storage.getUserByUsername(memberData.username);\n      if (existingUsername) {\n        return res.status(400).json({ message: \"Username sudah digunakan\" });\n      }\n\n      const existingEmail = await storage.getUserByEmail(memberData.email);\n      if (existingEmail) {\n        return res.status(400).json({ message: \"Email sudah digunakan\" });\n      }\n\n      const hashedPassword = await bcrypt.hash(password || 'default123', 10);\n\n      const newMember = await storage.createUser({\n        ...memberData,\n        password: hashedPassword,\n        role: 'member',\n      });\n\n      res.json({ ...newMember, password: undefined });\n    } catch (error: any) {\n      console.error(\"Error creating member:\", error);\n      res.status(500).json({ message: error.message || \"Failed to create member\" });\n    }\n  });\n\n  app.put('/api/admin/members/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const { password, ...updateData } = req.body;\n\n      if (updateData.username) {\n        const existingUsername = await storage.getUserByUsername(updateData.username);\n        if (existingUsername && existingUsername.id !== id) {\n          return res.status(400).json({ message: \"Username sudah digunakan\" });\n        }\n      }\n\n      if (updateData.email) {\n        const existingEmail = await storage.getUserByEmail(updateData.email);\n        if (existingEmail && existingEmail.id !== id) {\n          return res.status(400).json({ message: \"Email sudah digunakan\" });\n        }\n      }\n\n      const dataToUpdate: any = { ...updateData };\n      if (password) {\n        dataToUpdate.password = await bcrypt.hash(password, 10);\n      }\n\n      const updatedMember = await storage.updateUser(id, dataToUpdate);\n      res.json({ ...updatedMember, password: undefined });\n    } catch (error: any) {\n      console.error(\"Error updating member:\", error);\n      res.status(500).json({ message: error.message || \"Failed to update member\" });\n    }\n  });\n\n  app.delete('/api/admin/members/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      await storage.deleteUser(id);\n      res.json({ message: 'Member deleted successfully' });\n    } catch (error) {\n      console.error(\"Error deleting member:\", error);\n      res.status(500).json({ message: \"Failed to delete member\" });\n    }\n  });\n\n  app.put('/api/admin/members/:id/suspend', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const updatedMember = await storage.updateUser(id, { active: false });\n      res.json({ \n        message: 'Member suspended successfully',\n        member: { ...updatedMember, password: undefined }\n      });\n    } catch (error) {\n      console.error(\"Error suspending member:\", error);\n      res.status(500).json({ message: \"Failed to suspend member\" });\n    }\n  });\n\n  app.put('/api/admin/members/:id/activate', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const updatedMember = await storage.updateUser(id, { active: true });\n      res.json({ \n        message: 'Member activated successfully',\n        member: { ...updatedMember, password: undefined }\n      });\n    } catch (error) {\n      console.error(\"Error activating member:\", error);\n      res.status(500).json({ message: \"Failed to activate member\" });\n    }\n  });\n\n  app.post('/api/admin/members/:id/membership', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id: memberId } = req.params;\n      const { planId, durationMonths } = req.body;\n\n      const plan = await storage.getMembershipPlans();\n      const selectedPlan = plan.find(p => p.id === planId);\n      \n      if (!selectedPlan) {\n        return res.status(404).json({ message: 'Plan not found' });\n      }\n\n      const existingMembership = await storage.getUserMembership(memberId);\n      if (existingMembership) {\n        await storage.cancelUserMemberships(memberId);\n      }\n\n      const startDate = new Date();\n      const endDate = new Date();\n      endDate.setMonth(endDate.getMonth() + (durationMonths || selectedPlan.durationMonths));\n\n      const membership = await storage.createMembership({\n        userId: memberId,\n        planId,\n        startDate,\n        endDate,\n        status: 'active',\n        autoRenewal: false,\n      });\n\n      res.json(membership);\n    } catch (error: any) {\n      console.error(\"Error assigning membership:\", error);\n      res.status(500).json({ message: error.message || \"Failed to assign membership\" });\n    }\n  });\n\n  app.get('/api/admin/membership-plans', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const plans = await storage.getAllMembershipPlans();\n      res.json(plans);\n    } catch (error) {\n      console.error(\"Error fetching membership plans:\", error);\n      res.status(500).json({ message: \"Failed to fetch membership plans\" });\n    }\n  });\n\n  app.post('/api/admin/membership-plans', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const validatedData = insertMembershipPlanSchema.parse(req.body);\n      const plan = await storage.createMembershipPlan(validatedData);\n      res.json(plan);\n    } catch (error) {\n      console.error(\"Error creating membership plan:\", error);\n      res.status(500).json({ message: \"Failed to create membership plan\" });\n    }\n  });\n\n  app.put('/api/admin/membership-plans/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const updateData = req.body;\n      \n      const plan = await storage.updateMembershipPlan(id, updateData);\n      res.json(plan);\n    } catch (error) {\n      console.error(\"Error updating membership plan:\", error);\n      res.status(500).json({ message: \"Failed to update membership plan\" });\n    }\n  });\n\n  app.delete('/api/admin/membership-plans/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      await storage.deleteMembershipPlan(id);\n      res.json({ message: 'Membership plan deleted successfully' });\n    } catch (error) {\n      console.error(\"Error deleting membership plan:\", error);\n      res.status(500).json({ message: \"Failed to delete membership plan\" });\n    }\n  });\n\n  app.post('/api/admin/classes', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const validatedData = insertGymClassSchema.parse(req.body);\n      const gymClass = await storage.createGymClass(validatedData);\n      res.json(gymClass);\n    } catch (error) {\n      console.error(\"Error creating class:\", error);\n      res.status(500).json({ message: \"Failed to create class\" });\n    }\n  });\n\n  app.get('/api/admin/classes', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const classes = await storage.getGymClasses();\n      res.json(classes);\n    } catch (error) {\n      console.error(\"Error fetching classes:\", error);\n      res.status(500).json({ message: \"Failed to fetch classes\" });\n    }\n  });\n\n  app.put('/api/admin/classes/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const updateData = req.body;\n      \n      await storage.updateGymClass(id, updateData);\n      res.json({ message: 'Class updated successfully' });\n    } catch (error) {\n      console.error(\"Error updating class:\", error);\n      res.status(500).json({ message: \"Failed to update class\" });\n    }\n  });\n\n  app.delete('/api/admin/classes/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      await storage.deleteGymClass(id);\n      res.json({ message: 'Class deleted successfully' });\n    } catch (error) {\n      console.error(\"Error deleting class:\", error);\n      res.status(500).json({ message: \"Failed to delete class\" });\n    }\n  });\n\n  app.get('/api/admin/class-bookings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const bookings = await storage.getAllClassBookings();\n      res.json(bookings);\n    } catch (error) {\n      console.error(\"Error fetching class bookings:\", error);\n      res.status(500).json({ message: \"Failed to fetch class bookings\" });\n    }\n  });\n\n  app.put('/api/admin/class-bookings/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const { status } = req.body;\n\n      if (!status) {\n        return res.status(400).json({ message: 'Status is required' });\n      }\n\n      // Get booking details before updating\n      const bookings = await storage.getAllClassBookings();\n      const booking = bookings.find(b => b.id === id);\n\n      await storage.updateClassBookingStatus(id, status);\n\n      // Create notification when booking is confirmed or attended\n      if (booking && (status === 'attended' || status === 'booked')) {\n        const notificationTitle = status === 'attended' \n          ? 'Class Booking Dikonfirmasi'\n          : 'Class Booking Berhasil';\n        const notificationMessage = status === 'attended'\n          ? `Booking Anda untuk class \"${booking.gymClass.name}\" telah dikonfirmasi oleh admin.`\n          : `Booking Anda untuk class \"${booking.gymClass.name}\" berhasil terdaftar.`;\n\n        await sendNotificationWithPush(booking.userId, {\n          userId: booking.userId,\n          title: notificationTitle,\n          message: notificationMessage,\n          type: 'booking_confirmed',\n          relatedId: booking.id,\n          isRead: false,\n        });\n      }\n\n      res.json({ message: 'Class booking updated successfully' });\n    } catch (error) {\n      console.error(\"Error updating class booking:\", error);\n      res.status(500).json({ message: \"Failed to update class booking\" });\n    }\n  });\n\n  app.delete('/api/admin/class-bookings/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      await storage.cancelClassBooking(id);\n      res.json({ message: 'Class booking cancelled successfully' });\n    } catch (error) {\n      console.error(\"Error cancelling class booking:\", error);\n      res.status(500).json({ message: \"Failed to cancel class booking\" });\n    }\n  });\n\n  // Admin Check-in routes\n  app.post('/api/admin/checkin/validate', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { qrCode } = req.body;\n      if (!qrCode) {\n        return res.status(400).json({ message: 'QR code is required' });\n      }\n\n      console.log(`[Admin Check-in] Validating QR code: ${qrCode}`);\n\n      // Try to find user by permanent QR code first\n      let memberUser = await storage.getUserByPermanentQrCode(qrCode);\n      let isOneTimeQr = false;\n      \n      // If not found by permanent QR code, try to find by one-time QR code\n      if (!memberUser) {\n        console.log(`[Admin Check-in] Not a permanent QR, checking one-time QR...`);\n        const oneTimeQr = await storage.validateOneTimeQrCode(qrCode);\n        \n        if (oneTimeQr) {\n          console.log(`[Admin Check-in] Found one-time QR with status: ${oneTimeQr.status}`);\n          // Check if QR code is still valid\n          const now = new Date();\n          if (oneTimeQr.status === 'used') {\n            return res.json({\n              success: false,\n              message: 'QR code sudah pernah digunakan'\n            });\n          }\n          \n          if (oneTimeQr.status === 'expired' || oneTimeQr.expiresAt < now) {\n            return res.json({\n              success: false,\n              message: 'QR code sudah kadaluarsa. Silakan generate QR baru'\n            });\n          }\n          \n          // Get user from one-time QR code\n          memberUser = await storage.getUser(oneTimeQr.userId);\n          isOneTimeQr = true;\n          console.log(`[Admin Check-in] Valid one-time QR for user: ${memberUser?.firstName} ${memberUser?.lastName}`);\n        } else {\n          console.log(`[Admin Check-in] One-time QR not found`);\n        }\n      }\n      \n      if (!memberUser) {\n        return res.status(404).json({ \n          success: false,\n          message: 'QR code tidak valid atau member tidak ditemukan' \n        });\n      }\n\n      // Check membership status\n      const membership = await storage.getUserMembership(memberUser.id);\n      const now = new Date();\n      const hasActiveMembership = membership && new Date(membership.endDate) > now;\n\n      // If no active membership, return failure response with member info\n      if (!hasActiveMembership) {\n        return res.json({\n          success: false,\n          user: memberUser,\n          membership,\n          message: 'Belum terdaftar membership atau membership sudah expired'\n        });\n      }\n\n      // Membership is active, create check-in using permanent QR code or user ID\n      let checkInData;\n      if (memberUser.permanentQrCode) {\n        checkInData = await storage.validateMemberQrAndCheckIn(memberUser.permanentQrCode);\n      } else {\n        // If user doesn't have permanent QR code, create one and use it for check-in\n        const permanentQr = await storage.ensureUserPermanentQrCode(memberUser.id);\n        checkInData = await storage.validateMemberQrAndCheckIn(permanentQr);\n      }\n      \n      if (!checkInData) {\n        return res.status(500).json({ \n          success: false,\n          message: 'Gagal membuat check-in' \n        });\n      }\n\n      // Mark one-time QR code as used ONLY after successful check-in\n      if (isOneTimeQr) {\n        try {\n          console.log(`[Admin Check-in] Marking one-time QR code as used: ${qrCode}`);\n          await storage.markQrCodeAsUsed(qrCode);\n          console.log(`[Admin Check-in] Successfully marked QR code as used`);\n        } catch (error) {\n          // Log the error but don't fail the request since check-in was successful\n          console.error(\"[Admin Check-in] Warning: Could not mark QR code as used:\", error);\n        }\n      }\n\n      console.log(`[Admin Check-in] Check-in successful for user: ${checkInData.user?.firstName} ${checkInData.user?.lastName}`);\n      res.json({\n        success: true,\n        ...checkInData\n      });\n    } catch (error) {\n      console.error(\"Error validating check-in:\", error);\n      res.status(500).json({ \n        success: false,\n        message: \"Failed to validate check-in\" \n      });\n    }\n  });\n\n  app.get('/api/admin/checkins', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 20;\n      const checkIns = await storage.getRecentCheckIns(limit);\n      res.json(checkIns);\n    } catch (error) {\n      console.error(\"Error fetching check-ins:\", error);\n      res.status(500).json({ message: \"Failed to fetch check-ins\" });\n    }\n  });\n\n  app.post('/api/admin/auto-checkout', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const checkedOutCount = await storage.autoCheckoutExpiredSessions();\n      res.json({ \n        success: true, \n        checkedOutCount,\n        message: `Successfully auto-checked out ${checkedOutCount} member(s)`\n      });\n    } catch (error) {\n      console.error(\"Error running auto-checkout:\", error);\n      res.status(500).json({ message: \"Failed to run auto-checkout\" });\n    }\n  });\n\n  // Feedback routes\n  app.post('/api/feedbacks', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { subject, message, rating } = req.body;\n\n      if (!subject || !message) {\n        return res.status(400).json({ message: 'Subject and message are required' });\n      }\n\n      const feedback = await storage.createFeedback({\n        userId,\n        subject,\n        message,\n        rating: rating || null,\n        status: 'pending',\n      });\n\n      res.json(feedback);\n    } catch (error) {\n      console.error(\"Error creating feedback:\", error);\n      res.status(500).json({ message: \"Failed to create feedback\" });\n    }\n  });\n\n  app.get('/api/feedbacks', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const feedbacks = await storage.getUserFeedbacks(userId);\n      res.json(feedbacks);\n    } catch (error) {\n      console.error(\"Error fetching feedbacks:\", error);\n      res.status(500).json({ message: \"Failed to fetch feedbacks\" });\n    }\n  });\n\n  app.get('/api/admin/feedbacks', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const feedbacks = await storage.getAllFeedbacks();\n      res.json(feedbacks);\n    } catch (error) {\n      console.error(\"Error fetching all feedbacks:\", error);\n      res.status(500).json({ message: \"Failed to fetch feedbacks\" });\n    }\n  });\n\n  app.put('/api/admin/feedbacks/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const { status, adminResponse } = req.body;\n\n      if (!status) {\n        return res.status(400).json({ message: 'Status is required' });\n      }\n\n      await storage.updateFeedbackStatus(id, status, adminResponse);\n      res.json({ message: 'Feedback updated successfully' });\n    } catch (error) {\n      console.error(\"Error updating feedback:\", error);\n      res.status(500).json({ message: \"Failed to update feedback\" });\n    }\n  });\n\n  // Personal Trainer routes\n  app.get('/api/trainers', isAuthenticated, async (req, res) => {\n    try {\n      const trainers = await storage.getActiveTrainers();\n      res.json(trainers);\n    } catch (error) {\n      console.error(\"Error fetching trainers:\", error);\n      res.status(500).json({ message: \"Failed to fetch trainers\" });\n    }\n  });\n\n  app.get('/api/trainers/:id', isAuthenticated, async (req, res) => {\n    try {\n      const { id } = req.params;\n      const trainer = await storage.getTrainerById(id);\n      \n      if (!trainer) {\n        return res.status(404).json({ message: 'Trainer not found' });\n      }\n      \n      res.json(trainer);\n    } catch (error) {\n      console.error(\"Error fetching trainer:\", error);\n      res.status(500).json({ message: \"Failed to fetch trainer\" });\n    }\n  });\n\n  // Admin PT management routes\n  app.get('/api/admin/trainers', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const trainers = await storage.getAllTrainers();\n      res.json(trainers);\n    } catch (error) {\n      console.error(\"Error fetching trainers:\", error);\n      res.status(500).json({ message: \"Failed to fetch trainers\" });\n    }\n  });\n\n  app.post('/api/admin/trainers', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const trainerSchema = z.object({\n        name: z.string().min(1, \"Name is required\"),\n        bio: z.string().optional(),\n        specialization: z.string().min(1, \"Specialization is required\"),\n        experience: z.number().optional(),\n        certification: z.string().optional(),\n        imageUrl: z.string().optional(),\n        pricePerSession: z.string().or(z.number()).transform(val => String(val)),\n        availability: z.any().optional(),\n        active: z.boolean().optional().default(true),\n      });\n\n      const validatedData = trainerSchema.parse(req.body);\n      const trainer = await storage.createTrainer(validatedData);\n      res.json(trainer);\n    } catch (error: any) {\n      console.error(\"Error creating trainer:\", error);\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid trainer data\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Failed to create trainer\" });\n    }\n  });\n\n  app.put('/api/admin/trainers/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      \n      const updateTrainerSchema = z.object({\n        name: z.string().min(1).optional(),\n        bio: z.string().optional(),\n        specialization: z.string().min(1).optional(),\n        experience: z.number().optional(),\n        certification: z.string().optional(),\n        imageUrl: z.string().optional(),\n        pricePerSession: z.string().or(z.number()).transform(val => String(val)).optional(),\n        availability: z.any().optional(),\n        active: z.boolean().optional(),\n      });\n\n      const validatedData = updateTrainerSchema.parse(req.body);\n      await storage.updateTrainer(id, validatedData);\n      res.json({ message: 'Trainer updated successfully' });\n    } catch (error: any) {\n      console.error(\"Error updating trainer:\", error);\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid trainer data\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Failed to update trainer\" });\n    }\n  });\n\n  app.delete('/api/admin/trainers/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      await storage.deleteTrainer(id);\n      res.json({ message: 'Trainer deleted successfully' });\n    } catch (error) {\n      console.error(\"Error deleting trainer:\", error);\n      res.status(500).json({ message: \"Failed to delete trainer\" });\n    }\n  });\n\n  // PT Booking routes\n  app.get('/api/pt-bookings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const bookings = await storage.getUserPtBookings(userId);\n      res.json(bookings);\n    } catch (error) {\n      console.error(\"Error fetching PT bookings:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT bookings\" });\n    }\n  });\n\n  app.post('/api/pt-bookings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n\n      const ptBookingSchema = z.object({\n        trainerId: z.string().min(1, \"Trainer ID is required\"),\n        bookingDate: z.string().min(1, \"Booking date is required\"),\n        duration: z.number().optional().default(60),\n        sessionCount: z.number().int().min(1, \"Session count must be at least 1\").optional().default(1),\n        notes: z.string().optional(),\n      });\n\n      const validatedData = ptBookingSchema.parse(req.body);\n\n      const booking = await storage.createPtBooking({\n        userId,\n        trainerId: validatedData.trainerId,\n        bookingDate: new Date(validatedData.bookingDate),\n        duration: validatedData.duration,\n        sessionCount: validatedData.sessionCount,\n        notes: validatedData.notes,\n        status: 'pending',\n      });\n\n      res.json(booking);\n    } catch (error: any) {\n      console.error(\"Error creating PT booking:\", error);\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid booking data\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Failed to create PT booking\" });\n    }\n  });\n\n  app.put('/api/pt-bookings/:id/cancel', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { id } = req.params;\n      \n      const userBookings = await storage.getUserPtBookings(userId);\n      const booking = userBookings.find(b => b.id === id);\n      \n      if (!booking) {\n        return res.status(404).json({ message: 'Booking not found or unauthorized' });\n      }\n      \n      if (booking.status === 'cancelled') {\n        return res.status(400).json({ message: 'Booking already cancelled' });\n      }\n      \n      await storage.cancelPtBooking(id);\n      res.json({ message: 'PT booking cancelled successfully' });\n    } catch (error) {\n      console.error(\"Error cancelling PT booking:\", error);\n      res.status(500).json({ message: \"Failed to cancel PT booking\" });\n    }\n  });\n\n  // Admin PT booking management\n  app.get('/api/admin/pt-bookings', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const bookings = await storage.getAllPtBookings();\n      res.json(bookings);\n    } catch (error) {\n      console.error(\"Error fetching PT bookings:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT bookings\" });\n    }\n  });\n\n  app.put('/api/admin/pt-bookings/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const { status } = req.body;\n\n      if (!status) {\n        return res.status(400).json({ message: 'Status is required' });\n      }\n\n      // Get booking details before updating\n      const bookings = await storage.getAllPtBookings();\n      const booking = bookings.find(b => b.id === id);\n\n      await storage.updatePtBookingStatus(id, status);\n\n      // Create notification when PT booking is confirmed or completed\n      if (booking && (status === 'confirmed' || status === 'completed')) {\n        const notificationTitle = status === 'confirmed'\n          ? 'Sesi PT Dikonfirmasi'\n          : 'Sesi PT Selesai';\n        const notificationMessage = status === 'confirmed'\n          ? `Sesi PT Anda dengan ${booking.trainer.name} telah dikonfirmasi oleh admin.`\n          : `Sesi PT Anda dengan ${booking.trainer.name} telah selesai.`;\n\n        await sendNotificationWithPush(booking.userId, {\n          userId: booking.userId,\n          title: notificationTitle,\n          message: notificationMessage,\n          type: 'pt_booking_confirmed',\n          relatedId: booking.id,\n          isRead: false,\n        });\n      }\n\n      res.json({ message: 'PT booking updated successfully' });\n    } catch (error) {\n      console.error(\"Error updating PT booking:\", error);\n      res.status(500).json({ message: \"Failed to update PT booking\" });\n    }\n  });\n\n  // PT Session Package routes\n  app.post('/api/pt-session-packages', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      \n      const packageSchema = z.object({\n        trainerId: z.string().min(1, \"Trainer ID is required\"),\n        totalSessions: z.number().min(1, \"Total sessions must be at least 1\"),\n        pricePerSession: z.string(),\n      });\n\n      const validatedData = packageSchema.parse(req.body);\n      const totalPrice = (parseFloat(validatedData.pricePerSession) * validatedData.totalSessions).toFixed(2);\n\n      const pkg = await storage.createPtSessionPackage({\n        userId,\n        trainerId: validatedData.trainerId,\n        totalSessions: validatedData.totalSessions,\n        usedSessions: 0,\n        remainingSessions: validatedData.totalSessions,\n        pricePerSession: validatedData.pricePerSession,\n        totalPrice,\n        status: 'active',\n      });\n\n      res.json(pkg);\n    } catch (error: any) {\n      console.error(\"Error creating PT session package:\", error);\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid package data\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Failed to create PT session package\" });\n    }\n  });\n\n  app.get('/api/pt-session-packages', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const packages = await storage.getUserPtSessionPackages(userId);\n      res.json(packages);\n    } catch (error) {\n      console.error(\"Error fetching PT session packages:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT session packages\" });\n    }\n  });\n\n  app.get('/api/pt-session-packages/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const pkg = await storage.getPtSessionPackageById(id);\n      \n      if (!pkg) {\n        return res.status(404).json({ message: 'Package not found' });\n      }\n      \n      res.json(pkg);\n    } catch (error) {\n      console.error(\"Error fetching PT session package:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT session package\" });\n    }\n  });\n\n  // PT Session Attendance routes\n  app.post('/api/pt-session-attendance', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n\n      const attendanceSchema = z.object({\n        packageId: z.string().min(1, \"Package ID is required\"),\n        sessionDate: z.string().min(1, \"Session date is required\"),\n        notes: z.string().optional(),\n      });\n\n      const validatedData = attendanceSchema.parse(req.body);\n\n      // Get package to validate and get session number\n      const pkg = await storage.getPtSessionPackageById(validatedData.packageId);\n      if (!pkg) {\n        return res.status(404).json({ message: 'Package not found' });\n      }\n\n      if (pkg.userId !== userId) {\n        return res.status(403).json({ message: 'Unauthorized' });\n      }\n\n      if (pkg.remainingSessions <= 0) {\n        return res.status(400).json({ message: 'No remaining sessions' });\n      }\n\n      // Get existing sessions to determine session number\n      const existingSessions = await storage.getPackageAttendanceSessions(validatedData.packageId);\n      const sessionNumber = existingSessions.length + 1;\n\n      const attendance = await storage.createPtSessionAttendance({\n        packageId: validatedData.packageId,\n        userId,\n        trainerId: pkg.trainerId,\n        sessionDate: new Date(validatedData.sessionDate),\n        sessionNumber,\n        status: 'scheduled',\n        notes: validatedData.notes,\n        adminConfirmed: false,\n      });\n\n      res.json(attendance);\n    } catch (error: any) {\n      console.error(\"Error creating PT session attendance:\", error);\n      if (error.name === 'ZodError') {\n        return res.status(400).json({ message: \"Invalid attendance data\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Failed to create PT session attendance\" });\n    }\n  });\n\n  app.get('/api/pt-session-attendance', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const sessions = await storage.getUserPtAttendanceSessions(userId);\n      res.json(sessions);\n    } catch (error) {\n      console.error(\"Error fetching PT session attendance:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT session attendance\" });\n    }\n  });\n\n  app.get('/api/pt-session-attendance/:id', isAuthenticated, async (req: any, res) => {\n    try {\n      const { id } = req.params;\n      const session = await storage.getPtSessionAttendanceById(id);\n      \n      if (!session) {\n        return res.status(404).json({ message: 'Session not found' });\n      }\n      \n      res.json(session);\n    } catch (error) {\n      console.error(\"Error fetching PT session attendance:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT session attendance\" });\n    }\n  });\n\n  app.put('/api/pt-session-attendance/:id/check-in', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const { id } = req.params;\n      \n      const session = await storage.getPtSessionAttendanceById(id);\n      \n      if (!session) {\n        return res.status(404).json({ message: 'Session not found' });\n      }\n\n      if (session.userId !== userId) {\n        return res.status(403).json({ message: 'Unauthorized' });\n      }\n\n      if (session.status === 'completed') {\n        return res.status(400).json({ message: 'Session already completed' });\n      }\n\n      await storage.updatePtSessionAttendance(id, {\n        checkInTime: new Date(),\n        status: 'completed',\n      });\n\n      res.json({ message: 'Checked in successfully' });\n    } catch (error) {\n      console.error(\"Error checking in PT session:\", error);\n      res.status(500).json({ message: \"Failed to check in\" });\n    }\n  });\n\n  // Admin PT session attendance routes\n  app.get('/api/admin/pt-session-packages', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.id);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      // Get all users' packages\n      const allUsers = await storage.getAllUsers();\n      const allPackages = [];\n      \n      for (const u of allUsers) {\n        const userPackages = await storage.getUserPtSessionPackages(u.id);\n        allPackages.push(...userPackages.map(pkg => ({\n          ...pkg,\n          user: u,\n        })));\n      }\n\n      res.json(allPackages);\n    } catch (error) {\n      console.error(\"Error fetching PT session packages:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT session packages\" });\n    }\n  });\n\n  app.get('/api/admin/pt-session-attendance', isAuthenticated, async (req: any, res) => {\n    try {\n      const user = await storage.getUser(req.user.id);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      // Get all users' sessions\n      const allUsers = await storage.getAllUsers();\n      const allSessions = [];\n      \n      for (const u of allUsers) {\n        const userSessions = await storage.getUserPtAttendanceSessions(u.id);\n        allSessions.push(...userSessions.map(session => ({\n          ...session,\n          user: u,\n        })));\n      }\n\n      res.json(allSessions);\n    } catch (error) {\n      console.error(\"Error fetching PT session attendance:\", error);\n      res.status(500).json({ message: \"Failed to fetch PT session attendance\" });\n    }\n  });\n\n  app.put('/api/admin/pt-session-attendance/:id/confirm', isAuthenticated, async (req: any, res) => {\n    try {\n      const adminId = req.user.id;\n      const user = await storage.getUser(adminId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { id } = req.params;\n      const session = await storage.getPtSessionAttendanceById(id);\n      \n      if (!session) {\n        return res.status(404).json({ message: 'Session not found' });\n      }\n\n      if (session.adminConfirmed) {\n        return res.status(400).json({ message: 'Session already confirmed' });\n      }\n\n      // Confirm attendance\n      await storage.confirmPtSessionAttendance(id, adminId);\n\n      // Update package used sessions\n      const pkg = await storage.getPtSessionPackageById(session.packageId);\n      if (pkg) {\n        const newUsedSessions = (pkg.usedSessions || 0) + 1;\n        const newRemainingSessions = pkg.totalSessions - newUsedSessions;\n        \n        await storage.updatePtSessionPackage(session.packageId, {\n          usedSessions: newUsedSessions,\n          remainingSessions: newRemainingSessions,\n          status: newRemainingSessions <= 0 ? 'completed' : 'active',\n        });\n      }\n\n      // Create notification\n      await sendNotificationWithPush(session.userId, {\n        userId: session.userId,\n        title: 'Sesi PT Dikonfirmasi',\n        message: `Sesi PT Anda dengan ${session.trainer.name} telah dikonfirmasi oleh admin.`,\n        type: 'pt_session_confirmed',\n        relatedId: session.id,\n        isRead: false,\n      });\n\n      res.json({ message: 'Session confirmed successfully' });\n    } catch (error) {\n      console.error(\"Error confirming PT session:\", error);\n      res.status(500).json({ message: \"Failed to confirm session\" });\n    }\n  });\n\n  // Inactivity reminder endpoint\n  app.post('/api/admin/send-inactivity-reminders', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const { daysInactive = 7 } = req.body;\n      \n      const reminderCount = await storage.sendInactivityReminders(daysInactive);\n      \n      res.json({ \n        message: `Berhasil mengirim ${reminderCount} reminder ke member yang tidak aktif`,\n        count: reminderCount,\n        daysInactive\n      });\n    } catch (error) {\n      console.error(\"Error sending inactivity reminders:\", error);\n      res.status(500).json({ message: \"Failed to send inactivity reminders\" });\n    }\n  });\n\n  // Get inactive members endpoint\n  app.get('/api/admin/inactive-members', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      if (user?.role !== 'admin') {\n        return res.status(403).json({ message: 'Admin access required' });\n      }\n\n      const daysInactive = parseInt(req.query.days as string) || 7;\n      \n      const inactiveMembers = await storage.getInactiveMembers(daysInactive);\n      \n      res.json({ \n        members: inactiveMembers,\n        count: inactiveMembers.length,\n        daysInactive\n      });\n    } catch (error) {\n      console.error(\"Error fetching inactive members:\", error);\n      res.status(500).json({ message: \"Failed to fetch inactive members\" });\n    }\n  });\n\n  // Indonesian Payment Gateway Routes\n  \n  // QRIS Payment\n  app.post('/api/payment/qris', isAuthenticated, async (req: any, res) => {\n    try {\n      if (!midtransCore) {\n        return res.status(501).json({ \n          message: 'Payment gateway belum dikonfigurasi. Hubungi administrator.' \n        });\n      }\n\n      // Validate input\n      const qrisPaymentSchema = z.object({\n        planId: z.string().min(1, 'Plan ID diperlukan'),\n      });\n\n      const validatedData = qrisPaymentSchema.parse(req.body);\n      const { planId } = validatedData;\n\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n\n      if (!user?.email) {\n        return res.status(400).json({ message: 'Email user diperlukan' });\n      }\n\n      // Get membership plan\n      const plans = await storage.getMembershipPlans();\n      const plan = plans.find(p => p.id === planId);\n      if (!plan) {\n        return res.status(400).json({ message: 'Paket membership tidak valid' });\n      }\n\n      const orderId = `gym-${userId}-${Date.now()}`;\n      const parameter = {\n        payment_type: 'qris',\n        transaction_details: {\n          order_id: orderId,\n          gross_amount: parseInt(plan.price),\n        },\n        qris: {\n          acquirer: 'gopay'\n        },\n        customer_details: {\n          first_name: user.firstName || 'Member',\n          last_name: user.lastName || 'Gym',\n          email: user.email,\n        },\n        item_details: [{\n          id: plan.id,\n          price: parseInt(plan.price),\n          quantity: 1,\n          name: `Membership ${plan.name}`,\n          category: 'Gym Membership'\n        }]\n      };\n\n      const qrisTransaction = await midtransCore.charge(parameter);\n      \n      // Create payment record with proper reconciliation fields\n      const paymentRecord = await storage.createPayment({\n        userId,\n        amount: plan.price,\n        currency: 'IDR',\n        status: 'pending',\n        description: `${orderId} - Membership ${plan.name} - QRIS`,\n        stripePaymentIntentId: qrisTransaction.transaction_id, // Store Midtrans transaction ID\n      });\n\n      res.json({\n        orderId,\n        qrString: qrisTransaction.qr_string,\n        transactionId: qrisTransaction.transaction_id,\n        transactionStatus: qrisTransaction.transaction_status,\n        paymentId: paymentRecord.id,\n        message: 'Scan QR Code untuk melakukan pembayaran'\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ \n          message: 'Data input tidak valid', \n          errors: error.errors \n        });\n      }\n      console.error(\"Error creating QRIS payment:\", error);\n      res.status(500).json({ message: \"Gagal membuat pembayaran QRIS\" });\n    }\n  });\n\n  // Virtual Account Payment\n  app.post('/api/payment/va', isAuthenticated, async (req: any, res) => {\n    try {\n      if (!midtransCore) {\n        return res.status(501).json({ \n          message: 'Payment gateway belum dikonfigurasi. Hubungi administrator.' \n        });\n      }\n\n      // Validate input\n      const vaPaymentSchema = z.object({\n        planId: z.string().min(1, 'Plan ID diperlukan'),\n        bankCode: z.enum(['bca', 'bni', 'bri', 'mandiri', 'permata'], {\n          errorMap: () => ({ message: 'Bank tidak didukung' })\n        }),\n      });\n\n      const validatedData = vaPaymentSchema.parse(req.body);\n      const { planId, bankCode } = validatedData;\n\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n\n      if (!user?.email) {\n        return res.status(400).json({ message: 'Email user diperlukan' });\n      }\n\n      // Get membership plan\n      const plans = await storage.getMembershipPlans();\n      const plan = plans.find(p => p.id === planId);\n      if (!plan) {\n        return res.status(400).json({ message: 'Paket membership tidak valid' });\n      }\n\n      const orderId = `gym-va-${userId}-${Date.now()}`;\n      \n      // Different parameter structure for different banks\n      let parameter: any = {\n        transaction_details: {\n          order_id: orderId,\n          gross_amount: parseInt(plan.price),\n        },\n        customer_details: {\n          first_name: user.firstName || 'Member',\n          last_name: user.lastName || 'Gym',\n          email: user.email,\n        },\n        item_details: [{\n          id: plan.id,\n          price: parseInt(plan.price),\n          quantity: 1,\n          name: `Membership ${plan.name}`,\n          category: 'Gym Membership'\n        }]\n      };\n\n      // Handle different bank requirements\n      if (bankCode === 'mandiri') {\n        parameter.payment_type = 'echannel';\n        parameter.echannel = {\n          bill_info1: `Membership ${plan.name}`,\n          bill_info2: `Gym Idachi Fitness`\n        };\n      } else {\n        parameter.payment_type = 'bank_transfer';\n        parameter.bank_transfer = {\n          bank: bankCode\n        };\n      }\n\n      const vaTransaction = await midtransCore.charge(parameter);\n      \n      // Extract VA number based on bank\n      let vaNumber: string = '';\n      let expiry: string = '';\n      \n      if (bankCode === 'mandiri') {\n        vaNumber = vaTransaction.bill_key || '';\n        expiry = vaTransaction.biller_code || '';\n      } else if (bankCode === 'permata') {\n        vaNumber = vaTransaction.permata_va_number || '';\n      } else {\n        vaNumber = vaTransaction.va_numbers?.[0]?.va_number || '';\n        if (vaTransaction.va_numbers?.[0]) {\n          expiry = vaTransaction.va_numbers[0].expiry_date || '';\n        }\n      }\n      \n      // Create payment record with proper reconciliation fields\n      const paymentRecord = await storage.createPayment({\n        userId,\n        amount: plan.price,\n        currency: 'IDR',\n        status: 'pending',\n        description: `${orderId} - Membership ${plan.name} - VA ${bankCode.toUpperCase()}`,\n        stripePaymentIntentId: vaTransaction.transaction_id, // Store Midtrans transaction ID\n      });\n\n      res.json({\n        orderId,\n        vaNumber,\n        bank: bankCode.toUpperCase(),\n        expiry,\n        transactionId: vaTransaction.transaction_id,\n        transactionStatus: vaTransaction.transaction_status,\n        paymentId: paymentRecord.id,\n        message: `Transfer ke Virtual Account ${bankCode.toUpperCase()}`,\n        instructions: `Transfer sejumlah Rp ${parseInt(plan.price).toLocaleString('id-ID')} ke nomor VA: ${vaNumber}`\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ \n          message: 'Data input tidak valid', \n          errors: error.errors \n        });\n      }\n      console.error(\"Error creating VA payment:\", error);\n      res.status(500).json({ message: \"Gagal membuat Virtual Account\" });\n    }\n  });\n\n  // Payment status check endpoint\n  app.get('/api/payment/status/:orderId', isAuthenticated, async (req: any, res) => {\n    try {\n      const { orderId } = req.params;\n      const userId = req.user.id;\n      \n      // Verify the order belongs to this user by checking the order format\n      // Format: gym-${userId}-${timestamp} or gym-va-${userId}-${timestamp}\n      const orderParts = orderId.split('-');\n      const isGymFormat = orderParts[0] === 'gym' && orderParts[1] !== 'va';\n      const isGymVaFormat = orderParts[0] === 'gym' && orderParts[1] === 'va';\n      \n      let orderUserId = '';\n      if (isGymFormat && orderParts.length >= 3) {\n        orderUserId = orderParts[1];\n      } else if (isGymVaFormat && orderParts.length >= 4) {\n        orderUserId = orderParts[2];\n      }\n      \n      if (!orderUserId || orderUserId !== userId) {\n        return res.status(403).json({ message: 'Unauthorized access to payment status' });\n      }\n\n      // Get payment by description (which contains the order ID)\n      const payment = await storage.getPaymentByOrderId(orderId);\n      \n      if (!payment) {\n        return res.status(404).json({ message: 'Payment not found' });\n      }\n\n      res.json({\n        orderId,\n        status: payment.status,\n        amount: payment.amount,\n        currency: payment.currency,\n        transactionId: payment.stripePaymentIntentId\n      });\n    } catch (error) {\n      console.error(\"Error checking payment status:\", error);\n      res.status(500).json({ message: \"Failed to check payment status\" });\n    }\n  });\n\n  // Payment notification webhook (for Midtrans)\n  app.post('/api/payment/midtrans/notify', async (req, res) => {\n    try {\n      if (!midtransCore) {\n        return res.status(501).json({ message: 'Payment gateway not configured' });\n      }\n\n      const notificationJson = req.body;\n      \n      // Verify signature for security\n      const orderId = notificationJson.order_id;\n      const statusCode = notificationJson.status_code;\n      const grossAmount = notificationJson.gross_amount;\n      const serverKey = process.env.MIDTRANS_SERVER_KEY;\n      \n      if (!serverKey) {\n        console.error(\"Missing Midtrans server key for signature verification\");\n        return res.status(500).json({ message: \"Server configuration error\" });\n      }\n\n      // Create signature hash\n      const crypto = require('crypto');\n      const signatureKey = orderId + statusCode + grossAmount + serverKey;\n      const signature = crypto.createHash('sha512').update(signatureKey).digest('hex');\n      \n      if (signature !== notificationJson.signature_key) {\n        console.error(`Invalid signature for order ${orderId}`);\n        return res.status(401).json({ message: \"Invalid signature\" });\n      }\n\n      const statusResponse = await midtransCore.transaction.notification(notificationJson);\n      \n      const transactionStatus = statusResponse.transaction_status;\n      const fraudStatus = statusResponse.fraud_status;\n      const transactionId = statusResponse.transaction_id;\n\n      console.log(`Transaction notification received. Order ID: ${orderId}. Transaction status: ${transactionStatus}. Fraud status: ${fraudStatus}`);\n\n      // Find payment record by order ID (extract user ID from order ID format)\n      // Format: gym-${userId}-${timestamp} or gym-va-${userId}-${timestamp}\n      const orderParts = orderId.split('-');\n      let userId: string | null = null;\n      \n      const isGymFormat = orderParts[0] === 'gym' && orderParts[1] !== 'va';\n      const isGymVaFormat = orderParts[0] === 'gym' && orderParts[1] === 'va';\n      \n      if (isGymFormat && orderParts.length >= 3) {\n        userId = orderParts[1];\n      } else if (isGymVaFormat && orderParts.length >= 4) {\n        userId = orderParts[2];\n      }\n\n      if (!userId) {\n        console.error(`Could not extract user ID from order ID: ${orderId}`);\n        return res.status(400).json({ message: \"Invalid order ID format\" });\n      }\n\n      // Update payment status based on transaction status\n      let paymentStatus = 'pending';\n      let shouldActivateMembership = false;\n\n      if (transactionStatus === 'capture') {\n        if (fraudStatus === 'challenge') {\n          paymentStatus = 'challenged';\n        } else if (fraudStatus === 'accept') {\n          paymentStatus = 'completed';\n          shouldActivateMembership = true;\n        }\n      } else if (transactionStatus === 'settlement') {\n        paymentStatus = 'completed';\n        shouldActivateMembership = true;\n      } else if (transactionStatus === 'cancel' || transactionStatus === 'deny' || transactionStatus === 'expire') {\n        paymentStatus = 'failed';\n      } else if (transactionStatus === 'pending') {\n        paymentStatus = 'pending';\n      }\n\n      // Update payment record with transaction details\n      await storage.updatePaymentStatus(transactionId, paymentStatus);\n\n      // If payment is successful, activate membership\n      if (shouldActivateMembership) {\n        try {\n          // Extract plan ID from the order or get from most recent pending payment for this user\n          const userPayments = await storage.getUserPayments(userId);\n          const pendingPayment = userPayments.find(p => p.status === 'pending' || p.status === 'completed');\n          \n          if (pendingPayment?.membershipId) {\n            // Update existing membership status to active\n            await storage.updateMembershipStatus(pendingPayment.membershipId, 'active');\n          } else {\n            // Create new membership based on payment\n            // This would need to be enhanced to extract plan info from payment description\n            console.log(`Payment successful for user ${userId}, but no membership plan found to activate`);\n          }\n          \n          console.log(`Membership activated for user ${userId} after successful payment`);\n        } catch (error) {\n          console.error(`Error activating membership for user ${userId}:`, error);\n        }\n      }\n\n      res.status(200).json({ message: 'OK' });\n    } catch (error) {\n      console.error(\"Error handling payment notification:\", error);\n      res.status(500).json({ message: \"Failed to handle notification\" });\n    }\n  });\n\n  // Notification check for expiring memberships\n  app.get('/api/notifications/expiring', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.id;\n      const user = await storage.getUser(userId);\n      \n      const expiring = await storage.getExpiringMemberships(20);\n      \n      // For members, only return their own expiring membership\n      if (user?.role !== 'admin') {\n        const userExpiring = expiring.filter(membership => membership.userId === userId);\n        return res.json(userExpiring);\n      }\n      \n      // For admins, return all expiring memberships\n      res.json(expiring);\n    } catch (error) {\n      console.error(\"Error fetching expiring memberships:\", error);\n      res.status(500).json({ message: \"Failed to fetch expiring memberships\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":93007},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/navigation.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dumbbell, Bell, ShieldQuestion, LogOut, Calendar, Home } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport logoPath from \"@assets/image_1759411904981.png\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\ninterface NavigationProps {\n  user: any;\n  isAdmin?: boolean;\n  notificationCount?: number;\n}\n\nexport default function Navigation({ user, isAdmin = false, notificationCount = 0 }: NavigationProps) {\n  const [location] = useLocation();\n\n  const handleLogout = async () => {\n    try {\n      await apiRequest(\"POST\", \"/api/logout\");\n      queryClient.clear();\n      window.location.href = \"/login\";\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n      queryClient.clear();\n      window.location.href = \"/login\";\n    }\n  };\n\n  return (\n    <nav className=\"bg-card shadow-sm border-b border-border\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-center h-16\">\n          {/* Logo and Title */}\n          <div className=\"flex items-center space-x-3 sm:space-x-6\">\n            {isAdmin ? (\n              <div className=\"w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center bg-gradient-to-r from-red-500 to-red-600\">\n                <ShieldQuestion className=\"text-white\" size={18} />\n              </div>\n            ) : (\n              <img \n                src={logoPath} \n                alt=\"Idachi Logo\" \n                className=\"w-8 h-8 sm:w-10 sm:h-10 object-contain\"\n                data-testid=\"img-logo\"\n              />\n            )}\n            <div>\n              <h1 className=\"text-base sm:text-xl font-bold text-yellow-500 dark:text-yellow-400\">\n                {isAdmin ? \"Idachi Fitness Admin\" : \"Idachi Fitness Connect\"}\n              </h1>\n              {isAdmin && (\n                <p className=\"text-xs text-muted-foreground hidden sm:block\">\n                  Management Portal\n                </p>\n              )}\n            </div>\n\n            {/* Navigation Links for Members - Hidden on Mobile */}\n            {!isAdmin && (\n              <div className=\"hidden md:flex items-center space-x-2 ml-8\">\n                <Link href=\"/\">\n                  <Button \n                    variant={location === \"/\" ? \"default\" : \"ghost\"} \n                    size=\"sm\"\n                    className=\"gap-2\"\n                    data-testid=\"link-dashboard\"\n                  >\n                    <Home size={16} />\n                    Dashboard\n                  </Button>\n                </Link>\n                <Link href=\"/my-bookings\">\n                  <Button \n                    variant={location === \"/my-bookings\" ? \"default\" : \"ghost\"} \n                    size=\"sm\"\n                    className=\"gap-2\"\n                    data-testid=\"link-my-bookings\"\n                  >\n                    <Calendar size={16} />\n                    My Bookings\n                  </Button>\n                </Link>\n              </div>\n            )}\n          </div>\n\n          {/* Right side */}\n          <div className=\"flex items-center space-x-2 sm:space-x-4\">\n            {/* Notification Bell - Hidden on Mobile (will be in bottom nav) */}\n            {!isAdmin && (\n              <div className=\"relative hidden md:block\">\n                <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-notifications\">\n                  <Bell size={18} className=\"text-muted-foreground\" />\n                  {notificationCount > 0 && (\n                    <Badge \n                      className=\"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs h-5 w-5 flex items-center justify-center p-0\"\n                      data-testid=\"badge-notification-count\"\n                    >\n                      {notificationCount}\n                    </Badge>\n                  )}\n                </Button>\n              </div>\n            )}\n\n            {isAdmin && (\n              <div className=\"relative\">\n                <Button variant=\"ghost\" size=\"sm\" data-testid=\"button-notifications\">\n                  <Bell size={18} className=\"text-muted-foreground\" />\n                  {notificationCount > 0 && (\n                    <Badge \n                      className=\"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-xs h-5 w-5 flex items-center justify-center p-0\"\n                      data-testid=\"badge-notification-count\"\n                    >\n                      {notificationCount}\n                    </Badge>\n                  )}\n                </Button>\n              </div>\n            )}\n\n            {/* User Menu */}\n            <div className=\"flex items-center space-x-2 sm:space-x-3\">\n              <div className=\"text-right hidden sm:block\">\n                <p className=\"text-sm font-medium text-foreground\" data-testid=\"text-username\">\n                  {`${user.firstName || ''} ${user.lastName || ''}`.trim() || 'User'}\n                </p>\n                <p className=\"text-xs text-muted-foreground\">\n                  {isAdmin ? \"Administrator\" : \"Member\"}\n                </p>\n              </div>\n              \n              <Avatar className=\"h-8 w-8 sm:h-10 sm:w-10\" data-testid=\"img-avatar\">\n                <AvatarImage src={user.profileImageUrl} />\n                <AvatarFallback>\n                  {`${user.firstName?.[0] || ''}${user.lastName?.[0] || ''}` || 'U'}\n                </AvatarFallback>\n              </Avatar>\n\n              <Button \n                variant=\"ghost\" \n                size=\"sm\" \n                onClick={handleLogout}\n                data-testid=\"button-logout\"\n                className=\"hidden sm:flex\"\n              >\n                <LogOut size={16} />\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </nav>\n  );\n}\n","size_bytes":6014},"client/src/components/payment-modal.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { RadioGroup, RadioGroupItem } from \"@/components/ui/radio-group\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { QrCode, CreditCard, Building, Copy, CheckCircle, Clock, AlertCircle } from \"lucide-react\";\nimport * as QRCode from 'qrcode';\n\ninterface PaymentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport default function PaymentModal({ isOpen, onClose }: PaymentModalProps) {\n  const { toast } = useToast();\n  const [selectedPlan, setSelectedPlan] = useState(\"\");\n  const [paymentMethod, setPaymentMethod] = useState(\"qris\");\n  const [selectedBank, setSelectedBank] = useState(\"bca\");\n  const [paymentResult, setPaymentResult] = useState<any>(null);\n  const [step, setStep] = useState(1); // 1: plan & method, 2: payment result\n  const [qrCodeSvg, setQrCodeSvg] = useState<string>(\"\");\n  const [timeLeft, setTimeLeft] = useState<number | null>(null);\n  const [paymentStatus, setPaymentStatus] = useState<string>(\"pending\");\n\n  const { data: membershipPlans } = useQuery({\n    queryKey: [\"/api/membership-plans\"],\n    enabled: isOpen,\n  });\n\n  const qrisPaymentMutation = useMutation({\n    mutationFn: async (planId: string) => {\n      const response = await apiRequest(\"POST\", \"/api/payment/qris\", { planId });\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      setPaymentResult(data);\n      setStep(2);\n      setTimeLeft(15 * 60); // 15 minutes\n      \n      // Generate QR code data URL\n      if (data.qrString) {\n        try {\n          QRCode.toDataURL(data.qrString, {\n            width: 200,\n            margin: 2,\n            color: {\n              dark: '#000000',\n              light: '#ffffff'\n            }\n          }, (err, url) => {\n            if (err) {\n              console.error('Error generating QR code:', err);\n            } else {\n              setQrCodeSvg(url);\n            }\n          });\n        } catch (error) {\n          console.error(\"Error generating QR code:\", error);\n        }\n      }\n      \n      queryClient.invalidateQueries({ queryKey: [\"/api/member/dashboard\"] });\n      toast({\n        title: \"QRIS Generated\",\n        description: \"Scan QR code untuk melakukan pembayaran\",\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: \"Gagal membuat pembayaran QRIS\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const vaPaymentMutation = useMutation({\n    mutationFn: async ({ planId, bankCode }: { planId: string; bankCode: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/payment/va\", { planId, bankCode });\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      setPaymentResult(data);\n      setStep(2);\n      setTimeLeft(24 * 60 * 60); // 24 hours for VA\n      queryClient.invalidateQueries({ queryKey: [\"/api/member/dashboard\"] });\n      toast({\n        title: \"Virtual Account Created\",\n        description: `Transfer ke Virtual Account ${data.bank}`,\n      });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Error\",\n        description: \"Gagal membuat Virtual Account\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleProceedToPayment = () => {\n    if (!selectedPlan) {\n      toast({\n        title: \"Error\",\n        description: \"Pilih paket membership terlebih dahulu\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (paymentMethod === \"qris\") {\n      qrisPaymentMutation.mutate(selectedPlan);\n    } else if (paymentMethod === \"va\") {\n      vaPaymentMutation.mutate({ planId: selectedPlan, bankCode: selectedBank });\n    }\n  };\n\n  const copyToClipboard = (text: string, label: string) => {\n    navigator.clipboard.writeText(text);\n    toast({\n      title: \"Copied!\",\n      description: `${label} berhasil disalin`,\n    });\n  };\n\n  const resetModal = () => {\n    setStep(1);\n    setPaymentResult(null);\n    setSelectedPlan(\"\");\n    setPaymentMethod(\"qris\");\n    setSelectedBank(\"bca\");\n  };\n\n  const handleClose = () => {\n    resetModal();\n    onClose();\n  };\n\n  const plans = membershipPlans || [];\n  const selectedPlanData = plans.find((plan: any) => plan.id === selectedPlan);\n\n  // Countdown timer effect\n  useEffect(() => {\n    if (timeLeft === null) return;\n    \n    if (timeLeft <= 0) {\n      setPaymentStatus('expired');\n      return;\n    }\n\n    const timer = setInterval(() => {\n      setTimeLeft(prev => prev ? prev - 1 : 0);\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [timeLeft]);\n\n  // Status polling effect  \n  useEffect(() => {\n    if (!paymentResult?.orderId || paymentStatus !== 'pending') return;\n\n    const pollInterval = setInterval(async () => {\n      try {\n        const response = await apiRequest('GET', `/api/payment/status/${paymentResult.orderId}`);\n        const statusData = await response.json();\n        \n        if (statusData.status === 'completed') {\n          setPaymentStatus('completed');\n          toast({\n            title: \"Pembayaran Berhasil!\",\n            description: \"Membership Anda telah aktif\",\n          });\n          queryClient.invalidateQueries({ queryKey: [\"/api/member/dashboard\"] });\n          clearInterval(pollInterval);\n        } else if (statusData.status === 'failed' || statusData.status === 'expired') {\n          setPaymentStatus(statusData.status);\n          clearInterval(pollInterval);\n        }\n      } catch (error) {\n        console.error('Error polling payment status:', error);\n      }\n    }, 5000); // Poll every 5 seconds\n\n    return () => clearInterval(pollInterval);\n  }, [paymentResult?.orderId, paymentStatus, toast, queryClient]);\n\n  const formatTime = (seconds: number) => {\n    const hours = Math.floor(seconds / 3600);\n    const minutes = Math.floor((seconds % 3600) / 60);\n    const secs = seconds % 60;\n    \n    if (hours > 0) {\n      return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;\n    }\n    return `${minutes}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  const bankOptions = [\n    { value: \"bca\", label: \"BCA\", name: \"Bank Central Asia\" },\n    { value: \"bni\", label: \"BNI\", name: \"Bank Negara Indonesia\" },\n    { value: \"bri\", label: \"BRI\", name: \"Bank Rakyat Indonesia\" },\n    { value: \"mandiri\", label: \"Mandiri\", name: \"Bank Mandiri\" },\n    { value: \"permata\", label: \"Permata\", name: \"Bank Permata\" },\n  ];\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"w-[95vw] max-w-2xl max-h-[90vh] flex flex-col p-0\" data-testid=\"modal-payment\">\n        <DialogHeader className=\"flex-shrink-0 px-4 sm:px-6 pt-4 sm:pt-6 pb-3 border-b\">\n          <DialogTitle className=\"text-lg sm:text-xl\">\n            {step === 1 ? \"Pilih Paket & Metode Pembayaran\" : \"Informasi Pembayaran\"}\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"overflow-y-auto flex-1 px-4 sm:px-6 py-4 sm:py-6\">\n          <div className=\"space-y-6\">\n          {step === 1 ? (\n            <>\n              {/* Plan Selection */}\n              <div>\n                <Label className=\"text-xs sm:text-sm font-medium text-foreground mb-2 sm:mb-3 block\">Pilih Paket Membership</Label>\n                <RadioGroup value={selectedPlan} onValueChange={setSelectedPlan}>\n                  <div className=\"space-y-3\">\n                    {plans.map((plan: any) => (\n                      <div key={plan.id}>\n                        <RadioGroupItem value={plan.id} id={plan.id} className=\"sr-only\" />\n                        <Label\n                          htmlFor={plan.id}\n                          className={`flex items-center p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors ${\n                            selectedPlan === plan.id ? 'border-primary bg-primary/5 border-2' : 'border-border'\n                          }`}\n                          data-testid={`option-plan-${plan.id}`}\n                        >\n                          <div className=\"flex-1\">\n                            <div className=\"flex justify-between items-center\">\n                              <span className=\"font-medium text-foreground\">{plan.name}</span>\n                              <span className=\"font-bold text-foreground\">Rp {parseInt(plan.price).toLocaleString('id-ID')}/bulan</span>\n                            </div>\n                            <p className=\"text-sm text-muted-foreground\">{plan.description}</p>\n                          </div>\n                        </Label>\n                      </div>\n                    ))}\n                  </div>\n                </RadioGroup>\n              </div>\n\n              {/* Payment Method Selection */}\n              <div>\n                <Label className=\"text-xs sm:text-sm font-medium text-foreground mb-2 sm:mb-3 block\">Metode Pembayaran</Label>\n                <RadioGroup value={paymentMethod} onValueChange={setPaymentMethod}>\n                  <div className=\"space-y-3\">\n                    <div>\n                      <RadioGroupItem value=\"qris\" id=\"qris\" className=\"sr-only\" />\n                      <Label\n                        htmlFor=\"qris\"\n                        className={`flex items-center p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors ${\n                          paymentMethod === \"qris\" ? 'border-primary bg-primary/5 border-2' : 'border-border'\n                        }`}\n                        data-testid=\"option-payment-qris\"\n                      >\n                        <QrCode className=\"text-primary mr-3\" size={20} />\n                        <div className=\"flex-1\">\n                          <span className=\"font-medium text-foreground\">QRIS</span>\n                          <p className=\"text-sm text-muted-foreground\">Scan QR dengan GoPay, DANA, OVO, ShopeePay</p>\n                        </div>\n                      </Label>\n                    </div>\n\n                    <div>\n                      <RadioGroupItem value=\"va\" id=\"va\" className=\"sr-only\" />\n                      <Label\n                        htmlFor=\"va\"\n                        className={`flex items-center p-3 border rounded-lg cursor-pointer hover:bg-accent transition-colors ${\n                          paymentMethod === \"va\" ? 'border-primary bg-primary/5 border-2' : 'border-border'\n                        }`}\n                        data-testid=\"option-payment-va\"\n                      >\n                        <Building className=\"text-primary mr-3\" size={20} />\n                        <div className=\"flex-1\">\n                          <span className=\"font-medium text-foreground\">Virtual Account</span>\n                          <p className=\"text-sm text-muted-foreground\">Transfer bank melalui ATM atau internet banking</p>\n                        </div>\n                      </Label>\n                    </div>\n                  </div>\n                </RadioGroup>\n              </div>\n\n              {/* Bank Selection for VA */}\n              {paymentMethod === \"va\" && (\n                <div>\n                  <Label className=\"text-xs sm:text-sm font-medium text-foreground mb-2 sm:mb-3 block\">Pilih Bank</Label>\n                  <Select value={selectedBank} onValueChange={setSelectedBank}>\n                    <SelectTrigger data-testid=\"select-bank\">\n                      <SelectValue placeholder=\"Pilih bank\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {bankOptions.map((bank) => (\n                        <SelectItem key={bank.value} value={bank.value}>\n                          {bank.label} - {bank.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              )}\n\n              {/* Total */}\n              {selectedPlanData && (\n                <Card className=\"bg-muted\">\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"font-medium text-foreground\">Total</span>\n                      <span className=\"text-2xl font-bold text-foreground\" data-testid=\"text-payment-total\">\n                        Rp {parseInt(selectedPlanData.price).toLocaleString('id-ID')}\n                      </span>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Pembayaran bulanan</p>\n                  </CardContent>\n                </Card>\n              )}\n\n              {/* Action Buttons */}\n              <div className=\"flex flex-col sm:flex-row gap-2 sm:gap-3 pt-2\">\n                <Button\n                  onClick={handleProceedToPayment}\n                  disabled={!selectedPlan || qrisPaymentMutation.isPending || vaPaymentMutation.isPending}\n                  className=\"flex-1 success-gradient text-white text-sm sm:text-base h-10 sm:h-11\"\n                  data-testid=\"button-proceed-payment\"\n                >\n                  {qrisPaymentMutation.isPending || vaPaymentMutation.isPending ? (\n                    \"Memproses...\"\n                  ) : (\n                    <>\n                      {paymentMethod === \"qris\" ? <QrCode size={14} className=\"mr-2\" /> : <Building size={14} className=\"mr-2\" />}\n                      Lanjutkan Pembayaran\n                    </>\n                  )}\n                </Button>\n                \n                <Button\n                  variant=\"outline\"\n                  onClick={handleClose}\n                  className=\"flex-1 text-sm sm:text-base h-10 sm:h-11\"\n                  data-testid=\"button-cancel-payment\"\n                >\n                  Batal\n                </Button>\n              </div>\n            </>\n          ) : (\n            <>\n              {/* Payment Result */}\n              {paymentResult && (\n                <>\n                  {paymentMethod === \"qris\" ? (\n                    <div className=\"text-center space-y-6\">\n                      <div className=\"success-gradient w-16 h-16 rounded-full flex items-center justify-center mx-auto\">\n                        <QrCode className=\"text-white\" size={24} />\n                      </div>\n                      \n                      <div>\n                        <h3 className=\"text-lg font-semibold text-foreground mb-2\">QRIS Pembayaran</h3>\n                        <p className=\"text-muted-foreground\">Scan QR code di bawah dengan aplikasi e-wallet Anda</p>\n                      </div>\n\n                      <Card>\n                        <CardContent className=\"p-6\">\n                          <div className=\"bg-white p-4 rounded border-2 border-dashed border-gray-300 mb-4\">\n                            <div className=\"w-48 h-48 bg-white rounded flex items-center justify-center mx-auto\">\n                              {qrCodeSvg ? (\n                                <img \n                                  src={qrCodeSvg} \n                                  alt=\"QR Code untuk pembayaran\" \n                                  className=\"w-full h-full object-contain\"\n                                  data-testid=\"img-qr-code\"\n                                />\n                              ) : (\n                                <div className=\"text-center\">\n                                  <QrCode size={64} className=\"text-gray-400 mx-auto mb-2\" />\n                                  <p className=\"text-xs text-gray-500\">Generating QR Code...</p>\n                                </div>\n                              )}\n                            </div>\n                            \n                            {timeLeft && paymentStatus === 'pending' && (\n                              <div className=\"flex items-center justify-center mt-3 text-sm text-muted-foreground\">\n                                <Clock size={16} className=\"mr-2\" />\n                                <span>Berlaku selama: {formatTime(timeLeft)}</span>\n                              </div>\n                            )}\n                            \n                            {paymentStatus === 'expired' && (\n                              <div className=\"flex items-center justify-center mt-3 text-sm text-red-600\">\n                                <AlertCircle size={16} className=\"mr-2\" />\n                                <span>QR Code telah kadaluarsa</span>\n                              </div>\n                            )}\n                            \n                            {paymentStatus === 'completed' && (\n                              <div className=\"flex items-center justify-center mt-3 text-sm text-green-600\">\n                                <CheckCircle size={16} className=\"mr-2\" />\n                                <span>Pembayaran berhasil!</span>\n                              </div>\n                            )}\n                          </div>\n                          \n                          <Button\n                            onClick={() => copyToClipboard(paymentResult.qrString, \"QR String\")}\n                            variant=\"outline\"\n                            className=\"w-full\"\n                            data-testid=\"button-copy-qr\"\n                          >\n                            <Copy size={16} className=\"mr-2\" />\n                            Copy QR String\n                          </Button>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  ) : (\n                    <div className=\"text-center space-y-6\">\n                      <div className=\"warning-gradient w-16 h-16 rounded-full flex items-center justify-center mx-auto\">\n                        <Building className=\"text-white\" size={24} />\n                      </div>\n                      \n                      <div>\n                        <h3 className=\"text-lg font-semibold text-foreground mb-2\">Virtual Account {paymentResult.bank}</h3>\n                        <p className=\"text-muted-foreground\">Transfer ke nomor Virtual Account berikut</p>\n                      </div>\n\n                      <Card>\n                        <CardContent className=\"p-6 space-y-4\">\n                          <div className=\"text-center\">\n                            <Label className=\"text-sm text-muted-foreground\">Nomor Virtual Account</Label>\n                            <div className=\"flex items-center justify-center space-x-2 mt-2\">\n                              <span className=\"text-2xl font-mono font-bold text-foreground\" data-testid=\"text-va-number\">\n                                {paymentResult.vaNumber}\n                              </span>\n                              <Button\n                                onClick={() => copyToClipboard(paymentResult.vaNumber, \"Nomor VA\")}\n                                variant=\"outline\"\n                                size=\"sm\"\n                                data-testid=\"button-copy-va\"\n                              >\n                                <Copy size={16} />\n                              </Button>\n                            </div>\n                          </div>\n\n                          <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                            <div>\n                              <Label className=\"text-muted-foreground\">Bank</Label>\n                              <p className=\"font-medium\">{paymentResult.bank}</p>\n                            </div>\n                            <div>\n                              <Label className=\"text-muted-foreground\">Jumlah</Label>\n                              <p className=\"font-medium\">Rp {parseInt(selectedPlanData?.price || '0').toLocaleString('id-ID')}</p>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </div>\n                  )}\n\n                  <div className=\"space-y-3 text-sm text-muted-foreground\">\n                    <div className=\"flex items-start space-x-2\">\n                      <CheckCircle className=\"text-green-500 mt-0.5\" size={16} />\n                      <span>Membership akan aktif otomatis setelah pembayaran berhasil</span>\n                    </div>\n                    <div className=\"flex items-start space-x-2\">\n                      <CheckCircle className=\"text-green-500 mt-0.5\" size={16} />\n                      <span>Anda akan menerima notifikasi konfirmasi pembayaran</span>\n                    </div>\n                  </div>\n\n                  <Button\n                    onClick={handleClose}\n                    className=\"w-full gym-gradient text-white\"\n                    data-testid=\"button-finish-payment\"\n                  >\n                    Selesai\n                  </Button>\n                </>\n              )}\n            </>\n          )}\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":21334},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(__dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(__dirname, \"shared\"),\n      \"@assets\": path.resolve(__dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(__dirname, \"client\"),\n  build: {\n    outDir: path.resolve(__dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"shared/schema.ts":{"content":"import { sql } from 'drizzle-orm';\nimport {\n  index,\n  jsonb,\n  pgTable,\n  timestamp,\n  varchar,\n  integer,\n  text,\n  boolean,\n  decimal,\n  pgEnum,\n} from \"drizzle-orm/pg-core\";\nimport { relations } from \"drizzle-orm\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table.\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table.\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: varchar(\"username\").unique().notNull(),\n  password: varchar(\"password\").notNull(),\n  email: varchar(\"email\").unique().notNull(),\n  firstName: varchar(\"first_name\").notNull(),\n  lastName: varchar(\"last_name\").notNull(),\n  phone: varchar(\"phone\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  permanentQrCode: varchar(\"permanent_qr_code\"),\n  role: varchar(\"role\").default(\"member\"), // member, admin\n  active: boolean(\"active\").default(true), // true = active, false = suspended\n  emailVerified: boolean(\"email_verified\").default(false),\n  verificationCode: varchar(\"verification_code\"),\n  verificationCodeExpiry: timestamp(\"verification_code_expiry\"),\n  stripeCustomerId: varchar(\"stripe_customer_id\"),\n  stripeSubscriptionId: varchar(\"stripe_subscription_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Membership plans\nexport const membershipPlans = pgTable(\"membership_plans\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\").notNull(),\n  description: text(\"description\"),\n  price: decimal(\"price\", { precision: 10, scale: 2 }).notNull(),\n  durationMonths: integer(\"duration_months\").notNull(),\n  features: jsonb(\"features\"),\n  stripePriceId: varchar(\"stripe_price_id\"),\n  active: boolean(\"active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// User memberships\nexport const memberships = pgTable(\"memberships\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  planId: varchar(\"plan_id\").notNull().references(() => membershipPlans.id),\n  startDate: timestamp(\"start_date\").notNull(),\n  endDate: timestamp(\"end_date\").notNull(),\n  status: varchar(\"status\").default(\"active\"), // active, expired, cancelled\n  autoRenewal: boolean(\"auto_renewal\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Gym classes\nexport const gymClasses = pgTable(\"gym_classes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\").notNull(),\n  description: text(\"description\"),\n  instructorName: varchar(\"instructor_name\").notNull(),\n  schedule: varchar(\"schedule\").notNull(), // e.g., \"Mon, Wed, Fri - 7:00 AM\"\n  maxCapacity: integer(\"max_capacity\").notNull(),\n  currentEnrollment: integer(\"current_enrollment\").default(0),\n  active: boolean(\"active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Class bookings\nexport const classBookings = pgTable(\"class_bookings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  classId: varchar(\"class_id\").notNull().references(() => gymClasses.id),\n  bookingDate: timestamp(\"booking_date\").notNull(),\n  status: varchar(\"status\").default(\"booked\"), // booked, attended, cancelled\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Check-ins\nexport const checkIns = pgTable(\"check_ins\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  checkInTime: timestamp(\"check_in_time\").defaultNow(),\n  checkOutTime: timestamp(\"check_out_time\"),\n  qrCode: varchar(\"qr_code\").notNull(),\n  status: varchar(\"status\").default(\"active\"), // active, completed\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Payments\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  membershipId: varchar(\"membership_id\").references(() => memberships.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  currency: varchar(\"currency\").default(\"usd\"),\n  stripePaymentIntentId: varchar(\"stripe_payment_intent_id\"),\n  status: varchar(\"status\").notNull(), // pending, completed, failed, refunded\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Feedback\nexport const feedbacks = pgTable(\"feedbacks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  subject: varchar(\"subject\").notNull(),\n  message: text(\"message\").notNull(),\n  rating: integer(\"rating\"), // 1-5 stars\n  status: varchar(\"status\").default(\"pending\"), // pending, reviewed, resolved\n  adminResponse: text(\"admin_response\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Personal Trainers\nexport const personalTrainers = pgTable(\"personal_trainers\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: varchar(\"name\").notNull(),\n  bio: text(\"bio\"),\n  specialization: varchar(\"specialization\").notNull(),\n  experience: integer(\"experience\"), // years of experience\n  certification: text(\"certification\"),\n  imageUrl: varchar(\"image_url\"),\n  pricePerSession: decimal(\"price_per_session\", { precision: 10, scale: 2 }).notNull(),\n  availability: jsonb(\"availability\"), // Store available days/times\n  active: boolean(\"active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// PT Bookings\nexport const ptBookings = pgTable(\"pt_bookings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  trainerId: varchar(\"trainer_id\").notNull().references(() => personalTrainers.id),\n  bookingDate: timestamp(\"booking_date\").notNull(),\n  duration: integer(\"duration\").default(60), // minutes\n  sessionCount: integer(\"session_count\").notNull().default(1), // number of sessions\n  status: varchar(\"status\").default(\"pending\"), // pending, confirmed, completed, cancelled\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// PT Session Packages (member buys X sessions)\nexport const ptSessionPackages = pgTable(\"pt_session_packages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  trainerId: varchar(\"trainer_id\").notNull().references(() => personalTrainers.id),\n  totalSessions: integer(\"total_sessions\").notNull(), // total sessions bought\n  usedSessions: integer(\"used_sessions\").default(0), // sessions used/attended\n  remainingSessions: integer(\"remaining_sessions\").notNull(), // sessions left\n  pricePerSession: decimal(\"price_per_session\", { precision: 10, scale: 2 }).notNull(),\n  totalPrice: decimal(\"total_price\", { precision: 10, scale: 2 }).notNull(),\n  status: varchar(\"status\").default(\"active\"), // active, completed, expired\n  purchaseDate: timestamp(\"purchase_date\").defaultNow(),\n  expiryDate: timestamp(\"expiry_date\"), // optional expiry\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// PT Session Attendance (tracks each session)\nexport const ptSessionAttendance = pgTable(\"pt_session_attendance\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  packageId: varchar(\"package_id\").notNull().references(() => ptSessionPackages.id),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  trainerId: varchar(\"trainer_id\").notNull().references(() => personalTrainers.id),\n  sessionDate: timestamp(\"session_date\").notNull(),\n  sessionNumber: integer(\"session_number\").notNull(), // which session (1, 2, 3, etc.)\n  status: varchar(\"status\").default(\"scheduled\"), // scheduled, completed, cancelled, no_show\n  checkInTime: timestamp(\"check_in_time\"),\n  checkOutTime: timestamp(\"check_out_time\"),\n  notes: text(\"notes\"),\n  adminConfirmed: boolean(\"admin_confirmed\").default(false),\n  confirmedBy: varchar(\"confirmed_by\"), // admin user id\n  confirmedAt: timestamp(\"confirmed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// One-time QR codes for check-in\nexport const oneTimeQrCodes = pgTable(\"one_time_qr_codes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  qrCode: varchar(\"qr_code\").notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  usedAt: timestamp(\"used_at\"),\n  status: varchar(\"status\").default(\"valid\"), // valid, used, expired\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Password reset tokens\nexport const passwordResetTokens = pgTable(\"password_reset_tokens\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").notNull(),\n  token: varchar(\"token\").notNull().unique(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  usedAt: timestamp(\"used_at\"),\n  status: varchar(\"status\").default(\"valid\"), // valid, used, expired\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Notifications\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  title: varchar(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  type: varchar(\"type\").notNull(), // booking_confirmed, booking_cancelled, membership_expiring, etc.\n  relatedId: varchar(\"related_id\"), // ID of related booking, membership, etc.\n  isRead: boolean(\"is_read\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Push Subscriptions\nexport const pushSubscriptions = pgTable(\"push_subscriptions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  endpoint: text(\"endpoint\").notNull().unique(),\n  p256dh: text(\"p256dh\").notNull(),\n  auth: text(\"auth\").notNull(),\n  userAgent: text(\"user_agent\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  memberships: many(memberships),\n  classBookings: many(classBookings),\n  checkIns: many(checkIns),\n  payments: many(payments),\n  feedbacks: many(feedbacks),\n  ptBookings: many(ptBookings),\n  ptSessionPackages: many(ptSessionPackages),\n  ptSessionAttendance: many(ptSessionAttendance),\n  oneTimeQrCodes: many(oneTimeQrCodes),\n  notifications: many(notifications),\n  pushSubscriptions: many(pushSubscriptions),\n}));\n\nexport const membershipPlansRelations = relations(membershipPlans, ({ many }) => ({\n  memberships: many(memberships),\n}));\n\nexport const membershipsRelations = relations(memberships, ({ one, many }) => ({\n  user: one(users, {\n    fields: [memberships.userId],\n    references: [users.id],\n  }),\n  plan: one(membershipPlans, {\n    fields: [memberships.planId],\n    references: [membershipPlans.id],\n  }),\n  payments: many(payments),\n}));\n\nexport const gymClassesRelations = relations(gymClasses, ({ many }) => ({\n  bookings: many(classBookings),\n}));\n\nexport const classBookingsRelations = relations(classBookings, ({ one }) => ({\n  user: one(users, {\n    fields: [classBookings.userId],\n    references: [users.id],\n  }),\n  gymClass: one(gymClasses, {\n    fields: [classBookings.classId],\n    references: [gymClasses.id],\n  }),\n}));\n\nexport const checkInsRelations = relations(checkIns, ({ one }) => ({\n  user: one(users, {\n    fields: [checkIns.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const paymentsRelations = relations(payments, ({ one }) => ({\n  user: one(users, {\n    fields: [payments.userId],\n    references: [users.id],\n  }),\n  membership: one(memberships, {\n    fields: [payments.membershipId],\n    references: [memberships.id],\n  }),\n}));\n\nexport const feedbacksRelations = relations(feedbacks, ({ one }) => ({\n  user: one(users, {\n    fields: [feedbacks.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const personalTrainersRelations = relations(personalTrainers, ({ many }) => ({\n  bookings: many(ptBookings),\n  sessionPackages: many(ptSessionPackages),\n  sessionAttendance: many(ptSessionAttendance),\n}));\n\nexport const ptBookingsRelations = relations(ptBookings, ({ one }) => ({\n  user: one(users, {\n    fields: [ptBookings.userId],\n    references: [users.id],\n  }),\n  trainer: one(personalTrainers, {\n    fields: [ptBookings.trainerId],\n    references: [personalTrainers.id],\n  }),\n}));\n\nexport const ptSessionPackagesRelations = relations(ptSessionPackages, ({ one, many }) => ({\n  user: one(users, {\n    fields: [ptSessionPackages.userId],\n    references: [users.id],\n  }),\n  trainer: one(personalTrainers, {\n    fields: [ptSessionPackages.trainerId],\n    references: [personalTrainers.id],\n  }),\n  sessions: many(ptSessionAttendance),\n}));\n\nexport const ptSessionAttendanceRelations = relations(ptSessionAttendance, ({ one }) => ({\n  package: one(ptSessionPackages, {\n    fields: [ptSessionAttendance.packageId],\n    references: [ptSessionPackages.id],\n  }),\n  user: one(users, {\n    fields: [ptSessionAttendance.userId],\n    references: [users.id],\n  }),\n  trainer: one(personalTrainers, {\n    fields: [ptSessionAttendance.trainerId],\n    references: [personalTrainers.id],\n  }),\n}));\n\nexport const oneTimeQrCodesRelations = relations(oneTimeQrCodes, ({ one }) => ({\n  user: one(users, {\n    fields: [oneTimeQrCodes.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const passwordResetTokensRelations = relations(passwordResetTokens, ({ one }) => ({\n  user: one(users, {\n    fields: [passwordResetTokens.email],\n    references: [users.email],\n  }),\n}));\n\nexport const notificationsRelations = relations(notifications, ({ one }) => ({\n  user: one(users, {\n    fields: [notifications.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const pushSubscriptionsRelations = relations(pushSubscriptions, ({ one }) => ({\n  user: one(users, {\n    fields: [pushSubscriptions.userId],\n    references: [users.id],\n  }),\n}));\n\n// Insert schemas\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\n// Register schema with validation\nexport const registerSchema = insertUserSchema.omit({\n  role: true,\n  active: true,\n  stripeCustomerId: true,\n  stripeSubscriptionId: true,\n  profileImageUrl: true,\n  emailVerified: true,\n  verificationCode: true,\n  verificationCodeExpiry: true,\n  permanentQrCode: true,\n}).extend({\n  email: z.string().email(\"Email tidak valid\").refine((email) => email.toLowerCase().endsWith(\"@gmail.com\"), {\n    message: \"Email harus menggunakan Gmail (@gmail.com)\",\n  }),\n  phone: z.string().regex(/^[0-9]{9,12}$/, \"Nomor telepon harus 9-12 digit angka\"),\n  password: z.string().min(6, \"Password minimal 6 karakter\"),\n  confirmPassword: z.string(),\n  selfieImage: z.string().min(1, \"Foto selfie wajib diambil\"),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Password tidak cocok\",\n  path: [\"confirmPassword\"],\n});\n\n// Login schema\nexport const loginSchema = z.object({\n  username: z.string().min(1, \"Username diperlukan\"),\n  password: z.string().min(1, \"Password diperlukan\"),\n  rememberMe: z.boolean().optional().default(false),\n});\n\nexport const insertMembershipPlanSchema = createInsertSchema(membershipPlans).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertMembershipSchema = createInsertSchema(memberships).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertGymClassSchema = createInsertSchema(gymClasses).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertClassBookingSchema = createInsertSchema(classBookings).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertCheckInSchema = createInsertSchema(checkIns).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPaymentSchema = createInsertSchema(payments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertFeedbackSchema = createInsertSchema(feedbacks).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPersonalTrainerSchema = createInsertSchema(personalTrainers).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPtBookingSchema = createInsertSchema(ptBookings).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPtSessionPackageSchema = createInsertSchema(ptSessionPackages).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertPtSessionAttendanceSchema = createInsertSchema(ptSessionAttendance).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertOneTimeQrCodeSchema = createInsertSchema(oneTimeQrCodes).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPasswordResetTokenSchema = createInsertSchema(passwordResetTokens).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPushSubscriptionSchema = createInsertSchema(pushSubscriptions).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Forgot password schemas\nexport const forgotPasswordRequestSchema = z.object({\n  email: z.string().email(\"Email tidak valid\"),\n});\n\nexport const resetPasswordSchema = z.object({\n  token: z.string().min(1, \"Token diperlukan\"),\n  newPassword: z.string().min(6, \"Password minimal 6 karakter\"),\n  confirmPassword: z.string(),\n}).refine((data) => data.newPassword === data.confirmPassword, {\n  message: \"Password tidak cocok\",\n  path: [\"confirmPassword\"],\n});\n\n// Email verification schema\nexport const verifyEmailSchema = z.object({\n  email: z.string().email(\"Email tidak valid\"),\n  verificationCode: z.string().length(6, \"Kode verifikasi harus 6 digit\"),\n});\n\n// Cookie Preferences Schema\nexport const cookiePreferencesSchema = z.object({\n  necessary: z.boolean().default(true),\n  analytics: z.boolean().default(false),\n  marketing: z.boolean().default(false),\n  preferences: z.boolean().default(false),\n  consentGiven: z.boolean().default(false),\n  consentDate: z.string().optional(),\n});\n\nexport const cookieSettingsSchema = z.object({\n  theme: z.enum(['light', 'dark', 'system']).default('system'),\n  language: z.enum(['id', 'en']).default('id'),\n  sidebarState: z.enum(['expanded', 'collapsed']).default('expanded'),\n  notificationsEnabled: z.boolean().default(true),\n});\n\n// Types\nexport type UpsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\nexport type RegisterInput = z.infer<typeof registerSchema>;\nexport type LoginInput = z.infer<typeof loginSchema>;\nexport type MembershipPlan = typeof membershipPlans.$inferSelect;\nexport type InsertMembershipPlan = z.infer<typeof insertMembershipPlanSchema>;\nexport type Membership = typeof memberships.$inferSelect;\nexport type InsertMembership = z.infer<typeof insertMembershipSchema>;\nexport type GymClass = typeof gymClasses.$inferSelect;\nexport type InsertGymClass = z.infer<typeof insertGymClassSchema>;\nexport type ClassBooking = typeof classBookings.$inferSelect;\nexport type InsertClassBooking = z.infer<typeof insertClassBookingSchema>;\nexport type CheckIn = typeof checkIns.$inferSelect;\nexport type InsertCheckIn = z.infer<typeof insertCheckInSchema>;\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertPayment = z.infer<typeof insertPaymentSchema>;\nexport type Feedback = typeof feedbacks.$inferSelect;\nexport type InsertFeedback = z.infer<typeof insertFeedbackSchema>;\nexport type PersonalTrainer = typeof personalTrainers.$inferSelect;\nexport type InsertPersonalTrainer = z.infer<typeof insertPersonalTrainerSchema>;\nexport type PtBooking = typeof ptBookings.$inferSelect;\nexport type InsertPtBooking = z.infer<typeof insertPtBookingSchema>;\nexport type PtSessionPackage = typeof ptSessionPackages.$inferSelect;\nexport type InsertPtSessionPackage = z.infer<typeof insertPtSessionPackageSchema>;\nexport type PtSessionAttendance = typeof ptSessionAttendance.$inferSelect;\nexport type InsertPtSessionAttendance = z.infer<typeof insertPtSessionAttendanceSchema>;\nexport type OneTimeQrCode = typeof oneTimeQrCodes.$inferSelect;\nexport type InsertOneTimeQrCode = z.infer<typeof insertOneTimeQrCodeSchema>;\nexport type PasswordResetToken = typeof passwordResetTokens.$inferSelect;\nexport type InsertPasswordResetToken = z.infer<typeof insertPasswordResetTokenSchema>;\nexport type Notification = typeof notifications.$inferSelect;\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type PushSubscription = typeof pushSubscriptions.$inferSelect;\nexport type InsertPushSubscription = z.infer<typeof insertPushSubscriptionSchema>;\nexport type ForgotPasswordRequest = z.infer<typeof forgotPasswordRequestSchema>;\nexport type ResetPasswordInput = z.infer<typeof resetPasswordSchema>;\nexport type VerifyEmailInput = z.infer<typeof verifyEmailSchema>;\nexport type CookiePreferences = z.infer<typeof cookiePreferencesSchema>;\nexport type CookieSettings = z.infer<typeof cookieSettingsSchema>;\n","size_bytes":21638},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        __dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/admin-checkin-modal.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport CheckInNotificationPopup from \"@/components/checkin-notification-popup\";\nimport { QrCode, User, Calendar, CreditCard, Clock, CheckCircle2, Camera, XCircle } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { Html5Qrcode } from \"html5-qrcode\";\n\ninterface AdminCheckInModalProps {\n  open: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n}\n\nexport default function AdminCheckInModal({ open, onClose, onSuccess }: AdminCheckInModalProps) {\n  const { toast } = useToast();\n  const [qrCode, setQrCode] = useState(\"\");\n  const [memberData, setMemberData] = useState<any>(null);\n  const [isScanning, setIsScanning] = useState(false);\n  const [showNotification, setShowNotification] = useState(false);\n  const [notificationData, setNotificationData] = useState<any>(null);\n  const scannerRef = useRef<Html5Qrcode | null>(null);\n  const processingRef = useRef<boolean>(false);\n  const scannerDivId = \"qr-reader\";\n\n  const validateMutation = useMutation({\n    mutationFn: async (code: string) => {\n      const response = await apiRequest(\"POST\", \"/api/admin/checkin/validate\", { qrCode: code });\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      setMemberData(data);\n      \n      // Show notification popup\n      setNotificationData(data);\n      setShowNotification(true);\n      \n      if (data.success) {\n        if (onSuccess) {\n          onSuccess();\n        }\n      }\n      \n      // Stop scanner after scan\n      stopScanner();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Validasi Gagal\",\n        description: error.message || \"QR code tidak valid atau sudah expired\",\n        variant: \"destructive\",\n      });\n      setMemberData(null);\n    },\n  });\n\n\n  const startScanner = async () => {\n    try {\n      setIsScanning(true);\n      \n      if (!scannerRef.current) {\n        scannerRef.current = new Html5Qrcode(scannerDivId);\n      }\n\n      const config = { \n        fps: 10, \n        qrbox: { width: 250, height: 250 },\n        aspectRatio: 1.0\n      };\n\n      await scannerRef.current.start(\n        { facingMode: \"environment\" },\n        config,\n        (decodedText) => {\n          if (processingRef.current) {\n            return;\n          }\n          \n          processingRef.current = true;\n          setQrCode(decodedText);\n          \n          let qrCodeValue = decodedText;\n          if (decodedText.includes('/checkin/verify/')) {\n            const parts = decodedText.split('/checkin/verify/');\n            qrCodeValue = parts[1] || decodedText;\n          } else if (decodedText.includes('/')) {\n            const parts = decodedText.split('/');\n            qrCodeValue = parts[parts.length - 1] || decodedText;\n          }\n          \n          stopScanner();\n          \n          validateMutation.mutate(qrCodeValue);\n        },\n        (errorMessage) => {\n        }\n      );\n    } catch (err: any) {\n      console.error(\"Error starting scanner:\", err);\n      toast({\n        title: \"Error\",\n        description: \"Tidak dapat mengakses kamera. Pastikan izin kamera sudah diberikan.\",\n        variant: \"destructive\",\n      });\n      setIsScanning(false);\n    }\n  };\n\n  const stopScanner = async () => {\n    try {\n      if (scannerRef.current) {\n        const state = await scannerRef.current.getState();\n        if (state === 2) {\n          await scannerRef.current.stop();\n        }\n        await scannerRef.current.clear();\n        setIsScanning(false);\n      }\n    } catch (err) {\n      console.error(\"Error stopping scanner:\", err);\n      setIsScanning(false);\n    }\n  };\n\n  const handleClose = async () => {\n    await stopScanner();\n    setQrCode(\"\");\n    setMemberData(null);\n    processingRef.current = false;\n    onClose();\n  };\n\n\n  useEffect(() => {\n    if (open && !isScanning && !memberData) {\n      processingRef.current = false;\n      \n      const timer = setTimeout(() => {\n        startScanner();\n      }, 100);\n      \n      return () => {\n        clearTimeout(timer);\n        if (scannerRef.current) {\n          stopScanner();\n        }\n      };\n    }\n    \n    return () => {\n      if (scannerRef.current) {\n        stopScanner();\n      }\n    };\n  }, [open, memberData]);\n\n  useEffect(() => {\n    return () => {\n      stopScanner();\n    };\n  }, []);\n\n  const getMembershipStatus = (endDate: Date) => {\n    const now = new Date();\n    const daysUntilExpiry = Math.ceil((new Date(endDate).getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n    \n    if (daysUntilExpiry < 0) return { status: \"Expired\", variant: \"destructive\" as const };\n    if (daysUntilExpiry <= 7) return { status: \"Expiring Soon\", variant: \"destructive\" as const };\n    if (daysUntilExpiry <= 30) return { status: \"Active\", variant: \"default\" as const };\n    return { status: \"Active\", variant: \"default\" as const };\n  };\n\n  return (\n    <>\n      <Dialog open={open} onOpenChange={handleClose}>\n        <DialogContent className=\"sm:max-w-[500px]\" data-testid=\"dialog-admin-checkin\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <QrCode className=\"w-5 h-5\" />\n              Validasi Check-in Member\n            </DialogTitle>\n            <DialogDescription>\n              Scan QR code member untuk validasi check-in\n            </DialogDescription>\n          </DialogHeader>\n\n          <div className=\"space-y-4 py-4\">\n            {!memberData && (\n              <div className=\"space-y-2\">\n                <div className=\"text-sm text-center text-muted-foreground mb-2\">\n                  Arahkan kamera ke QR code member\n                </div>\n                <div \n                  id={scannerDivId} \n                  className=\"w-full border-2 border-dashed border-primary rounded-lg overflow-hidden\"\n                  data-testid=\"div-qr-scanner\"\n                />\n                {isScanning && (\n                  <p className=\"text-xs text-center text-muted-foreground\">\n                    Scanner aktif - mencari QR code...\n                  </p>\n                )}\n              </div>\n            )}\n\n            {memberData && (\n              <div className=\"space-y-4\">\n                {memberData.success ? (\n                  <div className=\"flex flex-col items-center justify-center py-6 bg-green-50 dark:bg-green-950/20 rounded-lg border-2 border-green-500\">\n                    <div className=\"bg-green-500 rounded-full p-4 mb-4\">\n                      <CheckCircle2 className=\"w-12 h-12 text-white\" data-testid=\"icon-success-checkmark\" />\n                    </div>\n                    <h3 className=\"text-2xl font-bold text-green-600 dark:text-green-400\" data-testid=\"text-success-message\">\n                      CHECK-IN BERHASIL\n                    </h3>\n                    <p className=\"text-sm text-muted-foreground mt-2\" data-testid=\"text-checkin-time\">\n                      {format(new Date(memberData.checkInTime), \"HH:mm, dd MMMM yyyy\")}\n                    </p>\n                  </div>\n                ) : (\n                  <div className=\"flex flex-col items-center justify-center py-6 bg-red-50 dark:bg-red-950/20 rounded-lg border-2 border-red-500\">\n                    <div className=\"bg-red-500 rounded-full p-4 mb-4\">\n                      <XCircle className=\"w-12 h-12 text-white\" data-testid=\"icon-fail-cross\" />\n                    </div>\n                    <h3 className=\"text-2xl font-bold text-red-600 dark:text-red-400\" data-testid=\"text-fail-message\">\n                      CHECK-IN GAGAL\n                    </h3>\n                    <p className=\"text-sm text-red-600 dark:text-red-400 mt-2\" data-testid=\"text-fail-reason\">\n                      {memberData.message || \"Belum Terdaftar Membership\"}\n                    </p>\n                  </div>\n                )}\n\n                <div className=\"border border-border rounded-lg p-4 space-y-4 bg-muted/30\">\n                  <div className=\"flex items-center gap-4\">\n                    <Avatar className=\"h-16 w-16\" data-testid=\"img-member-avatar\">\n                      <AvatarImage src={memberData.user?.profileImageUrl} />\n                      <AvatarFallback>\n                        {`${memberData.user?.firstName?.[0] || ''}${memberData.user?.lastName?.[0] || ''}`}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-semibold text-lg\" data-testid=\"text-member-name\">\n                        {memberData.user?.firstName} {memberData.user?.lastName}\n                      </h3>\n                      <p className=\"text-sm text-muted-foreground\" data-testid=\"text-member-email\">\n                        {memberData.user?.email}\n                      </p>\n                    </div>\n                  </div>\n\n                  {memberData.membership ? (\n                    <div className=\"space-y-3 pt-3 border-t border-border\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <CreditCard className=\"w-4 h-4 text-muted-foreground\" />\n                          <span className=\"text-sm font-medium\">Membership</span>\n                        </div>\n                        <Badge \n                          variant={getMembershipStatus(memberData.membership.endDate).variant}\n                          data-testid=\"badge-membership-status\"\n                        >\n                          {memberData.membership.plan.name}\n                        </Badge>\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2\">\n                          <Calendar className=\"w-4 h-4 text-muted-foreground\" />\n                          <span className=\"text-sm font-medium\">Berlaku Hingga</span>\n                        </div>\n                        <span className=\"text-sm\" data-testid=\"text-membership-enddate\">\n                          {format(new Date(memberData.membership.endDate), \"dd MMM yyyy\")}\n                        </span>\n                      </div>\n                    </div>\n                  ) : (\n                    <div className=\"py-3 text-center border-t border-border\">\n                      <Badge variant=\"destructive\">Tidak ada membership aktif</Badge>\n                    </div>\n                  )}\n                </div>\n              </div>\n            )}\n          </div>\n\n          <div className=\"flex justify-end gap-2\">\n            <Button variant=\"outline\" onClick={handleClose} data-testid=\"button-close\">\n              Tutup\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      {/* Notification Popup */}\n      <CheckInNotificationPopup\n        show={showNotification}\n        data={notificationData}\n        onClose={() => {\n          setShowNotification(false);\n          setNotificationData(null);\n        }}\n      />\n    </>\n  );\n}\n","size_bytes":11494},"client/src/pages/register.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { registerSchema } from \"@shared/schema\";\nimport type { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link, useLocation } from \"wouter\";\nimport { Eye, EyeOff, User, Mail, Phone, Lock, UserPlus, ArrowRight, CheckCircle2, Send } from \"lucide-react\";\nimport { Progress } from \"@/components/ui/progress\";\nimport CameraSelfie from \"@/components/CameraSelfie\";\n\ntype RegisterFormData = z.infer<typeof registerSchema>;\n\nexport default function Register() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [emailVerified, setEmailVerified] = useState(false);\n  const [codeSent, setCodeSent] = useState(false);\n  const [isSendingCode, setIsSendingCode] = useState(false);\n  const [verificationCode, setVerificationCode] = useState(\"\");\n\n  const form = useForm<RegisterFormData>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      username: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      selfieImage: \"\",\n    },\n  });\n\n  const password = form.watch(\"password\");\n  const email = form.watch(\"email\");\n\n  const passwordStrength = useMemo(() => {\n    if (!password) return { strength: 0, label: \"\", color: \"\" };\n    \n    let strength = 0;\n    if (password.length >= 6) strength += 25;\n    if (password.length >= 8) strength += 15;\n    if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 20;\n    if (/\\d/.test(password)) strength += 20;\n    if (/[^a-zA-Z0-9]/.test(password)) strength += 20;\n\n    if (strength < 40) return { strength, label: \"Lemah\", color: \"bg-red-500\" };\n    if (strength < 70) return { strength, label: \"Sedang\", color: \"bg-yellow-500\" };\n    return { strength, label: \"Kuat\", color: \"bg-green-500\" };\n  }, [password]);\n\n  const handleSendCode = async () => {\n    if (!email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)) {\n      toast({\n        title: \"Email tidak valid\",\n        description: \"Mohon masukkan email yang valid\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!email.toLowerCase().endsWith(\"@gmail.com\")) {\n      toast({\n        title: \"Email tidak valid\",\n        description: \"Email harus menggunakan Gmail (@gmail.com)\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsSendingCode(true);\n    try {\n      await apiRequest(\"POST\", \"/api/send-verification-code\", { email });\n      setCodeSent(true);\n      toast({\n        title: \"Kode Terkirim!\",\n        description: \"Kode verifikasi telah dikirim ke email Anda\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Gagal Mengirim Kode\",\n        description: error.message || \"Terjadi kesalahan saat mengirim kode verifikasi\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsSendingCode(false);\n    }\n  };\n\n  const handleVerifyCode = async () => {\n    if (!verificationCode || verificationCode.length !== 6) {\n      toast({\n        title: \"Kode tidak valid\",\n        description: \"Mohon masukkan kode verifikasi 6 digit\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    try {\n      await apiRequest(\"POST\", \"/api/check-verification-code\", { \n        email, \n        verificationCode \n      });\n      setEmailVerified(true);\n      toast({\n        title: \"Email Terverifikasi!\",\n        description: \"Silakan lanjutkan mengisi form registrasi\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Verifikasi Gagal\",\n        description: error.message || \"Kode verifikasi tidak valid atau sudah kadaluarsa\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const registerMutation = useMutation({\n    mutationFn: async (data: RegisterFormData) => {\n      return await apiRequest(\"POST\", \"/api/register-verified\", data);\n    },\n    onSuccess: async (response: any) => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      toast({\n        title: \"Registrasi berhasil\",\n        description: \"Selamat datang di Idachi Fitness!\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Registrasi gagal\",\n        description: error.message || \"Terjadi kesalahan saat registrasi\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: RegisterFormData) => {\n    if (!emailVerified) {\n      toast({\n        title: \"Email belum diverifikasi\",\n        description: \"Mohon verifikasi email Anda terlebih dahulu\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    registerMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen w-full bg-gradient-to-br from-yellow-50 via-amber-50 to-orange-100 dark:from-gray-950 dark:via-yellow-950 dark:to-amber-950 relative overflow-hidden\">\n      {/* Animated background elements */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-0 right-0 w-96 h-96 bg-yellow-300/20 dark:bg-yellow-500/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-amber-400/20 dark:bg-amber-500/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n      </div>\n\n      <div className=\"container mx-auto min-h-screen flex items-center justify-center p-4 py-12 relative z-10\">\n        <div className=\"w-full max-w-5xl\">\n          <Card className=\"border-2 border-yellow-200 dark:border-yellow-800/50 shadow-2xl bg-white/90 dark:bg-gray-900/90 backdrop-blur-xl\">\n            <CardHeader className=\"space-y-2 pb-6\">\n              <div className=\"flex justify-center mb-2\">\n                <div className=\"p-4 rounded-2xl bg-gradient-to-br from-yellow-500 to-amber-600 shadow-lg\">\n                  <UserPlus className=\"h-10 w-10 text-white\" />\n                </div>\n              </div>\n              <CardTitle className=\"text-3xl font-bold text-center text-yellow-500 dark:text-yellow-400\">\n                Bergabung dengan Idachi Fitness\n              </CardTitle>\n              <CardDescription className=\"text-center text-base\">\n                Mulai perjalanan fitness Anda hari ini\n              </CardDescription>\n            </CardHeader>\n            \n            <CardContent className=\"space-y-6\">\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                  {/* Name Fields */}\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"firstName\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Nama Depan</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                placeholder=\"John\"\n                                className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                                data-testid=\"input-firstName\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"lastName\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Nama Belakang</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                placeholder=\"Doe\"\n                                className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                                data-testid=\"input-lastName\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  {/* Username */}\n                  <FormField\n                    control={form.control}\n                    name=\"username\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Username</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                            <Input\n                              placeholder=\"johndoe\"\n                              className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-400\"\n                              data-testid=\"input-username\"\n                              {...field}\n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Email Verification Section */}\n                  <div className=\"space-y-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"email\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">\n                            Email (Gmail) \n                            {emailVerified && <CheckCircle2 className=\"inline ml-2 h-4 w-4 text-green-500\" />}\n                          </FormLabel>\n                          <FormControl>\n                            <div className=\"flex gap-2\">\n                              <div className=\"relative flex-1\">\n                                <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                                <Input\n                                  type=\"email\"\n                                  placeholder=\"nama@gmail.com\"\n                                  className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                                  data-testid=\"input-email\"\n                                  disabled={emailVerified}\n                                  {...field}\n                                />\n                              </div>\n                              <Button\n                                type=\"button\"\n                                onClick={handleSendCode}\n                                disabled={isSendingCode || emailVerified || !email}\n                                className=\"h-11 bg-yellow-500 hover:bg-yellow-600 text-white\"\n                                data-testid=\"button-send-code\"\n                              >\n                                {isSendingCode ? (\n                                  <div className=\"h-5 w-5 border-3 border-white/30 border-t-white rounded-full animate-spin\" />\n                                ) : emailVerified ? (\n                                  <CheckCircle2 className=\"h-5 w-5\" />\n                                ) : (\n                                  <Send className=\"h-5 w-5\" />\n                                )}\n                              </Button>\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    {codeSent && !emailVerified && (\n                      <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">Kode Verifikasi</label>\n                        <div className=\"flex gap-2\">\n                          <Input\n                            type=\"text\"\n                            placeholder=\"Masukkan 6 digit kode\"\n                            maxLength={6}\n                            value={verificationCode}\n                            onChange={(e) => setVerificationCode(e.target.value)}\n                            className=\"flex-1 h-11 text-center text-lg tracking-widest font-bold bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                            data-testid=\"input-verification-code\"\n                          />\n                          <Button\n                            type=\"button\"\n                            onClick={handleVerifyCode}\n                            disabled={verificationCode.length !== 6}\n                            className=\"h-11 bg-green-500 hover:bg-green-600 text-white\"\n                            data-testid=\"button-verify-code\"\n                          >\n                            Verifikasi\n                          </Button>\n                        </div>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                          Kode verifikasi berlaku selama 15 menit\n                        </p>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Selfie Photo Section */}\n                  <FormField\n                    control={form.control}\n                    name=\"selfieImage\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">\n                          Foto Selfie <span className=\"text-red-500\">*</span>\n                        </FormLabel>\n                        <FormControl>\n                          <CameraSelfie\n                            onCapture={(imageData) => {\n                              field.onChange(imageData);\n                            }}\n                            capturedImage={field.value}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                          Foto selfie wajib diambil untuk melanjutkan registrasi\n                        </p>\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Phone */}\n                  <div className=\"grid md:grid-cols-1 gap-4\">\n\n                    <FormField\n                      control={form.control}\n                      name=\"phone\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Nomor Telepon</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Phone className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <div className=\"absolute left-10 top-1/2 -translate-y-1/2 text-gray-600 dark:text-gray-400 font-medium pointer-events-none\">\n                                +62\n                              </div>\n                              <Input\n                                type=\"tel\"\n                                placeholder=\"812345678\"\n                                className=\"pl-[4.5rem] h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                                data-testid=\"input-phone\"\n                                {...field}\n                                value={field.value || \"\"}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  {/* Password Fields */}\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Password</FormLabel>\n                        <FormControl>\n                          <div className=\"space-y-2\">\n                            <div className=\"relative\">\n                              <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                type={showPassword ? \"text\" : \"password\"}\n                                placeholder=\"Minimal 6 karakter\"\n                                className=\"pl-10 pr-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-400\"\n                                data-testid=\"input-password\"\n                                {...field}\n                              />\n                              <button\n                                type=\"button\"\n                                onClick={() => setShowPassword(!showPassword)}\n                                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                                data-testid=\"button-toggle-password\"\n                              >\n                                {showPassword ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\n                              </button>\n                            </div>\n                            {password && (\n                              <div className=\"space-y-1\">\n                                <div className=\"flex items-center gap-2\">\n                                  <Progress value={passwordStrength.strength} className=\"h-2 flex-1\" />\n                                  <span className={`text-xs font-medium ${\n                                    passwordStrength.label === \"Kuat\" ? \"text-green-600\" :\n                                    passwordStrength.label === \"Sedang\" ? \"text-yellow-600\" : \"text-red-600\"\n                                  }`}>\n                                    {passwordStrength.label}\n                                  </span>\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Konfirmasi Password</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                            <Input\n                              type={showConfirmPassword ? \"text\" : \"password\"}\n                              placeholder=\"Ketik ulang password\"\n                              className=\"pl-10 pr-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-blue-500 dark:focus:border-blue-400\"\n                              data-testid=\"input-confirmPassword\"\n                              {...field}\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                              data-testid=\"button-toggle-confirm-password\"\n                            >\n                              {showConfirmPassword ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full h-12 bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600 text-white font-semibold text-base shadow-lg shadow-yellow-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-yellow-500/40\"\n                    disabled={registerMutation.isPending}\n                    data-testid=\"button-register\"\n                  >\n                    {registerMutation.isPending ? (\n                      <span className=\"flex items-center gap-2\">\n                        <div className=\"h-5 w-5 border-3 border-white/30 border-t-white rounded-full animate-spin\" />\n                        Mendaftar...\n                      </span>\n                    ) : (\n                      <span className=\"flex items-center gap-2\">\n                        Daftar Sekarang\n                        <ArrowRight className=\"h-5 w-5\" />\n                      </span>\n                    )}\n                  </Button>\n\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-0 flex items-center\">\n                      <div className=\"w-full border-t border-gray-200 dark:border-gray-700\"></div>\n                    </div>\n                    <div className=\"relative flex justify-center text-sm\">\n                      <span className=\"px-4 bg-white dark:bg-gray-900 text-gray-500\">\n                        Sudah punya akun?\n                      </span>\n                    </div>\n                  </div>\n\n                  <div className=\"text-center\">\n                    <Link href=\"/login\" data-testid=\"link-login\">\n                      <Button \n                        variant=\"outline\" \n                        type=\"button\"\n                        className=\"w-full h-11 border-2 border-yellow-300 dark:border-yellow-700 text-yellow-600 dark:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-950 font-semibold\"\n                      >\n                        Login di sini\n                      </Button>\n                    </Link>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":24126},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { loginSchema } from \"@shared/schema\";\nimport type { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link, useLocation } from \"wouter\";\nimport { Eye, EyeOff, User, Lock, Dumbbell, Sparkles, ArrowRight } from \"lucide-react\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport idachiLogo from \"@assets/image_1759411904981.png\";\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function Login() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [showPassword, setShowPassword] = useState(false);\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      rememberMe: false,\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginFormData) => {\n      return await apiRequest(\"POST\", \"/api/login\", data);\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      toast({\n        title: \"Login berhasil\",\n        description: \"Selamat datang kembali!\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Login gagal\",\n        description: error.message || \"Username atau password salah\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginFormData) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen w-full bg-gradient-to-br from-yellow-50 via-amber-50 to-orange-100 dark:from-gray-950 dark:via-yellow-950 dark:to-amber-950 relative overflow-hidden\">\n      {/* Animated background elements */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-0 left-0 w-96 h-96 bg-yellow-300/20 dark:bg-yellow-500/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-0 right-0 w-96 h-96 bg-amber-400/20 dark:bg-amber-500/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n        <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-yellow-200/10 dark:bg-yellow-600/5 rounded-full blur-3xl\"></div>\n      </div>\n\n      <div className=\"container mx-auto min-h-screen flex items-center justify-center p-4 relative z-10\">\n        <div className=\"w-full max-w-6xl grid lg:grid-cols-2 gap-8 items-center\">\n          {/* Left Side - Branding */}\n          <div className=\"hidden lg:flex flex-col justify-center space-y-6 p-8\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"relative\">\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-2xl blur-2xl opacity-60 animate-pulse\"></div>\n                  <img \n                    src={idachiLogo} \n                    alt=\"Idachi Fitness Logo\" \n                    className=\"relative h-20 w-20 object-contain rounded-xl\"\n                  />\n                </div>\n                <h1 className=\"text-5xl font-bold text-yellow-500 dark:text-yellow-400\">\n                  Idachi Fitness\n                </h1>\n              </div>\n              \n              <h2 className=\"text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white leading-tight\">\n                Wujudkan Tubuh Impian Anda\n              </h2>\n              \n              <p className=\"text-lg text-gray-700 dark:text-gray-300\">\n                Bergabunglah dengan ribuan member yang telah mencapai target fitness mereka bersama kami.\n              </p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"flex items-start gap-3 p-4 rounded-xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-yellow-200 dark:border-yellow-800/50 shadow-lg\">\n                <div className=\"p-2 rounded-lg bg-yellow-400/20 dark:bg-yellow-500/20\">\n                  <Dumbbell className=\"h-5 w-5 text-yellow-600 dark:text-yellow-400\" />\n                </div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 dark:text-white\">Akses Unlimited</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Gym equipment terlengkap 24/7</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-3 p-4 rounded-xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-sm border border-amber-200 dark:border-amber-800/50 shadow-lg\">\n                <div className=\"p-2 rounded-lg bg-amber-400/20 dark:bg-amber-500/20\">\n                  <Sparkles className=\"h-5 w-5 text-amber-600 dark:text-amber-400\" />\n                </div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 dark:text-white\">Personal Trainer</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Bimbingan profesional untuk hasil maksimal</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Right Side - Login Form */}\n          <div className=\"w-full\">\n            <Card className=\"border-2 border-yellow-200 dark:border-yellow-800/50 shadow-2xl bg-white/90 dark:bg-gray-900/90 backdrop-blur-xl\">\n              <CardHeader className=\"space-y-2 pb-6\">\n                <div className=\"lg:hidden flex justify-center mb-4\">\n                  <img \n                    src={idachiLogo} \n                    alt=\"Idachi Fitness Logo\" \n                    className=\"h-16 w-16 object-contain rounded-xl\"\n                    data-testid=\"img-logo\"\n                  />\n                </div>\n                <CardTitle className=\"text-3xl font-bold text-center text-gray-900 dark:text-white\">\n                  Selamat Datang Kembali\n                </CardTitle>\n                <CardDescription className=\"text-center text-base\">\n                  Login untuk melanjutkan perjalanan fitness Anda\n                </CardDescription>\n              </CardHeader>\n              \n              <CardContent className=\"space-y-6\">\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                    <FormField\n                      control={form.control}\n                      name=\"username\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Email/Nomor Telepon/Username</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                placeholder=\"Masukkan email, nomor telepon, atau username\"\n                                className=\"pl-10 h-12 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                                data-testid=\"input-username\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"password\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Password</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                type={showPassword ? \"text\" : \"password\"}\n                                placeholder=\"Masukkan password\"\n                                className=\"pl-10 pr-10 h-12 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                                data-testid=\"input-password\"\n                                {...field}\n                              />\n                              <button\n                                type=\"button\"\n                                onClick={() => setShowPassword(!showPassword)}\n                                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                                data-testid=\"button-toggle-password\"\n                              >\n                                {showPassword ? (\n                                  <EyeOff className=\"h-5 w-5\" />\n                                ) : (\n                                  <Eye className=\"h-5 w-5\" />\n                                )}\n                              </button>\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"flex items-center justify-between\">\n                      <FormField\n                        control={form.control}\n                        name=\"rememberMe\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex items-center space-x-2\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                                className=\"border-gray-400 data-[state=checked]:bg-yellow-500 data-[state=checked]:border-yellow-500\"\n                                data-testid=\"checkbox-remember\"\n                              />\n                            </FormControl>\n                            <FormLabel className=\"text-sm text-gray-600 dark:text-gray-400 font-normal cursor-pointer\">\n                              Remember Me\n                            </FormLabel>\n                          </FormItem>\n                        )}\n                      />\n                      <Link \n                        href=\"/forgot-password\" \n                        className=\"text-sm text-yellow-600 dark:text-yellow-400 hover:text-yellow-700 dark:hover:text-yellow-300 font-medium transition-colors\"\n                        data-testid=\"link-forgot-password\"\n                      >\n                        Lupa Password?\n                      </Link>\n                    </div>\n\n                    <Button\n                      type=\"submit\"\n                      className=\"w-full h-12 bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600 text-white font-semibold text-base shadow-lg shadow-yellow-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-yellow-500/40\"\n                      disabled={loginMutation.isPending}\n                      data-testid=\"button-login\"\n                    >\n                      {loginMutation.isPending ? (\n                        <span className=\"flex items-center gap-2\">\n                          <div className=\"h-5 w-5 border-3 border-white/30 border-t-white rounded-full animate-spin\" />\n                          Memproses...\n                        </span>\n                      ) : (\n                        <span className=\"flex items-center gap-2\">\n                          Login\n                          <ArrowRight className=\"h-5 w-5\" />\n                        </span>\n                      )}\n                    </Button>\n                  </form>\n                </Form>\n\n                <div className=\"relative\">\n                  <div className=\"absolute inset-0 flex items-center\">\n                    <div className=\"w-full border-t border-gray-200 dark:border-gray-700\"></div>\n                  </div>\n                  <div className=\"relative flex justify-center text-sm\">\n                    <span className=\"px-4 bg-white dark:bg-gray-900 text-gray-500\">\n                      Belum punya akun?\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"text-center\">\n                  <Link href=\"/register\" data-testid=\"link-register\">\n                    <Button \n                      variant=\"outline\" \n                      className=\"w-full h-12 border-2 border-yellow-300 dark:border-yellow-700 text-yellow-600 dark:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-950 font-semibold\"\n                    >\n                      Daftar Sekarang\n                    </Button>\n                  </Link>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":13590},"server/auth.ts":{"content":"import type { Express } from \"express\";\nimport session from \"express-session\";\nimport passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport bcrypt from \"bcryptjs\";\nimport { storage } from \"./storage\";\nimport type { User } from \"@shared/schema\";\nimport connectPgSimple from \"connect-pg-simple\";\nimport { pool } from \"./db\";\n\nconst PgSession = connectPgSimple(session);\n\nexport async function setupAuth(app: Express) {\n  // Require SESSION_SECRET in production for security\n  const sessionSecret = process.env.SESSION_SECRET;\n  \n  if (!sessionSecret) {\n    if (process.env.NODE_ENV === \"production\") {\n      throw new Error(\"SESSION_SECRET environment variable is required in production for secure session management\");\n    }\n    console.warn(\"âš ï¸  WARNING: Using default SESSION_SECRET in development. Set SESSION_SECRET env var for production!\");\n  }\n\n  // Session setup\n  app.use(\n    session({\n      store: new PgSession({\n        pool,\n        tableName: \"sessions\",\n        createTableIfMissing: false,\n      }),\n      secret: sessionSecret || \"dev-secret-change-in-production\",\n      resave: false,\n      saveUninitialized: false,\n      cookie: {\n        maxAge: 30 * 24 * 60 * 60 * 1000, // 30 days\n        httpOnly: true,\n        secure: process.env.NODE_ENV === \"production\",\n      },\n    })\n  );\n\n  // Initialize passport\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // Local strategy - supports login with email, phone, or username\n  passport.use(\n    new LocalStrategy(async (username, password, done) => {\n      try {\n        // Try to find user by username, email, or phone\n        const user = await storage.getUserByEmailOrPhoneOrUsername(username);\n        \n        if (!user) {\n          return done(null, false, { message: \"Email/Nomor Telepon/Username atau password salah\" });\n        }\n\n        const isValid = await bcrypt.compare(password, user.password);\n        \n        if (!isValid) {\n          return done(null, false, { message: \"Email/Nomor Telepon/Username atau password salah\" });\n        }\n\n        // Check if email is verified (skip for admin users)\n        if (user.role !== 'admin' && !user.emailVerified) {\n          return done(null, false, { message: \"Email belum diverifikasi. Silakan cek email Anda untuk kode verifikasi\" });\n        }\n\n        return done(null, user);\n      } catch (error) {\n        return done(error);\n      }\n    })\n  );\n\n  // Serialize user\n  passport.serializeUser((user: any, done) => {\n    done(null, user.id);\n  });\n\n  // Deserialize user\n  passport.deserializeUser(async (id: string, done) => {\n    try {\n      const user = await storage.getUser(id);\n      done(null, user);\n    } catch (error) {\n      done(error);\n    }\n  });\n}\n\n// Middleware to check if user is authenticated\nexport function isAuthenticated(req: any, res: any, next: any) {\n  if (req.isAuthenticated()) {\n    return next();\n  }\n  res.status(401).json({ message: \"Unauthorized\" });\n}\n\n// Middleware to check if user is admin\nexport function isAdmin(req: any, res: any, next: any) {\n  if (req.isAuthenticated() && req.user?.role === 'admin') {\n    return next();\n  }\n  res.status(403).json({ message: \"Admin access required\" });\n}\n","size_bytes":3232},"client/src/pages/register-admin.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link, useLocation } from \"wouter\";\nimport { Eye, EyeOff, User, Mail, Phone, Lock, ShieldCheck, ArrowRight, Key } from \"lucide-react\";\nimport { z } from \"zod\";\nimport { Progress } from \"@/components/ui/progress\";\n\nconst registerAdminSchema = z.object({\n  adminSecretKey: z.string().min(1, \"Admin secret key diperlukan\"),\n  firstName: z.string().min(1, \"Nama depan diperlukan\"),\n  lastName: z.string().min(1, \"Nama belakang diperlukan\"),\n  username: z.string().min(3, \"Username minimal 3 karakter\"),\n  email: z.string().email(\"Email tidak valid\"),\n  phone: z.string().optional(),\n  password: z.string().min(6, \"Password minimal 6 karakter\"),\n  confirmPassword: z.string().min(6, \"Konfirmasi password diperlukan\"),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"Password tidak cocok\",\n  path: [\"confirmPassword\"],\n});\n\ntype RegisterFormData = z.infer<typeof registerAdminSchema>;\n\nexport default function RegisterAdmin() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [showSecretKey, setShowSecretKey] = useState(false);\n\n  const form = useForm<RegisterFormData>({\n    resolver: zodResolver(registerAdminSchema),\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      username: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      adminSecretKey: \"\",\n    },\n  });\n\n  const password = form.watch(\"password\");\n\n  const passwordStrength = useMemo(() => {\n    if (!password) return { strength: 0, label: \"\", color: \"\" };\n    \n    let strength = 0;\n    if (password.length >= 6) strength += 25;\n    if (password.length >= 8) strength += 15;\n    if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength += 20;\n    if (/\\d/.test(password)) strength += 20;\n    if (/[^a-zA-Z0-9]/.test(password)) strength += 20;\n\n    if (strength < 40) return { strength, label: \"Lemah\", color: \"bg-red-500\" };\n    if (strength < 70) return { strength, label: \"Sedang\", color: \"bg-yellow-500\" };\n    return { strength, label: \"Kuat\", color: \"bg-green-500\" };\n  }, [password]);\n\n  const registerMutation = useMutation({\n    mutationFn: async (data: RegisterFormData) => {\n      return await apiRequest(\"POST\", \"/api/register-admin\", data);\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      toast({\n        title: \"Registrasi Admin Berhasil\",\n        description: \"Selamat datang di admin panel!\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Registrasi Gagal\",\n        description: error.message || \"Terjadi kesalahan saat registrasi\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: RegisterFormData) => {\n    registerMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen w-full bg-gradient-to-br from-red-50 via-white to-orange-50 dark:from-gray-950 dark:via-gray-900 dark:to-red-950\">\n      <div className=\"container mx-auto min-h-screen flex items-center justify-center p-4 py-12\">\n        <div className=\"w-full max-w-5xl\">\n          <Card className=\"border-2 border-red-200 dark:border-red-900 shadow-2xl bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl\">\n            <CardHeader className=\"space-y-2 pb-6\">\n              <div className=\"flex justify-center mb-2\">\n                <div className=\"p-4 rounded-2xl bg-gradient-to-br from-red-600 to-orange-600 shadow-lg\">\n                  <ShieldCheck className=\"h-10 w-10 text-white\" />\n                </div>\n              </div>\n              <CardTitle className=\"text-3xl font-bold text-center bg-gradient-to-r from-red-600 to-orange-600 dark:from-red-400 dark:to-orange-400 bg-clip-text text-transparent\">\n                Registrasi Admin\n              </CardTitle>\n              <CardDescription className=\"text-center text-base\">\n                Buat akun admin dengan akses khusus\n              </CardDescription>\n            </CardHeader>\n            \n            <CardContent className=\"space-y-6\">\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                  {/* Admin Secret Key */}\n                  <FormField\n                    control={form.control}\n                    name=\"adminSecretKey\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Admin Secret Key</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Key className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                            <Input\n                              type={showSecretKey ? \"text\" : \"password\"}\n                              placeholder=\"Masukkan admin secret key\"\n                              className=\"pl-10 pr-10 h-12 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                              data-testid=\"input-adminSecretKey\"\n                              {...field}\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => setShowSecretKey(!showSecretKey)}\n                              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                            >\n                              {showSecretKey ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormDescription className=\"text-xs\">\n                          Default key: admin123 (dapat diubah via ADMIN_SECRET_KEY env var)\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Name Fields */}\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"firstName\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Nama Depan</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                placeholder=\"John\"\n                                className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-firstName\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"lastName\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Nama Belakang</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                placeholder=\"Doe\"\n                                className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-lastName\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  {/* Username */}\n                  <FormField\n                    control={form.control}\n                    name=\"username\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Username</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                            <Input\n                              placeholder=\"admin\"\n                              className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                              data-testid=\"input-username\"\n                              {...field}\n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  {/* Email & Phone */}\n                  <div className=\"grid md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"email\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Email</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Mail className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                type=\"email\"\n                                placeholder=\"admin@example.com\"\n                                className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-email\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"phone\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Nomor Telepon</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Phone className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                type=\"tel\"\n                                placeholder=\"08123456789\"\n                                className=\"pl-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-phone\"\n                                {...field}\n                                value={field.value || \"\"}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  {/* Password Fields */}\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Password</FormLabel>\n                        <FormControl>\n                          <div className=\"space-y-2\">\n                            <div className=\"relative\">\n                              <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                type={showPassword ? \"text\" : \"password\"}\n                                placeholder=\"Minimal 6 karakter\"\n                                className=\"pl-10 pr-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-password\"\n                                {...field}\n                              />\n                              <button\n                                type=\"button\"\n                                onClick={() => setShowPassword(!showPassword)}\n                                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                                data-testid=\"button-toggle-password\"\n                              >\n                                {showPassword ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\n                              </button>\n                            </div>\n                            {password && (\n                              <div className=\"space-y-1\">\n                                <div className=\"flex items-center gap-2\">\n                                  <Progress value={passwordStrength.strength} className=\"h-2 flex-1\" />\n                                  <span className={`text-xs font-medium ${\n                                    passwordStrength.label === \"Kuat\" ? \"text-green-600\" :\n                                    passwordStrength.label === \"Sedang\" ? \"text-yellow-600\" : \"text-red-600\"\n                                  }`}>\n                                    {passwordStrength.label}\n                                  </span>\n                                </div>\n                              </div>\n                            )}\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Konfirmasi Password</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                            <Input\n                              type={showConfirmPassword ? \"text\" : \"password\"}\n                              placeholder=\"Ketik ulang password\"\n                              className=\"pl-10 pr-10 h-11 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                              data-testid=\"input-confirmPassword\"\n                              {...field}\n                            />\n                            <button\n                              type=\"button\"\n                              onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                              data-testid=\"button-toggle-confirm-password\"\n                            >\n                              {showConfirmPassword ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full h-12 bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white font-semibold text-base shadow-lg shadow-red-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-red-500/40\"\n                    disabled={registerMutation.isPending}\n                    data-testid=\"button-register-admin\"\n                  >\n                    {registerMutation.isPending ? (\n                      <span className=\"flex items-center gap-2\">\n                        <div className=\"h-5 w-5 border-3 border-white/30 border-t-white rounded-full animate-spin\" />\n                        Membuat Akun...\n                      </span>\n                    ) : (\n                      <span className=\"flex items-center gap-2\">\n                        Buat Akun Admin\n                        <ArrowRight className=\"h-5 w-5\" />\n                      </span>\n                    )}\n                  </Button>\n\n                  <div className=\"relative\">\n                    <div className=\"absolute inset-0 flex items-center\">\n                      <div className=\"w-full border-t border-gray-200 dark:border-gray-700\"></div>\n                    </div>\n                    <div className=\"relative flex justify-center text-sm\">\n                      <span className=\"px-4 bg-white dark:bg-gray-900 text-gray-500\">\n                        Sudah punya akun?\n                      </span>\n                    </div>\n                  </div>\n\n                  <div className=\"text-center\">\n                    <Link href=\"/login-admin\" data-testid=\"link-login\">\n                      <Button \n                        variant=\"outline\" \n                        type=\"button\"\n                        className=\"w-full h-11 border-2 border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950 font-semibold\"\n                      >\n                        Login sebagai Admin\n                      </Button>\n                    </Link>\n                  </div>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":19560},"client/src/pages/login-admin.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { loginSchema } from \"@shared/schema\";\nimport type { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link, useLocation } from \"wouter\";\nimport { Eye, EyeOff, User, Lock, ShieldCheck, ArrowRight, Shield } from \"lucide-react\";\n\ntype LoginFormData = z.infer<typeof loginSchema>;\n\nexport default function LoginAdmin() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [showPassword, setShowPassword] = useState(false);\n\n  const form = useForm<LoginFormData>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n    },\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async (data: LoginFormData) => {\n      return await apiRequest(\"POST\", \"/api/login\", data);\n    },\n    onSuccess: async (response: any) => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      \n      if (response.user && response.user.role !== 'admin') {\n        toast({\n          title: \"Akses Ditolak\",\n          description: \"Halaman ini khusus untuk administrator\",\n          variant: \"destructive\",\n        });\n        setLocation(\"/\");\n        return;\n      }\n      \n      toast({\n        title: \"Login Admin Berhasil\",\n        description: \"Selamat datang kembali, Administrator!\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Login Gagal\",\n        description: error.message || \"Username atau password salah\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: LoginFormData) => {\n    loginMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen w-full bg-gradient-to-br from-red-50 via-white to-orange-50 dark:from-gray-950 dark:via-gray-900 dark:to-red-950\">\n      <div className=\"container mx-auto min-h-screen flex items-center justify-center p-4\">\n        <div className=\"w-full max-w-6xl grid lg:grid-cols-2 gap-8 items-center\">\n          {/* Left Side - Admin Branding */}\n          <div className=\"hidden lg:flex flex-col justify-center space-y-6 p-8\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"relative\">\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-red-500 to-orange-500 rounded-2xl blur-2xl opacity-40 animate-pulse\"></div>\n                  <div className=\"relative p-4 bg-gradient-to-br from-red-600 to-orange-600 rounded-2xl\">\n                    <ShieldCheck className=\"h-12 w-12 text-white\" />\n                  </div>\n                </div>\n                <h1 className=\"text-4xl font-bold bg-gradient-to-r from-red-600 to-orange-600 dark:from-red-400 dark:to-orange-400 bg-clip-text text-transparent\">\n                  Admin Panel\n                </h1>\n              </div>\n              \n              <h2 className=\"text-3xl lg:text-4xl font-bold text-gray-900 dark:text-white leading-tight\">\n                Kelola Gym dengan Mudah\n              </h2>\n              \n              <p className=\"text-lg text-gray-600 dark:text-gray-400\">\n                Akses penuh untuk mengelola member, kelas, transaksi, dan semua aspek gym Anda.\n              </p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div className=\"flex items-start gap-3 p-4 rounded-xl bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700\">\n                <div className=\"p-2 rounded-lg bg-red-500/10\">\n                  <Shield className=\"h-5 w-5 text-red-600 dark:text-red-400\" />\n                </div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 dark:text-white\">Akses Aman</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Dashboard khusus dengan keamanan tingkat tinggi</p>\n                </div>\n              </div>\n\n              <div className=\"flex items-start gap-3 p-4 rounded-xl bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border border-gray-200 dark:border-gray-700\">\n                <div className=\"p-2 rounded-lg bg-orange-500/10\">\n                  <ShieldCheck className=\"h-5 w-5 text-orange-600 dark:text-orange-400\" />\n                </div>\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 dark:text-white\">Kontrol Penuh</h3>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Kelola semua aspek operasional gym</p>\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* Right Side - Login Form */}\n          <div className=\"w-full\">\n            <Card className=\"border-2 border-red-200 dark:border-red-900 shadow-2xl bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl\">\n              <CardHeader className=\"space-y-2 pb-6\">\n                <div className=\"lg:hidden flex justify-center mb-4\">\n                  <div className=\"p-4 bg-gradient-to-br from-red-600 to-orange-600 rounded-2xl\">\n                    <ShieldCheck className=\"h-10 w-10 text-white\" />\n                  </div>\n                </div>\n                <CardTitle className=\"text-3xl font-bold text-center bg-gradient-to-r from-red-600 to-orange-600 dark:from-red-400 dark:to-orange-400 bg-clip-text text-transparent\">\n                  Admin Login\n                </CardTitle>\n                <CardDescription className=\"text-center text-base\">\n                  Akses khusus untuk administrator\n                </CardDescription>\n              </CardHeader>\n              \n              <CardContent className=\"space-y-6\">\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                    <FormField\n                      control={form.control}\n                      name=\"username\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Email/Nomor Telepon/Username Admin</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                placeholder=\"Masukkan email, nomor telepon, atau username admin\"\n                                className=\"pl-10 h-12 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-username\"\n                                {...field}\n                              />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"password\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Password</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                              <Input\n                                type={showPassword ? \"text\" : \"password\"}\n                                placeholder=\"Masukkan password\"\n                                className=\"pl-10 pr-10 h-12 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-red-500 dark:focus:border-red-400\"\n                                data-testid=\"input-password\"\n                                {...field}\n                              />\n                              <button\n                                type=\"button\"\n                                onClick={() => setShowPassword(!showPassword)}\n                                className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors\"\n                                data-testid=\"button-toggle-password\"\n                              >\n                                {showPassword ? (\n                                  <EyeOff className=\"h-5 w-5\" />\n                                ) : (\n                                  <Eye className=\"h-5 w-5\" />\n                                )}\n                              </button>\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <Button\n                      type=\"submit\"\n                      className=\"w-full h-12 bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white font-semibold text-base shadow-lg shadow-red-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-red-500/40\"\n                      disabled={loginMutation.isPending}\n                      data-testid=\"button-login\"\n                    >\n                      {loginMutation.isPending ? (\n                        <span className=\"flex items-center gap-2\">\n                          <div className=\"h-5 w-5 border-3 border-white/30 border-t-white rounded-full animate-spin\" />\n                          Memproses...\n                        </span>\n                      ) : (\n                        <span className=\"flex items-center gap-2\">\n                          Login sebagai Admin\n                          <ArrowRight className=\"h-5 w-5\" />\n                        </span>\n                      )}\n                    </Button>\n                  </form>\n                </Form>\n\n                <div className=\"relative\">\n                  <div className=\"absolute inset-0 flex items-center\">\n                    <div className=\"w-full border-t border-gray-200 dark:border-gray-700\"></div>\n                  </div>\n                  <div className=\"relative flex justify-center text-sm\">\n                    <span className=\"px-4 bg-white dark:bg-gray-900 text-gray-500\">\n                      Belum punya akun admin?\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"text-center\">\n                  <Link href=\"/register-admin\" data-testid=\"link-register-admin\">\n                    <Button \n                      variant=\"outline\" \n                      className=\"w-full h-12 border-2 border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950 font-semibold\"\n                    >\n                      Daftar Admin Baru\n                    </Button>\n                  </Link>\n                </div>\n\n                <div className=\"text-center\">\n                  <Link \n                    href=\"/login\" \n                    data-testid=\"link-member-login\"\n                    className=\"text-sm text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors\"\n                  >\n                    â† Kembali ke Login Member\n                  </Link>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":11997},"client/src/components/feedback-modal.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Star } from \"lucide-react\";\n\nconst feedbackSchema = z.object({\n  subject: z.string().min(1, \"Subject is required\"),\n  message: z.string().min(10, \"Message must be at least 10 characters\"),\n  rating: z.number().min(1).max(5).optional(),\n});\n\ntype FeedbackFormData = z.infer<typeof feedbackSchema>;\n\ninterface FeedbackModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport default function FeedbackModal({ open, onOpenChange }: FeedbackModalProps) {\n  const { toast } = useToast();\n  const [rating, setRating] = useState(0);\n  const [hoverRating, setHoverRating] = useState(0);\n\n  const form = useForm<FeedbackFormData>({\n    resolver: zodResolver(feedbackSchema),\n    defaultValues: {\n      subject: \"\",\n      message: \"\",\n      rating: undefined,\n    },\n  });\n\n  const feedbackMutation = useMutation({\n    mutationFn: async (data: FeedbackFormData) => {\n      return await apiRequest(\"POST\", \"/api/feedbacks\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/feedbacks\"] });\n      toast({\n        title: \"Feedback Submitted\",\n        description: \"Thank you for your feedback!\",\n      });\n      form.reset();\n      setRating(0);\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Failed to Submit\",\n        description: error.message || \"Something went wrong\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: FeedbackFormData) => {\n    feedbackMutation.mutate({\n      ...data,\n      rating: rating || undefined,\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <DialogHeader>\n          <DialogTitle>Send Feedback</DialogTitle>\n          <DialogDescription>\n            Share your thoughts, suggestions, or report issues\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"subject\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Subject</FormLabel>\n                  <FormControl>\n                    <Input\n                      placeholder=\"Brief description\"\n                      data-testid=\"input-subject\"\n                      {...field}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"message\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Message</FormLabel>\n                  <FormControl>\n                    <Textarea\n                      placeholder=\"Tell us more about your feedback...\"\n                      className=\"min-h-[120px]\"\n                      data-testid=\"textarea-message\"\n                      {...field}\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"space-y-2\">\n              <FormLabel>Rating (Optional)</FormLabel>\n              <div className=\"flex gap-1\">\n                {[1, 2, 3, 4, 5].map((star) => (\n                  <button\n                    key={star}\n                    type=\"button\"\n                    onClick={() => setRating(star)}\n                    onMouseEnter={() => setHoverRating(star)}\n                    onMouseLeave={() => setHoverRating(0)}\n                    className=\"focus:outline-none\"\n                    data-testid={`button-star-${star}`}\n                  >\n                    <Star\n                      className={`h-8 w-8 transition-colors ${\n                        star <= (hoverRating || rating)\n                          ? \"fill-yellow-400 text-yellow-400\"\n                          : \"text-gray-300\"\n                      }`}\n                    />\n                  </button>\n                ))}\n              </div>\n              {rating > 0 && (\n                <p className=\"text-sm text-muted-foreground\">{rating} out of 5 stars</p>\n              )}\n            </div>\n\n            <div className=\"flex gap-2 justify-end\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel\"\n              >\n                Cancel\n              </Button>\n              <Button\n                type=\"submit\"\n                disabled={feedbackMutation.isPending}\n                data-testid=\"button-submit-feedback\"\n              >\n                {feedbackMutation.isPending ? \"Submitting...\" : \"Submit Feedback\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":5657},"client/src/components/admin-pt-dialog.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Loader2 } from \"lucide-react\";\nimport type { PersonalTrainer } from \"@shared/schema\";\n\nconst trainerSchema = z.object({\n  name: z.string().min(1, \"Nama diperlukan\"),\n  bio: z.string().optional(),\n  specialization: z.string().min(1, \"Spesialisasi diperlukan\"),\n  experience: z.string().optional(),\n  certification: z.string().optional(),\n  imageUrl: z.string().url(\"URL gambar tidak valid\").optional().or(z.literal(\"\")),\n  pricePerSession: z.string().min(1, \"Harga per sesi diperlukan\"),\n});\n\ntype TrainerFormData = z.infer<typeof trainerSchema>;\n\ninterface AdminPTDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  trainer?: PersonalTrainer | null;\n}\n\nexport default function AdminPTDialog({ open, onOpenChange, trainer }: AdminPTDialogProps) {\n  const { toast } = useToast();\n  const isEditing = !!trainer;\n\n  const form = useForm<TrainerFormData>({\n    resolver: zodResolver(trainerSchema),\n    defaultValues: {\n      name: \"\",\n      bio: \"\",\n      specialization: \"\",\n      experience: \"\",\n      certification: \"\",\n      imageUrl: \"\",\n      pricePerSession: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (trainer) {\n      form.reset({\n        name: trainer.name || \"\",\n        bio: trainer.bio || \"\",\n        specialization: trainer.specialization || \"\",\n        experience: trainer.experience?.toString() || \"\",\n        certification: trainer.certification || \"\",\n        imageUrl: trainer.imageUrl || \"\",\n        pricePerSession: trainer.pricePerSession?.toString() || \"\",\n      });\n    } else {\n      form.reset({\n        name: \"\",\n        bio: \"\",\n        specialization: \"\",\n        experience: \"\",\n        certification: \"\",\n        imageUrl: \"\",\n        pricePerSession: \"\",\n      });\n    }\n  }, [trainer, form]);\n\n  const createMutation = useMutation({\n    mutationFn: async (data: TrainerFormData) => {\n      const payload = {\n        ...data,\n        experience: data.experience ? parseInt(data.experience) : undefined,\n        pricePerSession: parseFloat(data.pricePerSession),\n      };\n      return await apiRequest(\"POST\", \"/api/admin/trainers\", payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/trainers\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trainers\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Personal trainer berhasil ditambahkan\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menambahkan personal trainer\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: TrainerFormData) => {\n      const payload = {\n        ...data,\n        experience: data.experience ? parseInt(data.experience) : undefined,\n        pricePerSession: parseFloat(data.pricePerSession),\n      };\n      return await apiRequest(\"PUT\", `/api/admin/trainers/${trainer?.id}`, payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/trainers\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trainers\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Personal trainer berhasil diupdate\",\n      });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal mengupdate personal trainer\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: TrainerFormData) => {\n    if (isEditing) {\n      updateMutation.mutate(data);\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{isEditing ? \"Edit Personal Trainer\" : \"Tambah Personal Trainer\"}</DialogTitle>\n          <DialogDescription>\n            {isEditing ? \"Update informasi personal trainer\" : \"Isi form di bawah untuk menambah personal trainer baru\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Nama Lengkap *</FormLabel>\n                  <FormControl>\n                    <Input \n                      placeholder=\"Contoh: John Doe\" \n                      {...field} \n                      data-testid=\"input-trainer-name\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"specialization\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Spesialisasi *</FormLabel>\n                  <FormControl>\n                    <Input \n                      placeholder=\"Contoh: Strength Training, Yoga, Cardio\" \n                      {...field} \n                      data-testid=\"input-trainer-specialization\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"bio\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Deskripsi / Bio</FormLabel>\n                  <FormControl>\n                    <Textarea \n                      placeholder=\"Ceritakan tentang pengalaman dan keahlian trainer...\"\n                      rows={4}\n                      {...field} \n                      data-testid=\"input-trainer-bio\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"experience\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Pengalaman (tahun)</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        placeholder=\"5\" \n                        {...field} \n                        data-testid=\"input-trainer-experience\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"pricePerSession\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Harga per Sesi (USD) *</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        step=\"0.01\"\n                        placeholder=\"50.00\" \n                        {...field} \n                        data-testid=\"input-trainer-price\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"certification\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Sertifikasi</FormLabel>\n                  <FormControl>\n                    <Input \n                      placeholder=\"Contoh: NASM CPT, ACE, ISSA\" \n                      {...field} \n                      data-testid=\"input-trainer-certification\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"imageUrl\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>URL Foto Profil</FormLabel>\n                  <FormControl>\n                    <Input \n                      type=\"url\"\n                      placeholder=\"https://example.com/photo.jpg\" \n                      {...field} \n                      data-testid=\"input-trainer-image\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end space-x-2 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel-trainer\"\n              >\n                Batal\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"gym-gradient text-white\"\n                disabled={createMutation.isPending || updateMutation.isPending}\n                data-testid=\"button-submit-trainer\"\n              >\n                {(createMutation.isPending || updateMutation.isPending) && (\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                )}\n                {isEditing ? \"Update\" : \"Tambah Trainer\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":10253},"client/src/components/admin-class-dialog.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Loader2 } from \"lucide-react\";\nimport type { GymClass } from \"@shared/schema\";\n\nconst classSchema = z.object({\n  name: z.string().min(1, \"Nama class diperlukan\"),\n  description: z.string().optional(),\n  instructorName: z.string().min(1, \"Nama instruktur diperlukan\"),\n  schedule: z.string().min(1, \"Jadwal diperlukan\"),\n  maxCapacity: z.string().min(1, \"Kapasitas maksimum diperlukan\"),\n});\n\ntype ClassFormData = z.infer<typeof classSchema>;\n\ninterface AdminClassDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  gymClass?: GymClass | null;\n}\n\nexport default function AdminClassDialog({ open, onOpenChange, gymClass }: AdminClassDialogProps) {\n  const { toast } = useToast();\n  const isEditing = !!gymClass;\n\n  const form = useForm<ClassFormData>({\n    resolver: zodResolver(classSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      instructorName: \"\",\n      schedule: \"\",\n      maxCapacity: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (gymClass) {\n      form.reset({\n        name: gymClass.name || \"\",\n        description: gymClass.description || \"\",\n        instructorName: gymClass.instructorName || \"\",\n        schedule: gymClass.schedule || \"\",\n        maxCapacity: gymClass.maxCapacity?.toString() || \"\",\n      });\n    } else {\n      form.reset({\n        name: \"\",\n        description: \"\",\n        instructorName: \"\",\n        schedule: \"\",\n        maxCapacity: \"\",\n      });\n    }\n  }, [gymClass, form]);\n\n  const createMutation = useMutation({\n    mutationFn: async (data: ClassFormData) => {\n      const payload = {\n        ...data,\n        maxCapacity: parseInt(data.maxCapacity),\n        currentEnrollment: 0,\n        active: true,\n      };\n      return await apiRequest(\"POST\", \"/api/admin/classes\", payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/classes\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/classes\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Class berhasil ditambahkan\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menambahkan class\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: ClassFormData) => {\n      const payload = {\n        ...data,\n        maxCapacity: parseInt(data.maxCapacity),\n      };\n      return await apiRequest(\"PUT\", `/api/admin/classes/${gymClass?.id}`, payload);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/classes\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/classes\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Class berhasil diupdate\",\n      });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal mengupdate class\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ClassFormData) => {\n    if (isEditing) {\n      updateMutation.mutate(data);\n    } else {\n      createMutation.mutate(data);\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{isEditing ? \"Edit Gym Class\" : \"Tambah Gym Class\"}</DialogTitle>\n          <DialogDescription>\n            {isEditing ? \"Update informasi gym class\" : \"Isi form di bawah untuk menambah gym class baru\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Nama Class *</FormLabel>\n                  <FormControl>\n                    <Input \n                      placeholder=\"Contoh: Yoga Beginner, HIIT Training\" \n                      {...field} \n                      data-testid=\"input-class-name\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"instructorName\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Nama Instruktur *</FormLabel>\n                  <FormControl>\n                    <Input \n                      placeholder=\"Contoh: Sarah Johnson\" \n                      {...field} \n                      data-testid=\"input-class-instructor\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Deskripsi</FormLabel>\n                  <FormControl>\n                    <Textarea \n                      placeholder=\"Deskripsikan class ini...\"\n                      rows={3}\n                      {...field} \n                      data-testid=\"input-class-description\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"schedule\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Jadwal *</FormLabel>\n                    <FormControl>\n                      <Input \n                        placeholder=\"Mon, Wed - 7:00 AM\" \n                        {...field} \n                        data-testid=\"input-class-schedule\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"maxCapacity\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Kapasitas Maksimum *</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        placeholder=\"20\" \n                        {...field} \n                        data-testid=\"input-class-capacity\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"flex justify-end space-x-2 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => onOpenChange(false)}\n                data-testid=\"button-cancel-class\"\n              >\n                Batal\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"gym-gradient text-white\"\n                disabled={createMutation.isPending || updateMutation.isPending}\n                data-testid=\"button-submit-class\"\n              >\n                {(createMutation.isPending || updateMutation.isPending) && (\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                )}\n                {isEditing ? \"Update\" : \"Tambah Class\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":8446},"client/src/pages/my-bookings.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { Card } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport BottomNavigation from \"@/components/ui/bottom-navigation\";\nimport { format } from \"date-fns\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Calendar, Clock, User, Dumbbell, X, ChevronRight, AlertCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n\ninterface ClassBookingWithClass {\n  id: string;\n  userId: string;\n  classId: string;\n  bookingDate: string;\n  status: string;\n  createdAt: string;\n  gymClass: {\n    id: string;\n    name: string;\n    description?: string;\n    instructorName: string;\n    schedule: string;\n    maxCapacity: number;\n    currentEnrollment: number;\n  };\n}\n\ninterface PtBookingWithTrainer {\n  id: string;\n  userId: string;\n  trainerId: string;\n  bookingDate: string;\n  duration: number;\n  status: string;\n  notes?: string;\n  createdAt: string;\n  trainer: {\n    id: string;\n    name: string;\n    specialization: string;\n    pricePerSession: string;\n  };\n}\n\nexport default function MyBookings() {\n  const { user, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const [activeTab, setActiveTab] = useState(\"classes\");\n\n  const { data: classBookings, isLoading: loadingClasses } = useQuery<ClassBookingWithClass[]>({\n    queryKey: [\"/api/class-bookings\"],\n    enabled: isAuthenticated,\n  });\n\n  const { data: ptBookings, isLoading: loadingPT } = useQuery<PtBookingWithTrainer[]>({\n    queryKey: [\"/api/pt-bookings\"],\n    enabled: isAuthenticated,\n  });\n\n  const { data: notifications } = useQuery<any[]>({\n    queryKey: [\"/api/notifications\"],\n    enabled: isAuthenticated,\n  });\n\n  const notificationCount = notifications?.filter(n => !n.isRead).length || 0;\n\n  const cancelClassMutation = useMutation({\n    mutationFn: async (bookingId: string) => {\n      await apiRequest(\"PUT\", `/api/class-bookings/${bookingId}/cancel`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/class-bookings\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/classes\"] });\n      toast({ title: \"Success\", description: \"Class booking cancelled\" });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to cancel booking\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const cancelPTMutation = useMutation({\n    mutationFn: async (bookingId: string) => {\n      await apiRequest(\"PUT\", `/api/pt-bookings/${bookingId}/cancel`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/pt-bookings\"] });\n      toast({ title: \"Success\", description: \"PT session cancelled\" });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to cancel PT session\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleCancelClass = (bookingId: string) => {\n    if (confirm(\"Cancel this class booking?\")) {\n      cancelClassMutation.mutate(bookingId);\n    }\n  };\n\n  const handleCancelPT = (bookingId: string) => {\n    if (confirm(\"Cancel this PT session?\")) {\n      cancelPTMutation.mutate(bookingId);\n    }\n  };\n\n  const getStatusBadge = (status: string) => {\n    const variants: Record<string, { variant: \"default\" | \"destructive\" | \"secondary\" | \"outline\", label: string, color: string }> = {\n      booked: { variant: \"default\", label: \"Booked\", color: \"bg-neon-green/10 text-neon-green border-neon-green/20\" },\n      confirmed: { variant: \"default\", label: \"Confirmed\", color: \"bg-neon-green/10 text-neon-green border-neon-green/20\" },\n      cancelled: { variant: \"destructive\", label: \"Cancelled\", color: \"bg-red-500/10 text-red-500 border-red-500/20\" },\n      attended: { variant: \"secondary\", label: \"Attended\", color: \"bg-muted text-muted-foreground border-border\" },\n      completed: { variant: \"secondary\", label: \"Completed\", color: \"bg-muted text-muted-foreground border-border\" },\n      pending: { variant: \"outline\", label: \"Pending\", color: \"bg-yellow-500/10 text-yellow-600 dark:text-yellow-500 border-yellow-500/20\" },\n    };\n\n    const config = variants[status] || { variant: \"outline\" as const, label: status, color: \"\" };\n    return (\n      <Badge variant={config.variant} className={cn(\"text-xs font-semibold border\", config.color)}>\n        {config.label}\n      </Badge>\n    );\n  };\n\n  if (loadingClasses || loadingPT) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"flex flex-col items-center gap-3\">\n          <div className=\"w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin\" />\n          <p className=\"text-sm text-muted-foreground font-medium\">Loading bookings...</p>\n        </div>\n      </div>\n    );\n  }\n\n  const activeClasses = classBookings?.filter(b => b.status === 'booked' || b.status === 'confirmed') || [];\n  const activePT = ptBookings?.filter(b => b.status === 'booked' || b.status === 'confirmed') || [];\n\n  return (\n    <div className=\"min-h-screen bg-background pb-20\">\n      {/* Header */}\n      <header className=\"bg-gradient-to-br from-primary/15 via-neon-purple/10 to-background border-b border-border sticky top-0 z-10 backdrop-blur-xl shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 py-6\">\n          <h1 className=\"text-2xl font-bold text-foreground mb-1\">My Bookings</h1>\n          <p className=\"text-sm text-muted-foreground font-medium\">\n            {activeClasses.length + activePT.length} active bookings\n          </p>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"max-w-7xl mx-auto px-4 py-6\">\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-6 bg-muted/50 p-1 rounded-2xl\">\n            <TabsTrigger \n              value=\"classes\" \n              className=\"rounded-xl data-[state=active]:bg-card data-[state=active]:shadow-sm font-semibold\"\n              data-testid=\"tab-classes\"\n            >\n              <Dumbbell className=\"h-4 w-4 mr-2\" />\n              Classes ({classBookings?.length || 0})\n            </TabsTrigger>\n            <TabsTrigger \n              value=\"pt\" \n              className=\"rounded-xl data-[state=active]:bg-card data-[state=active]:shadow-sm font-semibold\"\n              data-testid=\"tab-pt\"\n            >\n              <User className=\"h-4 w-4 mr-2\" />\n              PT Sessions ({ptBookings?.length || 0})\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Class Bookings */}\n          <TabsContent value=\"classes\" className=\"space-y-3 mt-0\">\n            {!classBookings || classBookings.length === 0 ? (\n              <Card className=\"p-8 text-center border-border bg-card shadow-sm\">\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"p-4 bg-muted rounded-full border border-border\">\n                    <Dumbbell className=\"h-8 w-8 text-muted-foreground\" />\n                  </div>\n                  <div>\n                    <p className=\"font-semibold text-foreground mb-1\">No Class Bookings</p>\n                    <p className=\"text-sm text-muted-foreground font-medium\">\n                      Book your first class to get started!\n                    </p>\n                  </div>\n                </div>\n              </Card>\n            ) : (\n              classBookings.map((booking) => (\n                <Card \n                  key={booking.id} \n                  className={cn(\n                    \"p-5 border-border transition-all hover:shadow-md shadow-sm\",\n                    booking.status === 'cancelled' ? \"bg-muted/30 opacity-60\" : \"bg-card\"\n                  )}\n                  data-testid={`booking-class-${booking.id}`}\n                >\n                  <div className=\"flex items-start justify-between gap-3\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <div className=\"p-2 bg-neon-purple/15 dark:bg-neon-purple/10 rounded-xl border border-neon-purple/20\">\n                          <Dumbbell className=\"h-4 w-4 text-neon-purple\" />\n                        </div>\n                        <h3 className=\"font-bold text-foreground\">{booking.gymClass.name}</h3>\n                      </div>\n                      \n                      <div className=\"space-y-2 ml-10\">\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <User className=\"h-3.5 w-3.5\" />\n                          <span>{booking.gymClass.instructorName}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <Calendar className=\"h-3.5 w-3.5\" />\n                          <span>{format(new Date(booking.bookingDate), \"MMM dd, yyyy\")}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          <span>{booking.gymClass.schedule}</span>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center gap-2 mt-4\">\n                        {getStatusBadge(booking.status)}\n                        {booking.status === 'booked' || booking.status === 'confirmed' ? (\n                          <button\n                            onClick={() => handleCancelClass(booking.id)}\n                            disabled={cancelClassMutation.isPending}\n                            className=\"flex items-center gap-1 text-xs text-red-500 hover:text-red-600 font-medium transition-colors\"\n                            data-testid={`button-cancel-class-${booking.id}`}\n                          >\n                            <X className=\"h-3.5 w-3.5\" />\n                            Cancel\n                          </button>\n                        ) : null}\n                      </div>\n                    </div>\n                    <ChevronRight className=\"h-5 w-5 text-muted-foreground flex-shrink-0 mt-2\" />\n                  </div>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n\n          {/* PT Bookings */}\n          <TabsContent value=\"pt\" className=\"space-y-3 mt-0\">\n            {!ptBookings || ptBookings.length === 0 ? (\n              <Card className=\"p-8 text-center border-border bg-card shadow-sm\">\n                <div className=\"flex flex-col items-center gap-4\">\n                  <div className=\"p-4 bg-muted rounded-full border border-border\">\n                    <User className=\"h-8 w-8 text-muted-foreground\" />\n                  </div>\n                  <div>\n                    <p className=\"font-semibold text-foreground mb-1\">No PT Sessions</p>\n                    <p className=\"text-sm text-muted-foreground font-medium\">\n                      Book a personal trainer session today!\n                    </p>\n                  </div>\n                </div>\n              </Card>\n            ) : (\n              ptBookings.map((booking) => (\n                <Card \n                  key={booking.id} \n                  className={cn(\n                    \"p-5 border-border transition-all hover:shadow-md shadow-sm\",\n                    booking.status === 'cancelled' ? \"bg-muted/30 opacity-60\" : \"bg-card\"\n                  )}\n                  data-testid={`booking-pt-${booking.id}`}\n                >\n                  <div className=\"flex items-start justify-between gap-3\">\n                    <div className=\"flex-1\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <div className=\"p-2 bg-neon-green/15 dark:bg-neon-green/10 rounded-xl border border-neon-green/20\">\n                          <User className=\"h-4 w-4 text-neon-green\" />\n                        </div>\n                        <h3 className=\"font-bold text-foreground\">{booking.trainer.name}</h3>\n                      </div>\n                      \n                      <div className=\"space-y-2 ml-10\">\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <Dumbbell className=\"h-3.5 w-3.5\" />\n                          <span>{booking.trainer.specialization}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <Calendar className=\"h-3.5 w-3.5\" />\n                          <span>{format(new Date(booking.bookingDate), \"MMM dd, yyyy\")}</span>\n                        </div>\n                        <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                          <Clock className=\"h-3.5 w-3.5\" />\n                          <span>{booking.duration} minutes</span>\n                        </div>\n                        {booking.notes && (\n                          <div className=\"flex items-start gap-2 text-sm text-muted-foreground\">\n                            <AlertCircle className=\"h-3.5 w-3.5 mt-0.5 flex-shrink-0\" />\n                            <span className=\"line-clamp-2\">{booking.notes}</span>\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"flex items-center gap-2 mt-4\">\n                        {getStatusBadge(booking.status)}\n                        {booking.status === 'booked' || booking.status === 'confirmed' ? (\n                          <button\n                            onClick={() => handleCancelPT(booking.id)}\n                            disabled={cancelPTMutation.isPending}\n                            className=\"flex items-center gap-1 text-xs text-red-500 hover:text-red-600 font-medium transition-colors\"\n                            data-testid={`button-cancel-pt-${booking.id}`}\n                          >\n                            <X className=\"h-3.5 w-3.5\" />\n                            Cancel\n                          </button>\n                        ) : null}\n                      </div>\n                    </div>\n                    <ChevronRight className=\"h-5 w-5 text-muted-foreground flex-shrink-0 mt-2\" />\n                  </div>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n        </Tabs>\n      </main>\n\n      {/* Bottom Navigation */}\n      <BottomNavigation notificationCount={notificationCount} />\n    </div>\n  );\n}\n","size_bytes":14868},"client/src/components/ui/bottom-navigation.tsx":{"content":"import { Home, Calendar, Bell, User } from \"lucide-react\";\nimport { Link, useLocation } from \"wouter\";\nimport ProfileSheet from \"@/components/ui/profile-sheet\";\nimport NotificationsSheet from \"@/components/ui/notifications-sheet\";\nimport { useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface BottomNavigationProps {\n  notificationCount?: number;\n}\n\nexport default function BottomNavigation({ notificationCount = 0 }: BottomNavigationProps) {\n  const [location] = useLocation();\n  const [showProfileSheet, setShowProfileSheet] = useState(false);\n  const [showNotificationsSheet, setShowNotificationsSheet] = useState(false);\n\n  const navItems = [\n    {\n      icon: Home,\n      label: \"Home\",\n      href: \"/\",\n      active: location === \"/\",\n      testId: \"bottom-nav-home\",\n      type: \"link\" as const,\n    },\n    {\n      icon: Calendar,\n      label: \"Bookings\",\n      href: \"/my-bookings\",\n      active: location === \"/my-bookings\",\n      testId: \"bottom-nav-bookings\",\n      type: \"link\" as const,\n    },\n    {\n      icon: Bell,\n      label: \"Notifications\",\n      href: \"#\",\n      active: false,\n      testId: \"bottom-nav-notifications\",\n      type: \"button\" as const,\n      badge: notificationCount,\n    },\n    {\n      icon: User,\n      label: \"Profile\",\n      href: \"#\",\n      active: showProfileSheet,\n      testId: \"bottom-nav-profile\",\n      type: \"profile\" as const,\n    }\n  ];\n\n  return (\n    <nav className=\"md:hidden fixed bottom-0 left-0 right-0 bg-gradient-to-t from-background via-background to-background/95 backdrop-blur-2xl border-t-2 border-primary/20 shadow-[0_-4px_20px_rgba(0,0,0,0.15)] z-50 pb-safe\">\n      {/* Top accent line */}\n      <div className=\"absolute top-0 left-0 right-0 h-[2px] bg-gradient-to-r from-transparent via-primary to-transparent\" />\n      \n      <div className=\"grid grid-cols-4 h-[72px] px-3 gap-1\">\n        {navItems.map((item) => {\n          const Icon = item.icon;\n          const isActive = item.active;\n          \n          // Profile sheet\n          if (item.type === \"profile\") {\n            return (\n              <ProfileSheet \n                key={item.testId}\n                open={showProfileSheet} \n                onOpenChange={setShowProfileSheet}\n              >\n                <button\n                  className={cn(\n                    \"flex flex-col items-center justify-center gap-1.5 relative rounded-2xl transition-all duration-300 h-full\",\n                    \"active:scale-95\",\n                    isActive ? \"bg-primary/10 shadow-lg shadow-primary/20\" : \"hover:bg-muted/30\"\n                  )}\n                  data-testid={item.testId}\n                >\n                  {isActive && (\n                    <div className=\"absolute top-1 left-1/2 -translate-x-1/2 w-8 h-1 bg-primary rounded-full\" />\n                  )}\n                  <div className={cn(\n                    \"relative p-3 rounded-2xl transition-all duration-300\",\n                    isActive \n                      ? \"bg-gradient-to-br from-primary to-neon-purple shadow-lg\" \n                      : \"bg-muted/50\"\n                  )}>\n                    <Icon className={cn(\n                      \"h-6 w-6 transition-colors duration-300\",\n                      isActive ? \"text-white\" : \"text-muted-foreground\"\n                    )} />\n                  </div>\n                  <span className={cn(\n                    \"text-[11px] font-bold transition-colors duration-300\",\n                    isActive ? \"text-primary\" : \"text-muted-foreground\"\n                  )}>\n                    {item.label}\n                  </span>\n                </button>\n              </ProfileSheet>\n            );\n          }\n          \n          // Notifications sheet\n          if (item.type === \"button\") {\n            return (\n              <NotificationsSheet\n                key={item.testId}\n                open={showNotificationsSheet}\n                onOpenChange={setShowNotificationsSheet}\n              >\n                <button\n                  className={cn(\n                    \"flex flex-col items-center justify-center gap-1.5 relative rounded-2xl transition-all duration-300 h-full\",\n                    \"active:scale-95\",\n                    showNotificationsSheet ? \"bg-primary/10 shadow-lg shadow-primary/20\" : \"hover:bg-muted/30\"\n                  )}\n                  data-testid={item.testId}\n                >\n                  {showNotificationsSheet && (\n                    <div className=\"absolute top-1 left-1/2 -translate-x-1/2 w-8 h-1 bg-primary rounded-full\" />\n                  )}\n                  <div className={cn(\n                    \"relative p-3 rounded-2xl transition-all duration-300\",\n                    showNotificationsSheet \n                      ? \"bg-gradient-to-br from-primary to-neon-purple shadow-lg\" \n                      : \"bg-muted/50\"\n                  )}>\n                    <Icon className={cn(\n                      \"h-6 w-6 transition-colors duration-300\",\n                      showNotificationsSheet ? \"text-white\" : \"text-muted-foreground\"\n                    )} />\n                    {item.badge && item.badge > 0 && (\n                      <div className=\"absolute -top-1.5 -right-1.5 min-w-[20px] h-[20px] bg-gradient-to-br from-neon-green to-green-600 rounded-full flex items-center justify-center animate-scale-in shadow-lg border-2 border-background\">\n                        <span className=\"text-[10px] font-bold text-white px-1\">\n                          {item.badge > 9 ? '9+' : item.badge}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                  <span className={cn(\n                    \"text-[11px] font-bold transition-colors duration-300\",\n                    showNotificationsSheet ? \"text-primary\" : \"text-muted-foreground\"\n                  )}>\n                    {item.label}\n                  </span>\n                </button>\n              </NotificationsSheet>\n            );\n          }\n          \n          // Regular links\n          return (\n            <Link \n              key={item.testId}\n              href={item.href}\n              className={cn(\n                \"flex flex-col items-center justify-center gap-1.5 relative rounded-2xl transition-all duration-300 h-full\",\n                \"active:scale-95\",\n                isActive ? \"bg-primary/10 shadow-lg shadow-primary/20\" : \"hover:bg-muted/30\"\n              )}\n              data-testid={item.testId}\n            >\n              {isActive && (\n                <div className=\"absolute top-1 left-1/2 -translate-x-1/2 w-8 h-1 bg-primary rounded-full\" />\n              )}\n              <div className={cn(\n                \"relative p-3 rounded-2xl transition-all duration-300\",\n                isActive \n                  ? \"bg-gradient-to-br from-primary to-neon-purple shadow-lg\" \n                  : \"bg-muted/50\"\n              )}>\n                <Icon className={cn(\n                  \"h-6 w-6 transition-colors duration-300\",\n                  isActive ? \"text-white\" : \"text-muted-foreground\"\n                )} />\n              </div>\n              <span className={cn(\n                \"text-[11px] font-bold transition-colors duration-300\",\n                isActive ? \"text-primary\" : \"text-muted-foreground\"\n              )}>\n                {item.label}\n              </span>\n            </Link>\n          );\n        })}\n      </div>\n    </nav>\n  );\n}\n","size_bytes":7446},"client/src/components/ui/profile-sheet.tsx":{"content":"import { LogOut, User, Settings, HelpCircle, FileText, ChevronRight } from \"lucide-react\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetHeader,\n  SheetTitle,\n  SheetTrigger,\n} from \"@/components/ui/sheet\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport PushNotificationToggle from \"@/components/push-notification-toggle\";\nimport { cn } from \"@/lib/utils\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface ProfileSheetProps {\n  children: React.ReactNode;\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n}\n\nexport default function ProfileSheet({ children, open, onOpenChange }: ProfileSheetProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n\n  const logoutMutation = useMutation({\n    mutationFn: () => apiRequest(\"POST\", \"/api/logout\"),\n    onSuccess: () => {\n      window.location.href = \"/\";\n    },\n  });\n\n  const handleMenuClick = (action: string) => {\n    switch (action) {\n      case \"profile\":\n        toast({\n          title: \"My Profile\",\n          description: \"Profile page coming soon!\",\n        });\n        setTimeout(() => onOpenChange?.(false), 300);\n        break;\n      case \"settings\":\n        toast({\n          title: \"Settings\",\n          description: \"Settings page coming soon!\",\n        });\n        setTimeout(() => onOpenChange?.(false), 300);\n        break;\n      case \"terms\":\n        toast({\n          title: \"Terms & Conditions\",\n          description: \"Please contact admin for terms and conditions information.\",\n        });\n        setTimeout(() => onOpenChange?.(false), 300);\n        break;\n      case \"help\":\n        toast({\n          title: \"Help & Support\",\n          description: \"Need help? Contact us at support@idachifitness.com\",\n        });\n        setTimeout(() => onOpenChange?.(false), 300);\n        break;\n      default:\n        break;\n    }\n  };\n\n  const menuItems = [\n    {\n      icon: User,\n      label: \"My Profile\",\n      action: \"profile\",\n      testId: \"menu-profile\",\n      color: \"text-neon-green\"\n    },\n    {\n      icon: Settings,\n      label: \"Settings\",\n      action: \"settings\",\n      testId: \"menu-settings\",\n      color: \"text-muted-foreground\"\n    },\n    {\n      icon: FileText,\n      label: \"Terms & Conditions\",\n      action: \"terms\",\n      testId: \"menu-terms\",\n      color: \"text-muted-foreground\"\n    },\n    {\n      icon: HelpCircle,\n      label: \"Help & Support\",\n      action: \"help\",\n      testId: \"menu-help\",\n      color: \"text-muted-foreground\"\n    }\n  ];\n\n  return (\n    <Sheet open={open} onOpenChange={onOpenChange}>\n      <SheetTrigger asChild>\n        {children}\n      </SheetTrigger>\n      <SheetContent \n        side=\"bottom\" \n        className=\"h-auto max-h-[90vh] rounded-t-3xl border-0 bg-card\"\n      >\n        <SheetHeader className=\"space-y-6 pt-2\">\n          <div className=\"w-12 h-1.5 bg-muted rounded-full mx-auto\" />\n          <SheetTitle className=\"text-left text-2xl font-bold\">Profile</SheetTitle>\n          \n          {/* User Info Card */}\n          <div className=\"bg-gradient-to-br from-primary/10 to-neon-purple/10 dark:from-primary/20 dark:to-neon-purple/20 rounded-2xl p-4 border border-primary/20\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"relative\">\n                <Avatar className=\"h-20 w-20 border-4 border-background shadow-lg\">\n                  <AvatarImage src={user?.profileImageUrl || undefined} alt={`${user?.firstName} ${user?.lastName}` || \"User\"} />\n                  <AvatarFallback className=\"bg-primary text-primary-foreground font-bold text-2xl\">\n                    {user ? `${user.firstName[0]}${user.lastName[0]}`.toUpperCase() : 'U'}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"absolute -bottom-1 -right-1 w-6 h-6 bg-neon-green dark:bg-neon-green rounded-full border-4 border-background\" />\n              </div>\n              <div className=\"flex-1\">\n                <h3 className=\"font-bold text-xl text-foreground\">\n                  {user ? `${user.firstName} ${user.lastName}` : \"Guest User\"}\n                </h3>\n                <p className=\"text-sm text-muted-foreground mt-0.5\">{user?.email || \"\"}</p>\n                <div className=\"mt-2 inline-flex items-center gap-2 bg-primary/20 dark:bg-primary/30 px-3 py-1 rounded-full\">\n                  <div className=\"w-2 h-2 bg-neon-green rounded-full animate-pulse\" />\n                  <span className=\"text-xs font-semibold text-primary capitalize\">\n                    {user?.role || \"member\"}\n                  </span>\n                </div>\n              </div>\n            </div>\n          </div>\n        </SheetHeader>\n\n        <Separator className=\"my-6\" />\n\n        {/* Push Notifications */}\n        <div className=\"mb-4\">\n          <PushNotificationToggle />\n        </div>\n\n        <Separator className=\"my-6\" />\n\n        {/* Menu Items */}\n        <div className=\"space-y-2\">\n          {menuItems.map((item) => {\n            const Icon = item.icon;\n            return (\n              <Button\n                key={item.testId}\n                variant=\"ghost\"\n                onClick={() => handleMenuClick(item.action)}\n                className={cn(\n                  \"w-full justify-between h-14 rounded-2xl hover:bg-muted/50 transition-all duration-200 active:scale-98\",\n                  \"group\"\n                )}\n                data-testid={item.testId}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"p-2 bg-muted rounded-xl group-hover:bg-primary/10 transition-colors\">\n                    <Icon className={cn(\"h-5 w-5\", item.color)} />\n                  </div>\n                  <span className=\"font-medium\">{item.label}</span>\n                </div>\n                <ChevronRight className=\"h-5 w-5 text-muted-foreground group-hover:text-foreground transition-colors\" />\n              </Button>\n            );\n          })}\n        </div>\n\n        <Separator className=\"my-6\" />\n\n        {/* Logout Button */}\n        <Button\n          onClick={() => logoutMutation.mutate()}\n          disabled={logoutMutation.isPending}\n          variant=\"outline\"\n          className=\"w-full h-14 rounded-2xl border-2 border-destructive/20 text-destructive hover:bg-destructive hover:text-destructive-foreground transition-all duration-200 active:scale-98 font-semibold mb-4\"\n          data-testid=\"button-logout\"\n        >\n          <LogOut className=\"h-5 w-5 mr-2\" />\n          {logoutMutation.isPending ? \"Logging out...\" : \"Log Out\"}\n        </Button>\n\n        <p className=\"text-center text-xs text-muted-foreground pb-2\">\n          Idachi Fitness v1.0.0\n        </p>\n      </SheetContent>\n    </Sheet>\n  );\n}\n","size_bytes":6977},"client/src/components/admin-membership-plan-dialog.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { X } from \"lucide-react\";\nimport type { MembershipPlan } from \"@shared/schema\";\n\nconst membershipPlanSchema = z.object({\n  name: z.string().min(1, \"Nama paket diperlukan\"),\n  description: z.string().optional(),\n  price: z.string().min(1, \"Harga diperlukan\").refine((val) => !isNaN(Number(val)) && Number(val) >= 0, {\n    message: \"Harga harus berupa angka positif\",\n  }),\n  durationMonths: z.string().min(1, \"Durasi diperlukan\").refine((val) => !isNaN(Number(val)) && Number(val) > 0, {\n    message: \"Durasi harus lebih dari 0 bulan\",\n  }),\n  features: z.array(z.string()).optional(),\n  active: z.boolean().default(true),\n});\n\ntype MembershipPlanFormData = z.infer<typeof membershipPlanSchema>;\n\ninterface AdminMembershipPlanDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  plan?: MembershipPlan | null;\n}\n\nexport default function AdminMembershipPlanDialog({ open, onOpenChange, plan }: AdminMembershipPlanDialogProps) {\n  const { toast } = useToast();\n  const [featureInput, setFeatureInput] = useState(\"\");\n  const [features, setFeatures] = useState<string[]>([]);\n\n  const form = useForm<MembershipPlanFormData>({\n    resolver: zodResolver(membershipPlanSchema),\n    defaultValues: {\n      name: \"\",\n      description: \"\",\n      price: \"\",\n      durationMonths: \"\",\n      features: [],\n      active: true,\n    },\n  });\n\n  useEffect(() => {\n    if (plan) {\n      form.reset({\n        name: plan.name,\n        description: plan.description || \"\",\n        price: plan.price.toString(),\n        durationMonths: plan.durationMonths.toString(),\n        features: [],\n        active: plan.active ?? true,\n      });\n      setFeatures(Array.isArray(plan.features) ? plan.features : []);\n    } else {\n      form.reset({\n        name: \"\",\n        description: \"\",\n        price: \"\",\n        durationMonths: \"\",\n        features: [],\n        active: true,\n      });\n      setFeatures([]);\n    }\n  }, [plan, form]);\n\n  const createPlanMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/admin/membership-plans\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/membership-plans\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/membership-plans\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: plan ? \"Paket membership berhasil diperbarui\" : \"Paket membership baru berhasil dibuat\",\n      });\n      form.reset();\n      setFeatures([]);\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menyimpan paket membership\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updatePlanMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"PUT\", `/api/admin/membership-plans/${plan?.id}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/membership-plans\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/membership-plans\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Paket membership berhasil diperbarui\",\n      });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal memperbarui paket membership\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: MembershipPlanFormData) => {\n    const planData = {\n      name: data.name,\n      description: data.description || null,\n      price: data.price,\n      durationMonths: Number(data.durationMonths),\n      features: features.length > 0 ? features : null,\n      active: data.active,\n    };\n\n    if (plan) {\n      updatePlanMutation.mutate(planData);\n    } else {\n      createPlanMutation.mutate(planData);\n    }\n  };\n\n  const addFeature = () => {\n    if (featureInput.trim()) {\n      setFeatures([...features, featureInput.trim()]);\n      setFeatureInput(\"\");\n    }\n  };\n\n  const removeFeature = (index: number) => {\n    setFeatures(features.filter((_, i) => i !== index));\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      addFeature();\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{plan ? \"Edit Paket Membership\" : \"Buat Paket Membership Baru\"}</DialogTitle>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <FormField\n              control={form.control}\n              name=\"name\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Nama Paket</FormLabel>\n                  <FormControl>\n                    <Input\n                      {...field}\n                      placeholder=\"Contoh: Basic, Premium, Elite\"\n                      data-testid=\"input-plan-name\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"description\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Deskripsi (Opsional)</FormLabel>\n                  <FormControl>\n                    <Textarea\n                      {...field}\n                      placeholder=\"Deskripsi singkat tentang paket ini\"\n                      rows={3}\n                      data-testid=\"input-plan-description\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"price\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Harga (Rp)</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"number\"\n                        placeholder=\"500000\"\n                        data-testid=\"input-plan-price\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"durationMonths\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Masa Aktif (Bulan)</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        type=\"number\"\n                        placeholder=\"1\"\n                        data-testid=\"input-plan-duration\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormLabel>Fitur-fitur</FormLabel>\n              <FormDescription className=\"text-sm text-muted-foreground mb-2\">\n                Tambahkan fitur yang termasuk dalam paket ini\n              </FormDescription>\n              <div className=\"flex gap-2 mb-3\">\n                <Input\n                  value={featureInput}\n                  onChange={(e) => setFeatureInput(e.target.value)}\n                  onKeyPress={handleKeyPress}\n                  placeholder=\"Contoh: Akses gym 24/7\"\n                  data-testid=\"input-feature\"\n                />\n                <Button\n                  type=\"button\"\n                  onClick={addFeature}\n                  variant=\"outline\"\n                  data-testid=\"button-add-feature\"\n                >\n                  Tambah\n                </Button>\n              </div>\n              {features.length > 0 && (\n                <div className=\"space-y-2\">\n                  {features.map((feature, index) => (\n                    <div\n                      key={index}\n                      className=\"flex items-center justify-between bg-muted p-2 rounded-md\"\n                      data-testid={`feature-item-${index}`}\n                    >\n                      <span className=\"text-sm\">{feature}</span>\n                      <Button\n                        type=\"button\"\n                        variant=\"ghost\"\n                        size=\"sm\"\n                        onClick={() => removeFeature(index)}\n                        data-testid={`button-remove-feature-${index}`}\n                      >\n                        <X size={16} />\n                      </Button>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"active\"\n              render={({ field }) => (\n                <FormItem className=\"flex items-center justify-between rounded-lg border p-4\">\n                  <div className=\"space-y-0.5\">\n                    <FormLabel className=\"text-base\">Status Aktif</FormLabel>\n                    <FormDescription>\n                      Paket aktif akan ditampilkan kepada member\n                    </FormDescription>\n                  </div>\n                  <FormControl>\n                    <Switch\n                      checked={field.value}\n                      onCheckedChange={field.onChange}\n                      data-testid=\"switch-plan-active\"\n                    />\n                  </FormControl>\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end space-x-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => {\n                  form.reset();\n                  setFeatures([]);\n                  onOpenChange(false);\n                }}\n                data-testid=\"button-cancel\"\n              >\n                Batal\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"gym-gradient text-white\"\n                disabled={createPlanMutation.isPending || updatePlanMutation.isPending}\n                data-testid=\"button-submit\"\n              >\n                {(createPlanMutation.isPending || updatePlanMutation.isPending)\n                  ? \"Menyimpan...\"\n                  : plan\n                  ? \"Update Paket\"\n                  : \"Buat Paket\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":11531},"client/src/components/admin-edit-member-dialog.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { MembershipPlan } from \"@shared/schema\";\n\nconst editMemberSchema = z.object({\n  firstName: z.string().min(1, \"Nama depan diperlukan\"),\n  lastName: z.string().min(1, \"Nama belakang diperlukan\"),\n  username: z.string().min(3, \"Username minimal 3 karakter\"),\n  email: z.string().email(\"Email tidak valid\"),\n  phone: z.string().optional(),\n  password: z.string().optional(),\n});\n\nconst assignMembershipSchema = z.object({\n  planId: z.string().min(1, \"Pilih paket membership\"),\n  durationMonths: z.number().min(1, \"Durasi minimal 1 bulan\").optional(),\n});\n\ntype EditMemberFormData = z.infer<typeof editMemberSchema>;\ntype AssignMembershipFormData = z.infer<typeof assignMembershipSchema>;\n\ninterface Member {\n  id: string;\n  firstName?: string;\n  lastName?: string;\n  username?: string;\n  email?: string;\n  phone?: string;\n  membership?: {\n    plan?: {\n      name?: string;\n    };\n    endDate?: string;\n    status?: string;\n  };\n}\n\ninterface AdminEditMemberDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  member: Member | null;\n}\n\nexport default function AdminEditMemberDialog({ open, onOpenChange, member }: AdminEditMemberDialogProps) {\n  const { toast } = useToast();\n  const [activeTab, setActiveTab] = useState(\"details\");\n\n  const memberForm = useForm<EditMemberFormData>({\n    resolver: zodResolver(editMemberSchema),\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      username: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n    },\n  });\n\n  const membershipForm = useForm<AssignMembershipFormData>({\n    resolver: zodResolver(assignMembershipSchema),\n    defaultValues: {\n      planId: \"\",\n      durationMonths: undefined,\n    },\n  });\n\n  const { data: membershipPlans } = useQuery<MembershipPlan[]>({\n    queryKey: [\"/api/membership-plans\"],\n    enabled: open,\n  });\n\n  useEffect(() => {\n    if (member) {\n      memberForm.reset({\n        firstName: member.firstName,\n        lastName: member.lastName,\n        username: member.username,\n        email: member.email,\n        phone: member.phone || \"\",\n        password: \"\",\n      });\n    }\n  }, [member, memberForm]);\n\n  const updateMemberMutation = useMutation({\n    mutationFn: async (data: EditMemberFormData) => {\n      const dataToSend = { ...data };\n      if (!data.password) {\n        delete (dataToSend as any).password;\n      }\n      return await apiRequest(\"PUT\", `/api/admin/members/${member?.id}`, dataToSend);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Data member berhasil diperbarui\",\n      });\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal memperbarui data member\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const assignMembershipMutation = useMutation({\n    mutationFn: async (data: AssignMembershipFormData) => {\n      return await apiRequest(\"POST\", `/api/admin/members/${member?.id}/membership`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Membership berhasil diberikan\",\n      });\n      membershipForm.reset();\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal memberikan membership\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmitMemberDetails = (data: EditMemberFormData) => {\n    updateMemberMutation.mutate(data);\n  };\n\n  const onSubmitMembership = (data: AssignMembershipFormData) => {\n    assignMembershipMutation.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Edit Member: {member?.firstName} {member?.lastName}</DialogTitle>\n        </DialogHeader>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"details\" data-testid=\"tab-details\">Detail Member</TabsTrigger>\n            <TabsTrigger value=\"membership\" data-testid=\"tab-membership\">Membership</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"details\" className=\"space-y-4 mt-4\">\n            <Form {...memberForm}>\n              <form onSubmit={memberForm.handleSubmit(onSubmitMemberDetails)} className=\"space-y-4\">\n                <div className=\"grid grid-cols-2 gap-4\">\n                  <FormField\n                    control={memberForm.control}\n                    name=\"firstName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Nama Depan</FormLabel>\n                        <FormControl>\n                          <Input\n                            {...field}\n                            placeholder=\"John\"\n                            data-testid=\"input-edit-firstname\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={memberForm.control}\n                    name=\"lastName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Nama Belakang</FormLabel>\n                        <FormControl>\n                          <Input\n                            {...field}\n                            placeholder=\"Doe\"\n                            data-testid=\"input-edit-lastname\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n\n                <FormField\n                  control={memberForm.control}\n                  name=\"username\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Username</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          placeholder=\"johndoe\"\n                          data-testid=\"input-edit-username\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={memberForm.control}\n                  name=\"email\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Email</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          type=\"email\"\n                          placeholder=\"john@example.com\"\n                          data-testid=\"input-edit-email\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={memberForm.control}\n                  name=\"phone\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Nomor Telepon (Opsional)</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          placeholder=\"+62 812 3456 7890\"\n                          data-testid=\"input-edit-phone\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={memberForm.control}\n                  name=\"password\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Password Baru (Opsional)</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          type=\"password\"\n                          placeholder=\"Kosongkan jika tidak ingin mengubah\"\n                          data-testid=\"input-edit-password\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"flex justify-end space-x-3 pt-4\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => onOpenChange(false)}\n                    data-testid=\"button-cancel-details\"\n                  >\n                    Batal\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    className=\"gym-gradient text-white\"\n                    disabled={updateMemberMutation.isPending}\n                    data-testid=\"button-save-details\"\n                  >\n                    {updateMemberMutation.isPending ? \"Menyimpan...\" : \"Simpan Perubahan\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </TabsContent>\n\n          <TabsContent value=\"membership\" className=\"space-y-4 mt-4\">\n            {member?.membership && (\n              <div className=\"bg-muted p-4 rounded-lg mb-4\">\n                <h4 className=\"font-semibold mb-2\">Membership Saat Ini</h4>\n                <div className=\"text-sm space-y-1\">\n                  <p>Paket: <span className=\"font-medium\">{member.membership.plan?.name || 'N/A'}</span></p>\n                  <p>Status: <span className=\"font-medium\">{member.membership.status || 'N/A'}</span></p>\n                  <p>Berakhir: <span className=\"font-medium\">\n                    {member.membership.endDate \n                      ? new Date(member.membership.endDate).toLocaleDateString('id-ID')\n                      : 'N/A'\n                    }\n                  </span></p>\n                </div>\n              </div>\n            )}\n\n            <Form {...membershipForm}>\n              <form onSubmit={membershipForm.handleSubmit(onSubmitMembership)} className=\"space-y-4\">\n                <FormField\n                  control={membershipForm.control}\n                  name=\"planId\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Pilih Paket Membership</FormLabel>\n                      <Select onValueChange={field.onChange} value={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-membership-plan\">\n                            <SelectValue placeholder=\"Pilih paket membership\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {membershipPlans?.map((plan) => (\n                            <SelectItem key={plan.id} value={plan.id}>\n                              {plan.name} - Rp {Number(plan.price).toLocaleString('id-ID')} / {plan.durationMonths} bulan\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={membershipForm.control}\n                  name=\"durationMonths\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Durasi Custom (Opsional)</FormLabel>\n                      <FormControl>\n                        <Input\n                          {...field}\n                          type=\"number\"\n                          placeholder=\"Kosongkan untuk durasi default\"\n                          onChange={(e) => field.onChange(e.target.value ? Number(e.target.value) : undefined)}\n                          value={field.value || \"\"}\n                          data-testid=\"input-duration-months\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <div className=\"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg text-sm\">\n                  <p className=\"text-blue-700 dark:text-blue-300\">\n                    Memberikan membership baru akan menggantikan membership yang aktif saat ini (jika ada).\n                  </p>\n                </div>\n\n                <div className=\"flex justify-end space-x-3 pt-4\">\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    onClick={() => onOpenChange(false)}\n                    data-testid=\"button-cancel-membership\"\n                  >\n                    Batal\n                  </Button>\n                  <Button\n                    type=\"submit\"\n                    className=\"gym-gradient text-white\"\n                    disabled={assignMembershipMutation.isPending}\n                    data-testid=\"button-assign-membership\"\n                  >\n                    {assignMembershipMutation.isPending ? \"Memproses...\" : \"Berikan Membership\"}\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":14638},"client/src/components/admin-member-dialog.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\nconst memberSchema = z.object({\n  firstName: z.string().min(1, \"Nama depan diperlukan\"),\n  lastName: z.string().min(1, \"Nama belakang diperlukan\"),\n  username: z.string().min(3, \"Username minimal 3 karakter\"),\n  email: z.string().email(\"Email tidak valid\"),\n  phone: z.string().optional(),\n  password: z.string().min(6, \"Password minimal 6 karakter\"),\n});\n\ntype MemberFormData = z.infer<typeof memberSchema>;\n\ninterface AdminMemberDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport default function AdminMemberDialog({ open, onOpenChange }: AdminMemberDialogProps) {\n  const { toast } = useToast();\n\n  const form = useForm<MemberFormData>({\n    resolver: zodResolver(memberSchema),\n    defaultValues: {\n      firstName: \"\",\n      lastName: \"\",\n      username: \"\",\n      email: \"\",\n      phone: \"\",\n      password: \"\",\n    },\n  });\n\n  const createMemberMutation = useMutation({\n    mutationFn: async (data: MemberFormData) => {\n      return await apiRequest(\"POST\", \"/api/admin/members\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Berhasil!\",\n        description: \"Member baru berhasil ditambahkan\",\n      });\n      form.reset();\n      onOpenChange(false);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menambahkan member\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: MemberFormData) => {\n    createMemberMutation.mutate(data);\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>Tambah Member Baru</DialogTitle>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"firstName\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Nama Depan</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        placeholder=\"John\"\n                        data-testid=\"input-firstname\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"lastName\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>Nama Belakang</FormLabel>\n                    <FormControl>\n                      <Input\n                        {...field}\n                        placeholder=\"Doe\"\n                        data-testid=\"input-lastname\"\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"username\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Username</FormLabel>\n                  <FormControl>\n                    <Input\n                      {...field}\n                      placeholder=\"johndoe\"\n                      data-testid=\"input-username\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"email\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Email</FormLabel>\n                  <FormControl>\n                    <Input\n                      {...field}\n                      type=\"email\"\n                      placeholder=\"john@example.com\"\n                      data-testid=\"input-email\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"phone\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Nomor Telepon (Opsional)</FormLabel>\n                  <FormControl>\n                    <Input\n                      {...field}\n                      placeholder=\"+62 812 3456 7890\"\n                      data-testid=\"input-phone\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <FormField\n              control={form.control}\n              name=\"password\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Password</FormLabel>\n                  <FormControl>\n                    <Input\n                      {...field}\n                      type=\"password\"\n                      placeholder=\"Minimal 6 karakter\"\n                      data-testid=\"input-password\"\n                    />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end space-x-3 pt-4\">\n              <Button\n                type=\"button\"\n                variant=\"outline\"\n                onClick={() => {\n                  form.reset();\n                  onOpenChange(false);\n                }}\n                data-testid=\"button-cancel\"\n              >\n                Batal\n              </Button>\n              <Button\n                type=\"submit\"\n                className=\"gym-gradient text-white\"\n                disabled={createMemberMutation.isPending}\n                data-testid=\"button-submit\"\n              >\n                {createMemberMutation.isPending ? \"Menyimpan...\" : \"Tambah Member\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":6885},"client/src/pages/admin-members.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport AdminMemberDialog from \"@/components/admin-member-dialog\";\nimport AdminEditMemberDialog from \"@/components/admin-edit-member-dialog\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { UserPlus, Edit, Trash2, UserX, UserCheck, Search, Activity } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface MemberWithMembership {\n  id: string;\n  email?: string;\n  username?: string;\n  phone?: string;\n  firstName?: string;\n  lastName?: string;\n  profileImageUrl?: string;\n  active?: boolean;\n  lastCheckIn?: string | null;\n  daysInactive?: number | null;\n  membership?: {\n    status?: string;\n    endDate?: string;\n    plan?: {\n      name?: string;\n    };\n  };\n}\n\nexport default function AdminMembers() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [memberFilter, setMemberFilter] = useState(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [showMemberDialog, setShowMemberDialog] = useState(false);\n  const [showEditMemberDialog, setShowEditMemberDialog] = useState(false);\n  const [selectedMember, setSelectedMember] = useState<MemberWithMembership | null>(null);\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData } = useQuery<any>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: members } = useQuery<MemberWithMembership[]>({\n    queryKey: [\"/api/admin/members\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const suspendMutation = useMutation({\n    mutationFn: (memberId: string) => apiRequest(\"PUT\", `/api/admin/members/${memberId}/suspend`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Success!\",\n        description: \"Member has been suspended\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to suspend member\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const activateMutation = useMutation({\n    mutationFn: (memberId: string) => apiRequest(\"PUT\", `/api/admin/members/${memberId}/activate`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Success!\",\n        description: \"Member has been activated\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to activate member\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  const isExpiringSoon = (endDate: string) => {\n    const now = new Date();\n    const expiry = new Date(endDate);\n    const diffTime = expiry.getTime() - now.getTime();\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    return diffDays <= 20 && diffDays > 0;\n  };\n\n  const getMembershipStatus = (member: MemberWithMembership) => {\n    if (!member.membership) return \"No Membership\";\n    if (member.membership.status === \"expired\") return \"Expired\";\n    if (member.membership.endDate && isExpiringSoon(member.membership.endDate)) return \"Expiring Soon\";\n    if (member.membership.status === \"active\") return \"Active\";\n    return member.membership.status || \"Unknown\";\n  };\n\n  const filteredMembers = members?.filter((member) => {\n    const matchesSearch = !searchTerm || \n      member.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      member.username?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      member.phone?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      `${member.firstName || ''} ${member.lastName || ''}`.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesFilter = memberFilter === \"all\" ||\n      (memberFilter === \"active\" && member.membership?.status === \"active\") ||\n      (memberFilter === \"expiring\" && member.membership && isExpiringSoon(member.membership.endDate || \"\")) ||\n      (memberFilter === \"expired\" && member.membership?.status === \"expired\") ||\n      (memberFilter === \"inactive\" && member.daysInactive !== null && member.daysInactive !== undefined && member.daysInactive >= 7);\n\n    return matchesSearch && matchesFilter;\n  }) || [];\n\n  const getStatusVariant = (status: string) => {\n    switch (status) {\n      case \"Active\": return \"default\";\n      case \"Expiring Soon\": return \"secondary\";\n      case \"Expired\": return \"destructive\";\n      default: return \"outline\";\n    }\n  };\n\n  const handleEditMember = (member: MemberWithMembership) => {\n    setSelectedMember(member);\n    setShowEditMemberDialog(true);\n  };\n\n  const handleDeleteMember = async (memberId: string) => {\n    if (!confirm(\"Are you sure you want to delete this member? This action cannot be undone.\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/members/${memberId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/members\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      toast({\n        title: \"Success!\",\n        description: \"Member has been deleted\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete member\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  const handleSuspendMember = async (memberId: string) => {\n    if (!confirm(\"Are you sure you want to suspend this member temporarily?\")) {\n      return;\n    }\n    suspendMutation.mutate(memberId);\n  };\n\n  const handleActivateMember = async (memberId: string) => {\n    activateMutation.mutate(memberId);\n  };\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Members</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage gym member accounts</p>\n          </div>\n          <Button \n            className=\"gym-gradient text-white\" \n            onClick={() => setShowMemberDialog(true)}\n            data-testid=\"button-add-member\"\n          >\n            <UserPlus className=\"mr-2\" size={16} />\n            Add New Member\n          </Button>\n        </div>\n\n        {/* Search and Filter */}\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"flex gap-4\">\n              <div className=\"flex-1 relative\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground\" size={18} />\n                <Input\n                  placeholder=\"Search members by name, email, username, or phone...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10\"\n                  data-testid=\"input-search-members\"\n                />\n              </div>\n              <Select value={memberFilter} onValueChange={setMemberFilter}>\n                <SelectTrigger className=\"w-48\" data-testid=\"select-filter-members\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Members</SelectItem>\n                  <SelectItem value=\"active\">Active</SelectItem>\n                  <SelectItem value=\"expiring\">Expiring Soon</SelectItem>\n                  <SelectItem value=\"expired\">Expired</SelectItem>\n                  <SelectItem value=\"inactive\">Inactive (7+ days)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Members Table */}\n        <Card>\n          <CardHeader>\n            <CardTitle>All Members ({filteredMembers.length})</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {filteredMembers.length === 0 ? (\n              <p className=\"text-center text-muted-foreground py-12\">No members found</p>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-muted/50\">\n                    <tr>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Member\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Username\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Phone\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Membership\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Status\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Last Check-in\n                      </th>\n                      <th className=\"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase\">\n                        Inactive Days\n                      </th>\n                      <th className=\"px-6 py-3 text-right text-xs font-medium text-muted-foreground uppercase\">\n                        Actions\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody className=\"divide-y divide-border\">\n                    {filteredMembers.map((member) => (\n                      <tr key={member.id} data-testid={`row-member-${member.id}`}>\n                        <td className=\"px-6 py-4\">\n                          <div className=\"flex items-center\">\n                            <Avatar className=\"h-10 w-10\">\n                              <AvatarImage src={member.profileImageUrl} />\n                              <AvatarFallback>\n                                {`${member.firstName?.[0] || ''}${member.lastName?.[0] || ''}` || 'M'}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div className=\"ml-4\">\n                              <div className=\"flex items-center gap-2\">\n                                <p className=\"text-sm font-medium text-foreground\">\n                                  {`${member.firstName || ''} ${member.lastName || ''}`.trim() || 'No Name'}\n                                </p>\n                                {member.active === false && (\n                                  <Badge variant=\"outline\" className=\"text-orange-600 border-orange-600\">\n                                    Suspended\n                                  </Badge>\n                                )}\n                              </div>\n                              <p className=\"text-sm text-muted-foreground\">{member.email}</p>\n                            </div>\n                          </div>\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-foreground\">\n                          {member.username || '-'}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-foreground\">\n                          {member.phone || '-'}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-foreground\">\n                          {member.membership?.plan?.name || 'No Plan'}\n                        </td>\n                        <td className=\"px-6 py-4\">\n                          <Badge variant={getStatusVariant(getMembershipStatus(member))}>\n                            {getMembershipStatus(member)}\n                          </Badge>\n                        </td>\n                        <td className=\"px-6 py-4 text-sm text-foreground\">\n                          {member.lastCheckIn ? (\n                            <div className=\"flex items-center gap-2\">\n                              <Activity size={14} className=\"text-green-600\" />\n                              {format(new Date(member.lastCheckIn), 'dd MMM yyyy')}\n                            </div>\n                          ) : (\n                            <span className=\"text-muted-foreground\">Never</span>\n                          )}\n                        </td>\n                        <td className=\"px-6 py-4 text-sm\">\n                          {member.daysInactive !== null && member.daysInactive !== undefined ? (\n                            <Badge \n                              variant={member.daysInactive >= 7 ? \"destructive\" : member.daysInactive >= 3 ? \"secondary\" : \"default\"}\n                            >\n                              {member.daysInactive} {member.daysInactive === 1 ? 'day' : 'days'}\n                            </Badge>\n                          ) : (\n                            <span className=\"text-muted-foreground\">-</span>\n                          )}\n                        </td>\n                        <td className=\"px-6 py-4 text-right\">\n                          <div className=\"flex justify-end gap-2\">\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={() => handleEditMember(member)}\n                              data-testid={`button-edit-${member.id}`}\n                            >\n                              <Edit size={16} />\n                            </Button>\n                            {member.active !== false ? (\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => handleSuspendMember(member.id)}\n                                data-testid={`button-suspend-${member.id}`}\n                              >\n                                <UserX size={16} className=\"text-orange-600\" />\n                              </Button>\n                            ) : (\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                onClick={() => handleActivateMember(member.id)}\n                                data-testid={`button-activate-${member.id}`}\n                              >\n                                <UserCheck size={16} className=\"text-green-600\" />\n                              </Button>\n                            )}\n                            <Button\n                              variant=\"ghost\"\n                              size=\"sm\"\n                              onClick={() => handleDeleteMember(member.id)}\n                              data-testid={`button-delete-${member.id}`}\n                            >\n                              <Trash2 size={16} className=\"text-destructive\" />\n                            </Button>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Add Member Dialog */}\n      <AdminMemberDialog\n        open={showMemberDialog}\n        onOpenChange={setShowMemberDialog}\n      />\n\n      {/* Edit Member Dialog */}\n      <AdminEditMemberDialog\n        open={showEditMemberDialog}\n        onOpenChange={setShowEditMemberDialog}\n        member={selectedMember}\n      />\n    </AdminLayout>\n  );\n}\n","size_bytes":17252},"client/src/pages/admin-overview.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport AdminCheckInModal from \"@/components/admin-checkin-modal\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport {\n  Users,\n  CalendarCheck,\n  TriangleAlert,\n  DollarSign,\n  QrCode,\n  Bell\n} from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface AdminDashboardStats {\n  totalMembers?: number;\n  activeToday?: number;\n  expiringSoon?: number;\n  revenue?: {\n    thisMonth?: number;\n    lastMonth?: number;\n    total?: number;\n  };\n}\n\ninterface AdminDashboardResponse {\n  stats?: AdminDashboardStats;\n  users?: any[];\n}\n\ninterface CheckInRecord {\n  id: string;\n  checkInTime: string;\n  status?: string;\n  user?: {\n    firstName?: string;\n    lastName?: string;\n    profileImageUrl?: string;\n  };\n  membership?: {\n    plan?: {\n      name?: string;\n    };\n  };\n}\n\nexport default function AdminOverview() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [showCheckInModal, setShowCheckInModal] = useState(false);\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const sendReminderMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/admin/send-inactivity-reminders\", {\n        daysInactive: 7\n      });\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Reminder Berhasil Dikirim! âœ…\",\n        description: `${data.count} reminder telah dikirim ke member yang tidak aktif ${data.daysInactive} hari`,\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Gagal Mengirim Reminder\",\n        description: error.message || \"Terjadi kesalahan saat mengirim reminder\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const { data: dashboardData, isLoading: dashboardLoading } = useQuery<AdminDashboardResponse>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: recentCheckIns } = useQuery<CheckInRecord[]>({\n    queryKey: [\"/api/admin/checkins\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n    refetchInterval: 10000,\n  });\n\n  if (isLoading || dashboardLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"flex flex-col items-center gap-3\">\n          <div className=\"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin\" />\n          <p className=\"text-sm text-muted-foreground\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-slate-900 dark:text-white\">Dashboard</h1>\n            <p className=\"text-slate-600 dark:text-slate-400\">Welcome back! Here's your gym overview</p>\n          </div>\n          <div className=\"flex flex-wrap gap-3\">\n            <Button \n              onClick={() => sendReminderMutation.mutate()}\n              disabled={sendReminderMutation.isPending}\n              variant=\"outline\"\n              data-testid=\"button-send-reminder\"\n            >\n              {sendReminderMutation.isPending ? (\n                <>\n                  <div className=\"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full mr-2\" />\n                  Sending...\n                </>\n              ) : (\n                <>\n                  <Bell className=\"mr-2\" size={16} />\n                  Send Reminder\n                </>\n              )}\n            </Button>\n            <Button \n              onClick={() => setShowCheckInModal(true)}\n              className=\"bg-blue-600 hover:bg-blue-700\"\n              data-testid=\"button-validate-checkin\"\n            >\n              <QrCode className=\"mr-2\" size={16} />\n              Scan QR Code\n            </Button>\n          </div>\n        </div>\n\n        {/* Stats Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-4\">\n          <Card className=\"p-6 border-slate-200 dark:border-slate-800\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-12 h-12 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center\">\n                <Users className=\"w-6 h-6 text-blue-600 dark:text-blue-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-slate-600 dark:text-slate-400\">Total Members</p>\n                <p className=\"text-2xl font-bold text-slate-900 dark:text-white\" data-testid=\"text-total-members\">\n                  {stats.totalMembers || 0}\n                </p>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"p-6 border-slate-200 dark:border-slate-800\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-12 h-12 rounded-lg bg-green-100 dark:bg-green-900/30 flex items-center justify-center\">\n                <CalendarCheck className=\"w-6 h-6 text-green-600 dark:text-green-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-slate-600 dark:text-slate-400\">Active Today</p>\n                <p className=\"text-2xl font-bold text-slate-900 dark:text-white\" data-testid=\"text-active-today\">\n                  {stats.activeToday || 0}\n                </p>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"p-6 border-slate-200 dark:border-slate-800\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-12 h-12 rounded-lg bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center\">\n                <TriangleAlert className=\"w-6 h-6 text-orange-600 dark:text-orange-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-slate-600 dark:text-slate-400\">Expiring Soon</p>\n                <p className=\"text-2xl font-bold text-slate-900 dark:text-white\" data-testid=\"text-expiring-soon\">\n                  {stats.expiringSoon || 0}\n                </p>\n              </div>\n            </div>\n          </Card>\n\n          <Card className=\"p-6 border-slate-200 dark:border-slate-800\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"w-12 h-12 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center\">\n                <DollarSign className=\"w-6 h-6 text-purple-600 dark:text-purple-400\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-slate-600 dark:text-slate-400\">Monthly Revenue</p>\n                <p className=\"text-2xl font-bold text-slate-900 dark:text-white\" data-testid=\"text-monthly-revenue\">\n                  ${stats.revenue?.thisMonth || 0}\n                </p>\n              </div>\n            </div>\n          </Card>\n        </div>\n\n        {/* Recent Activity */}\n        <Card className=\"border-slate-200 dark:border-slate-800\">\n          <div className=\"p-6\">\n            <div className=\"flex items-center justify-between mb-6\">\n              <h3 className=\"text-xl font-bold text-slate-900 dark:text-white\">Recent Check-ins</h3>\n              <Button \n                variant=\"ghost\" \n                size=\"sm\"\n                data-testid=\"button-view-all-checkins\"\n                onClick={() => window.location.href = '/admin/checkins'}\n              >\n                View All\n              </Button>\n            </div>\n\n            <div className=\"space-y-3\">\n              {!recentCheckIns || recentCheckIns.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <p className=\"text-slate-500 dark:text-slate-400\">No recent check-ins</p>\n                </div>\n              ) : (\n                recentCheckIns.slice(0, 5).map((checkin) => (\n                  <div \n                    key={checkin.id} \n                    className=\"flex items-center justify-between p-3 rounded-lg border border-slate-200 dark:border-slate-800 hover:bg-slate-50 dark:hover:bg-slate-800/50\"\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <Avatar className=\"h-10 w-10\">\n                        <AvatarImage src={checkin.user?.profileImageUrl} />\n                        <AvatarFallback className=\"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400\">\n                          {`${checkin.user?.firstName?.[0] || ''}${checkin.user?.lastName?.[0] || ''}`}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div>\n                        <p className=\"font-medium text-slate-900 dark:text-white\">\n                          {checkin.user?.firstName} {checkin.user?.lastName}\n                        </p>\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {checkin.membership?.plan?.name || 'No Plan'}\n                        </Badge>\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"font-medium text-slate-900 dark:text-white\">\n                        {format(new Date(checkin.checkInTime), 'HH:mm')}\n                      </p>\n                      <p className=\"text-xs text-slate-500 dark:text-slate-400\">\n                        {format(new Date(checkin.checkInTime), 'dd MMM')}\n                      </p>\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      <AdminCheckInModal\n        open={showCheckInModal}\n        onClose={() => setShowCheckInModal(false)}\n      />\n    </AdminLayout>\n  );\n}\n","size_bytes":10787},"client/src/components/ui/admin-sidebar.tsx":{"content":"import { useLocation } from \"wouter\";\nimport { \n  LayoutDashboard, \n  Users, \n  Dumbbell, \n  UserCog, \n  CreditCard, \n  QrCode, \n  MessageSquare,\n  Calendar,\n  CalendarCheck,\n  X,\n  HelpCircle,\n  ChevronLeft,\n  ChevronRight\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport logoPath from \"@assets/image_1759411904981.png\";\nimport { useState } from \"react\";\n\ninterface AdminSidebarProps {\n  className?: string;\n  isOpen: boolean;\n  onClose: () => void;\n  isCollapsed?: boolean;\n  onToggleCollapse?: () => void;\n}\n\nexport default function AdminSidebar({ \n  className, \n  isOpen, \n  onClose,\n  isCollapsed = false,\n  onToggleCollapse\n}: AdminSidebarProps) {\n  const [location] = useLocation();\n\n  const menuItems = [\n    { href: \"/admin\", icon: LayoutDashboard, label: \"Dashboard\" },\n    { href: \"/admin/members\", icon: Users, label: \"Members\" },\n    { href: \"/admin/classes\", icon: Dumbbell, label: \"Classes\" },\n    { href: \"/admin/trainers\", icon: UserCog, label: \"Trainers\" },\n    { href: \"/admin/plans\", icon: CreditCard, label: \"Plans\" },\n    { href: \"/admin/pt-bookings\", icon: Calendar, label: \"PT Bookings\" },\n    { href: \"/admin/class-bookings\", icon: CalendarCheck, label: \"Bookings\" },\n    { href: \"/admin/checkins\", icon: QrCode, label: \"Check-In\" },\n    { href: \"/admin/feedback\", icon: MessageSquare, label: \"Feedback\" },\n  ];\n\n  const handleNavClick = (e: React.MouseEvent, href: string) => {\n    e.preventDefault();\n    e.stopPropagation();\n    window.location.href = href;\n    onClose();\n  };\n\n  return (\n    <>\n      {/* Mobile Overlay */}\n      {isOpen && (\n        <div \n          className=\"fixed inset-0 bg-black/50 z-40 lg:hidden animate-fade-in backdrop-blur-sm\"\n          onClick={onClose}\n          data-testid=\"overlay-sidebar\"\n        />\n      )}\n\n      {/* Sidebar */}\n      <aside \n        className={cn(\n          \"fixed lg:sticky top-0 left-0 h-screen z-50 flex flex-col border-r border-border bg-card smooth-transition\",\n          isOpen ? \"translate-x-0\" : \"-translate-x-full lg:translate-x-0\",\n          isCollapsed ? \"w-20\" : \"w-64\",\n          className\n        )}\n        data-testid=\"sidebar-admin\"\n      >\n        {/* Header */}\n        <div className=\"flex items-center justify-between px-4 h-16 border-b border-border\">\n          {!isCollapsed && (\n            <div className=\"flex items-center gap-3 animate-fade-in\">\n              <img \n                src={logoPath} \n                alt=\"Gym Logo\" \n                className=\"w-10 h-10 object-contain rounded-lg\"\n                data-testid=\"img-sidebar-logo\"\n              />\n              <div className=\"flex flex-col\">\n                <h2 className=\"text-sm font-bold text-foreground\">Idachi Fitness</h2>\n                <p className=\"text-xs text-muted-foreground\">Admin Panel</p>\n              </div>\n            </div>\n          )}\n          \n          {isCollapsed && (\n            <img \n              src={logoPath} \n              alt=\"Logo\" \n              className=\"w-10 h-10 object-contain rounded-lg mx-auto animate-scale-in\"\n              data-testid=\"img-sidebar-logo-collapsed\"\n            />\n          )}\n\n          <button\n            onClick={onClose}\n            className=\"lg:hidden p-2 hover:bg-muted rounded-lg transition-colors\"\n            data-testid=\"button-close-sidebar\"\n          >\n            <X className=\"h-5 w-5 text-muted-foreground\" />\n          </button>\n        </div>\n\n        {/* Navigation */}\n        <nav className=\"flex-1 px-3 py-4 space-y-1 overflow-y-auto\">\n          {menuItems.map((item) => {\n            const Icon = item.icon;\n            const isActive = location === item.href;\n            \n            return (\n              <button\n                key={item.href}\n                type=\"button\"\n                onClick={(e) => handleNavClick(e, item.href)}\n                className={cn(\n                  \"w-full sidebar-item group relative\",\n                  isActive ? \"sidebar-item-active\" : \"sidebar-item-inactive\",\n                  isCollapsed && \"justify-center px-0\"\n                )}\n                data-testid={`link-${item.label.toLowerCase().replace(/\\s+/g, '-')}`}\n                title={isCollapsed ? item.label : undefined}\n              >\n                <div className={cn(\n                  \"flex items-center justify-center\",\n                  isCollapsed ? \"w-full\" : \"\"\n                )}>\n                  <Icon className={cn(\n                    \"h-5 w-5 flex-shrink-0 transition-transform group-hover:scale-110\",\n                    isActive ? \"text-primary\" : \"text-muted-foreground group-hover:text-foreground\"\n                  )} />\n                </div>\n                \n                {!isCollapsed && (\n                  <span className={cn(\n                    \"text-sm font-medium transition-colors animate-fade-in\",\n                    isActive ? \"text-primary\" : \"text-muted-foreground group-hover:text-foreground\"\n                  )}>\n                    {item.label}\n                  </span>\n                )}\n\n                {isActive && !isCollapsed && (\n                  <div className=\"absolute left-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-primary rounded-r-full animate-scale-in\" />\n                )}\n              </button>\n            );\n          })}\n        </nav>\n\n        {/* Bottom Section */}\n        <div className=\"border-t border-border p-3 space-y-2\">\n          <button\n            className={cn(\n              \"w-full sidebar-item sidebar-item-inactive group\",\n              isCollapsed && \"justify-center px-0\"\n            )}\n            data-testid=\"button-help-center\"\n            title={isCollapsed ? \"Help Center\" : undefined}\n          >\n            <HelpCircle className=\"h-5 w-5 flex-shrink-0 text-muted-foreground group-hover:text-foreground transition-transform group-hover:scale-110\" />\n            {!isCollapsed && (\n              <span className=\"text-sm font-medium text-muted-foreground group-hover:text-foreground animate-fade-in\">\n                Help Center\n              </span>\n            )}\n          </button>\n\n          {/* Collapse Toggle (Desktop Only) */}\n          {onToggleCollapse && (\n            <button\n              onClick={onToggleCollapse}\n              className=\"hidden lg:flex w-full items-center justify-center p-3 hover:bg-muted rounded-lg transition-colors group\"\n              data-testid=\"button-toggle-collapse\"\n              title={isCollapsed ? \"Expand Sidebar\" : \"Collapse Sidebar\"}\n            >\n              {isCollapsed ? (\n                <ChevronRight className=\"h-5 w-5 text-muted-foreground group-hover:text-foreground transition-transform group-hover:scale-110\" />\n              ) : (\n                <>\n                  <ChevronLeft className=\"h-5 w-5 text-muted-foreground group-hover:text-foreground transition-transform group-hover:scale-110\" />\n                  <span className=\"ml-2 text-sm font-medium text-muted-foreground group-hover:text-foreground\">\n                    Collapse\n                  </span>\n                </>\n              )}\n            </button>\n          )}\n        </div>\n      </aside>\n    </>\n  );\n}\n","size_bytes":7118},"client/src/pages/admin-trainers.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport AdminPTDialog from \"@/components/admin-pt-dialog\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Plus, Edit, Trash2, DollarSign, Award } from \"lucide-react\";\nimport type { PersonalTrainer } from \"@shared/schema\";\n\nexport default function AdminTrainers() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [showPTDialog, setShowPTDialog] = useState(false);\n  const [selectedTrainer, setSelectedTrainer] = useState<PersonalTrainer | null>(null);\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData } = useQuery<any>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: trainers } = useQuery<PersonalTrainer[]>({\n    queryKey: [\"/api/admin/trainers\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  const handleAddTrainer = () => {\n    setSelectedTrainer(null);\n    setShowPTDialog(true);\n  };\n\n  const handleEditTrainer = (trainer: PersonalTrainer) => {\n    setSelectedTrainer(trainer);\n    setShowPTDialog(true);\n  };\n\n  const handleDeleteTrainer = async (trainerId: string) => {\n    if (!confirm(\"Are you sure you want to delete this trainer?\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/trainers/${trainerId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/trainers\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trainers\"] });\n      toast({\n        title: \"Success!\",\n        description: \"Trainer has been deleted\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete trainer\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Personal Trainers</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage personal trainers</p>\n          </div>\n          <Button \n            className=\"gym-gradient text-white\" \n            onClick={handleAddTrainer}\n            data-testid=\"button-add-trainer\"\n          >\n            <Plus className=\"mr-2\" size={16} />\n            Add New Trainer\n          </Button>\n        </div>\n\n        {/* Trainers Grid */}\n        {!trainers || trainers.length === 0 ? (\n          <Card>\n            <CardContent className=\"py-12\">\n              <p className=\"text-center text-muted-foreground\">No trainers available</p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {trainers.map((trainer) => (\n              <Card key={trainer.id} className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <div className=\"flex items-start gap-4\">\n                    <Avatar className=\"h-16 w-16\">\n                      <AvatarImage src={trainer.imageUrl || undefined} />\n                      <AvatarFallback className=\"text-lg\">\n                        {trainer.name?.[0] || 'T'}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-xl\">{trainer.name}</CardTitle>\n                      <Badge variant=\"secondary\" className=\"mt-1\">\n                        {trainer.specialization}\n                      </Badge>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-sm text-muted-foreground line-clamp-3\">\n                    {trainer.bio || \"No bio available\"}\n                  </p>\n\n                  {trainer.experience && (\n                    <div className=\"flex items-center gap-2 text-sm\">\n                      <Award size={16} className=\"text-muted-foreground\" />\n                      <span className=\"text-foreground\">{trainer.experience} years experience</span>\n                    </div>\n                  )}\n\n                  {trainer.certification && (\n                    <div className=\"text-sm\">\n                      <span className=\"text-muted-foreground\">Certification: </span>\n                      <span className=\"text-foreground\">{trainer.certification}</span>\n                    </div>\n                  )}\n\n                  <div className=\"flex items-center gap-2 text-lg font-bold text-foreground pt-2\">\n                    <DollarSign size={20} className=\"text-primary\" />\n                    <span>${trainer.pricePerSession}/session</span>\n                  </div>\n\n                  <div className=\"flex gap-2 pt-4 border-t\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"flex-1\"\n                      onClick={() => handleEditTrainer(trainer)}\n                      data-testid={`button-edit-trainer-${trainer.id}`}\n                    >\n                      <Edit size={16} className=\"mr-2\" />\n                      Edit\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDeleteTrainer(trainer.id)}\n                      data-testid={`button-delete-trainer-${trainer.id}`}\n                    >\n                      <Trash2 size={16} className=\"text-destructive\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Trainer Dialog */}\n      <AdminPTDialog\n        open={showPTDialog}\n        onOpenChange={setShowPTDialog}\n        trainer={selectedTrainer}\n      />\n    </AdminLayout>\n  );\n}\n","size_bytes":7215},"client/src/pages/admin-checkins.tsx":{"content":"import { useEffect, useState, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport { Clock, Activity, CalendarCheck, Sparkles, Camera, Loader2, X } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { Html5Qrcode } from \"html5-qrcode\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\ninterface CheckInRecord {\n  id: string;\n  checkInTime: string;\n  status?: string;\n  user?: {\n    firstName?: string;\n    lastName?: string;\n    profileImageUrl?: string;\n  };\n  membership?: {\n    plan?: {\n      name?: string;\n    };\n  };\n}\n\nexport default function AdminCheckIns() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [isScanning, setIsScanning] = useState(false);\n  const [showSuccessModal, setShowSuccessModal] = useState(false);\n  const [checkInData, setCheckInData] = useState<any>(null);\n  const [cameraError, setCameraError] = useState(\"\");\n  const scannerRef = useRef<Html5Qrcode | null>(null);\n  const processingRef = useRef<boolean>(false);\n  const scannerDivId = \"auto-qr-scanner\";\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData } = useQuery<any>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: recentCheckIns, refetch: refetchCheckIns } = useQuery<CheckInRecord[]>({\n    queryKey: [\"/api/admin/checkins\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n    refetchInterval: 10000,\n  });\n\n  const validateMutation = useMutation({\n    mutationFn: async (code: string) => {\n      const response = await apiRequest(\"POST\", \"/api/admin/checkin/validate\", { qrCode: code });\n      return await response.json();\n    },\n    onSuccess: (data) => {\n      setCheckInData(data);\n      setShowSuccessModal(true);\n      stopScanner();\n      refetchCheckIns();\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/dashboard\"] });\n      \n      setTimeout(() => {\n        startScanner();\n      }, 6000);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Validasi Gagal\",\n        description: error.message || \"QR code tidak valid atau sudah expired\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        processingRef.current = false;\n      }, 1000);\n    },\n  });\n\n  const startScanner = async () => {\n    try {\n      setIsScanning(true);\n      setCameraError(\"\");\n      processingRef.current = false;\n      \n      if (!scannerRef.current) {\n        scannerRef.current = new Html5Qrcode(scannerDivId);\n      }\n\n      const config = { \n        fps: 10, \n        qrbox: { width: 280, height: 280 },\n        aspectRatio: 1.0\n      };\n\n      await scannerRef.current.start(\n        { facingMode: \"environment\" },\n        config,\n        (decodedText) => {\n          if (processingRef.current) {\n            return;\n          }\n          \n          processingRef.current = true;\n          \n          let qrCodeValue = decodedText;\n          if (decodedText.includes('/checkin/verify/')) {\n            const parts = decodedText.split('/checkin/verify/');\n            qrCodeValue = parts[1] || decodedText;\n          } else if (decodedText.includes('/')) {\n            const parts = decodedText.split('/');\n            qrCodeValue = parts[parts.length - 1] || decodedText;\n          }\n          \n          validateMutation.mutate(qrCodeValue);\n        },\n        () => {}\n      );\n    } catch (err: any) {\n      console.error(\"Error starting scanner:\", err);\n      setCameraError(\"Tidak dapat mengakses kamera. Pastikan izin kamera sudah diberikan.\");\n      setIsScanning(false);\n    }\n  };\n\n  const stopScanner = async () => {\n    try {\n      if (scannerRef.current) {\n        const state = await scannerRef.current.getState();\n        if (state === 2) {\n          await scannerRef.current.stop();\n        }\n        await scannerRef.current.clear();\n        setIsScanning(false);\n      }\n    } catch (err) {\n      console.error(\"Error stopping scanner:\", err);\n      setIsScanning(false);\n    }\n  };\n\n  useEffect(() => {\n    if (isAuthenticated && user?.role === 'admin') {\n      const timer = setTimeout(() => {\n        startScanner();\n      }, 500);\n      \n      return () => {\n        clearTimeout(timer);\n        if (scannerRef.current) {\n          stopScanner();\n        }\n      };\n    }\n  }, [isAuthenticated, user]);\n\n  useEffect(() => {\n    return () => {\n      stopScanner();\n    };\n  }, []);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"flex flex-col items-center gap-2\">\n          <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n          <p className=\"text-xs text-muted-foreground\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-4 bg-[#0F172A] min-h-screen -m-6 p-6\">\n        {/* Header */}\n        <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-2\">\n          <div className=\"space-y-0\">\n            <div className=\"flex items-center gap-1.5\">\n              <h1 className=\"text-xl font-bold text-white\">\n                Check-ins\n              </h1>\n              <Activity className=\"w-4 h-4 text-[#10B981] animate-pulse\" />\n            </div>\n            <p className=\"text-gray-400 text-xs\">Monitor member check-in activity</p>\n          </div>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <Card className=\"border-0 bg-[#1E293B] shadow-xl\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-xs font-medium text-gray-400\">Today's Check-ins</p>\n                  <p className=\"text-2xl font-bold text-white mt-1\">\n                    {recentCheckIns?.filter(c => {\n                      const today = new Date();\n                      const checkInDate = new Date(c.checkInTime);\n                      return checkInDate.toDateString() === today.toDateString();\n                    }).length || 0}\n                  </p>\n                </div>\n                <div className=\"w-12 h-12 rounded-xl bg-[#10B981] flex items-center justify-center shadow-lg\">\n                  <CalendarCheck className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 bg-[#1E293B] shadow-xl\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-xs font-medium text-gray-400\">Total Check-ins</p>\n                  <p className=\"text-2xl font-bold text-white mt-1\">\n                    {recentCheckIns?.length || 0}\n                  </p>\n                </div>\n                <div className=\"w-12 h-12 rounded-xl bg-blue-500 flex items-center justify-center shadow-lg\">\n                  <Activity className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-0 bg-[#1E293B] shadow-xl\">\n            <CardContent className=\"p-4\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <p className=\"text-xs font-medium text-gray-400\">Active Members</p>\n                  <p className=\"text-2xl font-bold text-white mt-1\">\n                    {stats.activeToday || 0}\n                  </p>\n                </div>\n                <div className=\"w-12 h-12 rounded-xl bg-purple-500 flex items-center justify-center shadow-lg\">\n                  <Sparkles className=\"text-white\" size={20} />\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Auto Camera Section */}\n        <Card className=\"border-0 bg-[#1E293B] shadow-xl\">\n          <CardContent className=\"p-6\">\n            <div className=\"text-center space-y-4\">\n              <div className=\"flex items-center justify-center gap-2 mb-4\">\n                <Camera className=\"w-5 h-5 text-[#10B981]\" />\n                <h2 className=\"text-lg font-bold text-white\">Auto Check-in Camera</h2>\n              </div>\n              <p className=\"text-sm text-gray-400 mb-4\">\n                Arahkan QR code member ke kamera untuk check-in otomatis\n              </p>\n              \n              <div className=\"relative max-w-md mx-auto\">\n                <div \n                  id={scannerDivId} \n                  className=\"w-full rounded-2xl overflow-hidden border-4 border-[#10B981] shadow-2xl\"\n                  data-testid=\"div-auto-scanner\"\n                />\n                \n                {isScanning && !cameraError && (\n                  <div className=\"absolute bottom-4 left-0 right-0 flex justify-center\">\n                    <div className=\"bg-black/80 backdrop-blur-sm px-4 py-2 rounded-full flex items-center gap-2\">\n                      <Loader2 className=\"w-4 h-4 text-[#10B981] animate-spin\" />\n                      <span className=\"text-xs text-white\">Scanning...</span>\n                    </div>\n                  </div>\n                )}\n                \n                {cameraError && (\n                  <div className=\"bg-[#1E293B] rounded-2xl p-8 border-2 border-red-500\">\n                    <div className=\"text-center space-y-3\">\n                      <Camera className=\"w-12 h-12 text-red-500 mx-auto\" />\n                      <p className=\"text-sm text-red-400\">{cameraError}</p>\n                      <Button \n                        onClick={startScanner}\n                        size=\"sm\"\n                        className=\"bg-[#10B981] hover:bg-[#0ea570] text-white\"\n                        data-testid=\"button-retry-camera\"\n                      >\n                        <Camera className=\"mr-2 h-4 w-4\" />\n                        Gunakan Kamera Manual\n                      </Button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Check-ins List */}\n        <Card className=\"border-0 bg-[#1E293B] shadow-xl\">\n          <CardHeader className=\"pb-3 px-4 pt-4\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 rounded-lg bg-[#10B981] flex items-center justify-center\">\n                <Clock className=\"w-4 h-4 text-white\" />\n              </div>\n              <div>\n                <CardTitle className=\"text-base text-white\">Recent Check-ins</CardTitle>\n                <p className=\"text-xs text-gray-400 mt-0\">Complete history</p>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent className=\"px-4 pb-4\">\n            {!recentCheckIns || recentCheckIns.length === 0 ? (\n              <div className=\"text-center py-12\">\n                <div className=\"w-16 h-16 mx-auto mb-3 rounded-full bg-[#10B981]/10 flex items-center justify-center\">\n                  <Camera className=\"w-8 h-8 text-gray-500\" />\n                </div>\n                <p className=\"text-sm font-medium text-white mb-1\">No check-ins yet</p>\n                <p className=\"text-xs text-gray-400\">Check-ins will appear here</p>\n              </div>\n            ) : (\n              <div className=\"space-y-2\">\n                {recentCheckIns.map((checkin) => (\n                  <div \n                    key={checkin.id} \n                    className=\"group flex items-center justify-between p-3 rounded-xl bg-[#0F172A] hover:bg-[#0F172A]/80 transition-all border border-gray-700 hover:border-[#10B981] cursor-pointer\"\n                    data-testid={`checkin-${checkin.id}`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"relative\">\n                        <Avatar className=\"h-10 w-10 border-2 border-[#10B981] shadow-lg\">\n                          <AvatarImage src={checkin.user?.profileImageUrl} />\n                          <AvatarFallback className=\"bg-[#10B981] text-white font-semibold text-sm\">\n                            {`${checkin.user?.firstName?.[0] || ''}${checkin.user?.lastName?.[0] || ''}` || 'U'}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div className=\"absolute -bottom-1 -right-1 w-4 h-4 bg-[#10B981] rounded-full border-2 border-[#0F172A] flex items-center justify-center\">\n                          <CalendarCheck className=\"w-2.5 h-2.5 text-white\" />\n                        </div>\n                      </div>\n                      <div>\n                        <p className=\"font-semibold text-sm text-white group-hover:text-[#10B981] transition-colors\">\n                          {checkin.user?.firstName} {checkin.user?.lastName}\n                        </p>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <Badge className=\"text-xs font-medium bg-[#10B981]/20 text-[#10B981] border-[#10B981]/30\">\n                            {checkin.membership?.plan?.name || 'No Plan'}\n                          </Badge>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"text-right\">\n                      <div className=\"flex items-center gap-1 justify-end\">\n                        <Clock size={14} className=\"text-gray-400\" />\n                        <p className=\"font-semibold text-white text-sm\">\n                          {format(new Date(checkin.checkInTime), 'HH:mm')}\n                        </p>\n                      </div>\n                      <p className=\"text-xs text-gray-400 mt-0.5\">\n                        {format(new Date(checkin.checkInTime), 'dd MMM yyyy')}\n                      </p>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Success Modal Pop-up */}\n      {showSuccessModal && checkInData && (\n        <div \n          className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-300\"\n          onClick={() => setShowSuccessModal(false)}\n          data-testid=\"modal-success-overlay\"\n        >\n          <div \n            className=\"bg-[#1E293B] rounded-2xl shadow-2xl border-2 border-[#10B981] w-full max-w-[400px] h-[500px] overflow-auto animate-in slide-in-from-bottom-4 duration-300\"\n            onClick={(e) => e.stopPropagation()}\n            data-testid=\"modal-success-content\"\n          >\n            {/* Close Button */}\n            <button\n              onClick={() => setShowSuccessModal(false)}\n              className=\"absolute top-4 right-4 w-8 h-8 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors z-10\"\n              data-testid=\"button-close-modal\"\n            >\n              <X className=\"w-4 h-4 text-white\" />\n            </button>\n\n            {/* Header */}\n            <div className=\"bg-gradient-to-r from-[#10B981] to-emerald-500 px-6 py-6 text-center relative\">\n              <div className=\"w-20 h-20 mx-auto mb-3 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center\">\n                <CalendarCheck className=\"w-10 h-10 text-white\" />\n              </div>\n              <h3 className=\"text-2xl font-bold text-white\">Check-in Berhasil!</h3>\n              <p className=\"text-sm text-white/90 mt-1\">\n                âœ… {checkInData.checkInTime ? format(new Date(checkInData.checkInTime), \"HH:mm | dd MMM yyyy\") : format(new Date(), \"HH:mm | dd MMM yyyy\")}\n              </p>\n            </div>\n\n            {/* Member Info */}\n            <div className=\"p-6 space-y-4\">\n              <div className=\"flex items-center gap-4\">\n                <Avatar className=\"w-20 h-20 border-4 border-[#10B981] shadow-lg\">\n                  <AvatarImage src={checkInData.user?.profileImageUrl} />\n                  <AvatarFallback className=\"bg-[#10B981] text-white font-bold text-xl\">\n                    {`${checkInData.user?.firstName?.[0] || ''}${checkInData.user?.lastName?.[0] || ''}`}\n                  </AvatarFallback>\n                </Avatar>\n                <div className=\"flex-1\">\n                  <h4 className=\"text-xl font-bold text-white\" data-testid=\"text-member-name\">\n                    {checkInData.user?.firstName} {checkInData.user?.lastName}\n                  </h4>\n                  <p className=\"text-sm text-gray-400 mt-1\" data-testid=\"text-member-email\">\n                    {checkInData.user?.email}\n                  </p>\n                </div>\n              </div>\n\n              {/* Membership Info */}\n              {checkInData.membership && (\n                <div className=\"bg-[#0F172A] rounded-xl p-4 border border-gray-700\">\n                  <div className=\"flex items-center justify-between mb-3\">\n                    <span className=\"text-sm font-medium text-gray-400\">Membership</span>\n                    <Badge className=\"bg-[#10B981]/20 text-[#10B981] border-[#10B981]/30 text-xs\">\n                      {checkInData.membership.plan?.name}\n                    </Badge>\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-xs text-gray-400\">Berlaku Hingga</span>\n                    <span className=\"text-sm font-semibold text-white\" data-testid=\"text-membership-expiry\">\n                      {format(new Date(checkInData.membership.endDate), \"dd MMM yyyy\")}\n                    </span>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </AdminLayout>\n  );\n}\n","size_bytes":18871},"client/src/pages/admin-classes.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport AdminClassDialog from \"@/components/admin-class-dialog\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Plus, Edit, Trash2, Users, Calendar } from \"lucide-react\";\nimport type { GymClass } from \"@shared/schema\";\n\nexport default function AdminClasses() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [showClassDialog, setShowClassDialog] = useState(false);\n  const [selectedClass, setSelectedClass] = useState<GymClass | null>(null);\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData } = useQuery<any>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: gymClasses } = useQuery<GymClass[]>({\n    queryKey: [\"/api/admin/classes\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  const handleAddClass = () => {\n    setSelectedClass(null);\n    setShowClassDialog(true);\n  };\n\n  const handleEditClass = (gymClass: GymClass) => {\n    setSelectedClass(gymClass);\n    setShowClassDialog(true);\n  };\n\n  const handleDeleteClass = async (classId: string) => {\n    if (!confirm(\"Are you sure you want to delete this class?\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/classes/${classId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/classes\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/classes\"] });\n      toast({\n        title: \"Success!\",\n        description: \"Class has been deleted\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete class\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Gym Classes</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage gym classes and schedules</p>\n          </div>\n          <Button \n            className=\"gym-gradient text-white\" \n            onClick={handleAddClass}\n            data-testid=\"button-add-class\"\n          >\n            <Plus className=\"mr-2\" size={16} />\n            Add New Class\n          </Button>\n        </div>\n\n        {/* Classes Grid */}\n        {!gymClasses || gymClasses.length === 0 ? (\n          <Card>\n            <CardContent className=\"py-12\">\n              <p className=\"text-center text-muted-foreground\">No classes available</p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {gymClasses.map((gymClass) => (\n              <Card key={gymClass.id} className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <div className=\"flex justify-between items-start\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-xl\">{gymClass.name}</CardTitle>\n                      <p className=\"text-sm text-muted-foreground mt-1\">\n                        {gymClass.instructorName}\n                      </p>\n                    </div>\n                    <Badge variant={gymClass.active ? \"default\" : \"secondary\"}>\n                      {gymClass.active ? \"Active\" : \"Inactive\"}\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                    {gymClass.description || \"No description\"}\n                  </p>\n                  \n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Calendar size={16} className=\"text-muted-foreground\" />\n                    <span className=\"text-foreground\">{gymClass.schedule}</span>\n                  </div>\n\n                  <div className=\"flex items-center gap-2 text-sm\">\n                    <Users size={16} className=\"text-muted-foreground\" />\n                    <span className=\"text-foreground\">\n                      {gymClass.currentEnrollment || 0} / {gymClass.maxCapacity} enrolled\n                    </span>\n                  </div>\n\n                  <div className=\"flex gap-2 pt-4 border-t\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"flex-1\"\n                      onClick={() => handleEditClass(gymClass)}\n                      data-testid={`button-edit-class-${gymClass.id}`}\n                    >\n                      <Edit size={16} className=\"mr-2\" />\n                      Edit\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDeleteClass(gymClass.id)}\n                      data-testid={`button-delete-class-${gymClass.id}`}\n                    >\n                      <Trash2 size={16} className=\"text-destructive\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Class Dialog */}\n      <AdminClassDialog\n        open={showClassDialog}\n        onOpenChange={setShowClassDialog}\n        gymClass={selectedClass}\n      />\n    </AdminLayout>\n  );\n}\n","size_bytes":6689},"client/src/components/ui/admin-layout.tsx":{"content":"import { useState } from \"react\";\nimport AdminSidebar from \"./admin-sidebar\";\nimport { Button } from \"@/components/ui/button\";\nimport { Menu, Bell, LogOut, User } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\ninterface AdminLayoutProps {\n  user?: any;\n  notificationCount?: number;\n  children: React.ReactNode;\n}\n\nexport default function AdminLayout({ user, notificationCount = 0, children }: AdminLayoutProps) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n  const [sidebarCollapsed, setSidebarCollapsed] = useState(false);\n\n  const handleLogout = async () => {\n    try {\n      await apiRequest(\"POST\", \"/api/logout\");\n      queryClient.clear();\n      window.location.href = \"/login-admin\";\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n      queryClient.clear();\n      window.location.href = \"/login-admin\";\n    }\n  };\n\n  const getUserInitials = () => {\n    if (!user) return \"AD\";\n    const first = user.firstName?.[0] || \"\";\n    const last = user.lastName?.[0] || \"\";\n    return (first + last).toUpperCase() || \"AD\";\n  };\n\n  return (\n    <div className=\"flex h-screen overflow-hidden bg-background\">\n      <AdminSidebar \n        isOpen={sidebarOpen} \n        onClose={() => setSidebarOpen(false)}\n        isCollapsed={sidebarCollapsed}\n        onToggleCollapse={() => setSidebarCollapsed(!sidebarCollapsed)}\n      />\n      \n      <div className=\"flex-1 flex flex-col overflow-hidden\">\n        {/* Modern Top Bar */}\n        <header className=\"h-16 border-b border-border bg-card/50 backdrop-blur-xl flex items-center justify-between px-4 lg:px-6 z-10 sticky top-0\">\n          <div className=\"flex items-center gap-4\">\n            {/* Hamburger Menu */}\n            <button\n              onClick={() => setSidebarOpen(!sidebarOpen)}\n              className=\"lg:hidden p-2 hover:bg-muted rounded-lg transition-all duration-200 hover:scale-105 active:scale-95\"\n              data-testid=\"button-toggle-sidebar\"\n            >\n              <Menu className=\"h-5 w-5 text-foreground\" />\n            </button>\n\n            {/* Page Title */}\n            <div className=\"hidden sm:block\">\n              <h1 className=\"text-lg font-bold text-foreground\">\n                Gym Management\n              </h1>\n              <p className=\"text-xs text-muted-foreground\">\n                Control panel for fitness operations\n              </p>\n            </div>\n          </div>\n          \n          {/* Right Side Actions */}\n          <div className=\"flex items-center gap-2\">\n            {/* Notifications */}\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              className=\"relative rounded-lg hover:bg-muted transition-all duration-200 hover:scale-105 active:scale-95\"\n              data-testid=\"button-notifications\"\n            >\n              <Bell className=\"h-5 w-5 text-muted-foreground hover:text-foreground transition-colors\" />\n              {notificationCount > 0 && (\n                <span className=\"absolute -top-1 -right-1 h-5 w-5 bg-primary rounded-full text-[10px] text-primary-foreground flex items-center justify-center font-bold animate-scale-in\">\n                  {notificationCount > 9 ? '9+' : notificationCount}\n                </span>\n              )}\n            </Button>\n\n            {/* User Menu */}\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button \n                  variant=\"ghost\" \n                  className=\"relative h-10 rounded-lg hover:bg-muted transition-all duration-200 hover:scale-105 active:scale-95 px-2\"\n                  data-testid=\"button-user-menu\"\n                >\n                  <div className=\"flex items-center gap-2\">\n                    <Avatar className=\"h-8 w-8 border-2 border-primary/20\">\n                      <AvatarImage src={user?.profileImageUrl} alt={user?.firstName} />\n                      <AvatarFallback className=\"bg-primary/10 text-primary text-xs font-bold\">\n                        {getUserInitials()}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"hidden md:flex flex-col items-start\">\n                      <span className=\"text-sm font-medium text-foreground\">\n                        {user?.firstName || 'Admin'}\n                      </span>\n                      <span className=\"text-xs text-muted-foreground\">\n                        Administrator\n                      </span>\n                    </div>\n                  </div>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent align=\"end\" className=\"w-56 animate-slide-in\">\n                <DropdownMenuLabel>\n                  <div className=\"flex flex-col space-y-1\">\n                    <p className=\"text-sm font-medium\">{user?.firstName} {user?.lastName}</p>\n                    <p className=\"text-xs text-muted-foreground\">{user?.email}</p>\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem className=\"cursor-pointer\">\n                  <User className=\"mr-2 h-4 w-4\" />\n                  <span>Profile Settings</span>\n                </DropdownMenuItem>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem \n                  onClick={handleLogout}\n                  className=\"cursor-pointer text-destructive focus:text-destructive\"\n                  data-testid=\"button-logout\"\n                >\n                  <LogOut className=\"mr-2 h-4 w-4\" />\n                  <span>Log Out</span>\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          </div>\n        </header>\n\n        {/* Main Content */}\n        <main className=\"flex-1 overflow-y-auto bg-background\">\n          <div className=\"p-4 sm:p-6 lg:p-8 max-w-[1800px] mx-auto animate-fade-in\">\n            {children}\n          </div>\n        </main>\n      </div>\n    </div>\n  );\n}\n","size_bytes":6260},"client/src/pages/admin-feedback.tsx":{"content":"import { useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport { Star, MessageSquare } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface FeedbackRecord {\n  id: string;\n  subject?: string;\n  message: string;\n  rating?: number;\n  category?: string;\n  createdAt: string;\n  member?: {\n    firstName?: string;\n    lastName?: string;\n    email?: string;\n    profileImageUrl?: string;\n  };\n}\n\nexport default function AdminFeedback() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData } = useQuery<any>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: feedbacks } = useQuery<FeedbackRecord[]>({\n    queryKey: [\"/api/admin/feedbacks\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  const getCategoryColor = (category?: string) => {\n    switch (category?.toLowerCase()) {\n      case 'facilities': return 'bg-blue-500/10 text-blue-600';\n      case 'service': return 'bg-green-500/10 text-green-600';\n      case 'equipment': return 'bg-orange-500/10 text-orange-600';\n      case 'staff': return 'bg-purple-500/10 text-purple-600';\n      default: return 'bg-gray-500/10 text-gray-600';\n    }\n  };\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div>\n          <h1 className=\"text-3xl font-bold text-foreground\">Member Feedback</h1>\n          <p className=\"text-muted-foreground mt-1\">Review member feedback and ratings</p>\n        </div>\n\n        {/* Feedback List */}\n        <div className=\"space-y-4\">\n          {!feedbacks || feedbacks.length === 0 ? (\n            <Card>\n              <CardContent className=\"py-12\">\n                <div className=\"text-center\">\n                  <MessageSquare className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\n                  <p className=\"text-muted-foreground\">No feedback yet</p>\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            feedbacks.map((feedback) => (\n              <Card key={feedback.id} className=\"hover:shadow-md transition-shadow\">\n                <CardHeader>\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex items-start gap-4 flex-1\">\n                      <Avatar className=\"h-12 w-12\">\n                        <AvatarImage src={feedback.member?.profileImageUrl} />\n                        <AvatarFallback>\n                          {`${feedback.member?.firstName?.[0] || ''}${feedback.member?.lastName?.[0] || ''}` || 'U'}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-3 mb-2\">\n                          <CardTitle className=\"text-lg\">\n                            {feedback.member?.firstName} {feedback.member?.lastName}\n                          </CardTitle>\n                          {feedback.rating && (\n                            <div className=\"flex items-center gap-1\">\n                              {[...Array(5)].map((_, i) => (\n                                <Star\n                                  key={i}\n                                  size={14}\n                                  className={i < feedback.rating! ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-300\"}\n                                />\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {feedback.member?.email}\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"flex flex-col items-end gap-2\">\n                      {feedback.category && (\n                        <Badge className={getCategoryColor(feedback.category)}>\n                          {feedback.category}\n                        </Badge>\n                      )}\n                      <p className=\"text-xs text-muted-foreground\">\n                        {format(new Date(feedback.createdAt), 'dd MMM yyyy, HH:mm')}\n                      </p>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent>\n                  {feedback.subject && (\n                    <p className=\"font-medium text-foreground mb-2\">{feedback.subject}</p>\n                  )}\n                  <p className=\"text-sm text-muted-foreground\">{feedback.message}</p>\n                </CardContent>\n              </Card>\n            ))\n          )}\n        </div>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":5975},"client/src/pages/admin-plans.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport AdminMembershipPlanDialog from \"@/components/admin-membership-plan-dialog\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Plus, Edit, Trash2, Check, DollarSign, Calendar } from \"lucide-react\";\nimport type { MembershipPlan } from \"@shared/schema\";\n\nexport default function AdminPlans() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [showPlanDialog, setShowPlanDialog] = useState(false);\n  const [selectedPlan, setSelectedPlan] = useState<MembershipPlan | null>(null);\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: dashboardData } = useQuery<any>({\n    queryKey: [\"/api/admin/dashboard\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: membershipPlans } = useQuery<MembershipPlan[]>({\n    queryKey: [\"/api/admin/membership-plans\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const stats = dashboardData?.stats || {};\n\n  const handleAddPlan = () => {\n    setSelectedPlan(null);\n    setShowPlanDialog(true);\n  };\n\n  const handleEditPlan = (plan: MembershipPlan) => {\n    setSelectedPlan(plan);\n    setShowPlanDialog(true);\n  };\n\n  const handleDeletePlan = async (planId: string) => {\n    if (!confirm(\"Are you sure you want to delete this membership plan?\")) {\n      return;\n    }\n\n    try {\n      await apiRequest(\"DELETE\", `/api/admin/membership-plans/${planId}`);\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/membership-plans\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/membership-plans\"] });\n      toast({\n        title: \"Success!\",\n        description: \"Membership plan has been deleted\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to delete membership plan\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <AdminLayout user={user} notificationCount={stats.expiringSoon || 0}>\n      <div className=\"space-y-6\">\n        {/* Header */}\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <h1 className=\"text-3xl font-bold text-foreground\">Membership Plans</h1>\n            <p className=\"text-muted-foreground mt-1\">Manage membership plans and pricing</p>\n          </div>\n          <Button \n            className=\"gym-gradient text-white\" \n            onClick={handleAddPlan}\n            data-testid=\"button-add-plan\"\n          >\n            <Plus className=\"mr-2\" size={16} />\n            Add New Plan\n          </Button>\n        </div>\n\n        {/* Plans Grid */}\n        {!membershipPlans || membershipPlans.length === 0 ? (\n          <Card>\n            <CardContent className=\"py-12\">\n              <p className=\"text-center text-muted-foreground\">No membership plans available</p>\n            </CardContent>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {membershipPlans.map((plan: MembershipPlan) => (\n              <Card key={plan.id} className=\"hover:shadow-lg transition-shadow\">\n                <CardHeader>\n                  <div className=\"flex justify-between items-start\">\n                    <div className=\"flex-1\">\n                      <CardTitle className=\"text-2xl\">{plan.name}</CardTitle>\n                    </div>\n                    <Badge variant={plan.active ? \"default\" : \"secondary\"}>\n                      {plan.active ? \"Active\" : \"Inactive\"}\n                    </Badge>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"text-center py-4\">\n                    <div className=\"flex items-baseline justify-center gap-2\">\n                      <DollarSign size={24} className=\"text-primary\" />\n                      <span className=\"text-4xl font-bold text-foreground\">{plan.price}</span>\n                      <span className=\"text-muted-foreground\">/{plan.durationMonths}mo</span>\n                    </div>\n                  </div>\n\n                  <p className=\"text-sm text-muted-foreground\">\n                    {plan.description || \"No description\"}\n                  </p>\n\n                  {plan.features && Array.isArray(plan.features) && plan.features.length > 0 && (\n                    <div className=\"space-y-2 py-2\">\n                      {(plan.features as string[]).slice(0, 4).map((feature: string, idx: number) => (\n                        <div key={idx} className=\"flex items-start gap-2\">\n                          <Check size={16} className=\"text-green-600 mt-0.5 flex-shrink-0\" />\n                          <span className=\"text-sm text-foreground\">{feature}</span>\n                        </div>\n                      ))}\n                      {plan.features.length > 4 && (\n                        <p className=\"text-xs text-muted-foreground pl-6\">\n                          +{plan.features.length - 4} more features\n                        </p>\n                      )}\n                    </div>\n                  )}\n\n                  <div className=\"flex gap-2 pt-4 border-t\">\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      className=\"flex-1\"\n                      onClick={() => handleEditPlan(plan)}\n                      data-testid={`button-edit-plan-${plan.id}`}\n                    >\n                      <Edit size={16} className=\"mr-2\" />\n                      Edit\n                    </Button>\n                    <Button\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => handleDeletePlan(plan.id)}\n                      data-testid={`button-delete-plan-${plan.id}`}\n                    >\n                      <Trash2 size={16} className=\"text-destructive\" />\n                    </Button>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Plan Dialog */}\n      <AdminMembershipPlanDialog\n        open={showPlanDialog}\n        onOpenChange={setShowPlanDialog}\n        plan={selectedPlan}\n      />\n    </AdminLayout>\n  );\n}\n","size_bytes":7329},"client/src/pages/checkin-verify.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useRoute } from \"wouter\";\nimport { CheckCircle, XCircle, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport default function CheckInVerify() {\n  const [, params] = useRoute(\"/checkin/verify/:code\");\n  const [status, setStatus] = useState<\"loading\" | \"success\" | \"error\">(\"loading\");\n  const [message, setMessage] = useState(\"\");\n  const [memberData, setMemberData] = useState<any>(null);\n\n  useEffect(() => {\n    const verifyCheckIn = async () => {\n      if (!params?.code) {\n        setStatus(\"error\");\n        setMessage(\"Kode QR tidak valid\");\n        return;\n      }\n\n      try {\n        const response = await fetch(\"/api/checkin/verify\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({ qrCode: params.code }),\n        });\n\n        const data = await response.json();\n\n        if (response.ok && data.success) {\n          setStatus(\"success\");\n          setMessage(\"Check-in berhasil!\");\n          setMemberData(data.user);\n        } else {\n          setStatus(\"error\");\n          setMessage(data.message || \"Check-in gagal\");\n          setMemberData(data.user);\n        }\n      } catch (error) {\n        setStatus(\"error\");\n        setMessage(\"Terjadi kesalahan saat check-in\");\n      }\n    };\n\n    verifyCheckIn();\n  }, [params?.code]);\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4\">\n      <div className=\"max-w-md w-full\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 text-center\">\n          {status === \"loading\" && (\n            <div className=\"flex flex-col items-center space-y-4\" data-testid=\"loading-state\">\n              <Loader2 className=\"w-20 h-20 text-blue-500 animate-spin\" />\n              <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-100\">\n                Memverifikasi...\n              </h2>\n              <p className=\"text-gray-600 dark:text-gray-400\">\n                Mohon tunggu sebentar\n              </p>\n            </div>\n          )}\n\n          {status === \"success\" && (\n            <div className=\"flex flex-col items-center space-y-6\" data-testid=\"success-state\">\n              <div className=\"relative\">\n                <div className=\"absolute inset-0 bg-green-400 rounded-full blur-xl opacity-50 animate-pulse\"></div>\n                <div className=\"relative bg-green-500 rounded-full p-6\">\n                  <CheckCircle className=\"w-20 h-20 text-white\" data-testid=\"icon-success\" />\n                </div>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <h1 className=\"text-3xl font-bold text-green-600 dark:text-green-400\" data-testid=\"text-success-title\">\n                  CHECK IN BERHASIL\n                </h1>\n                <p className=\"text-lg text-gray-700 dark:text-gray-300\">\n                  {message}\n                </p>\n              </div>\n\n              {memberData && (\n                <div className=\"w-full bg-green-50 dark:bg-green-950/20 rounded-lg p-4 border border-green-200 dark:border-green-800\">\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Member</p>\n                  <p className=\"text-lg font-semibold text-gray-800 dark:text-gray-100\" data-testid=\"text-member-name\">\n                    {memberData.firstName} {memberData.lastName}\n                  </p>\n                </div>\n              )}\n\n              <p className=\"text-sm text-gray-500 dark:text-gray-400\">\n                Selamat berolahraga! ðŸ’ª\n              </p>\n            </div>\n          )}\n\n          {status === \"error\" && (\n            <div className=\"flex flex-col items-center space-y-6\" data-testid=\"error-state\">\n              <div className=\"relative\">\n                <div className=\"absolute inset-0 bg-red-400 rounded-full blur-xl opacity-50\"></div>\n                <div className=\"relative bg-red-500 rounded-full p-6\">\n                  <XCircle className=\"w-20 h-20 text-white\" data-testid=\"icon-error\" />\n                </div>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <h1 className=\"text-3xl font-bold text-red-600 dark:text-red-400\" data-testid=\"text-error-title\">\n                  CHECK IN GAGAL\n                </h1>\n                <p className=\"text-lg text-gray-700 dark:text-gray-300\">\n                  {message}\n                </p>\n              </div>\n\n              {memberData && (\n                <div className=\"w-full bg-red-50 dark:bg-red-950/20 rounded-lg p-4 border border-red-200 dark:border-red-800\">\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">Member</p>\n                  <p className=\"text-lg font-semibold text-gray-800 dark:text-gray-100\">\n                    {memberData.firstName} {memberData.lastName}\n                  </p>\n                </div>\n              )}\n\n              <Button\n                onClick={() => window.location.href = \"/login\"}\n                className=\"gym-gradient text-white\"\n                data-testid=\"button-back-to-login\"\n              >\n                Kembali ke Login\n              </Button>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5409},"client/src/pages/admin-class-bookings.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Calendar, Clock, User, Search, CheckCircle, XCircle, Users, Ban } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface ClassBooking {\n  id: string;\n  userId: string;\n  classId: string;\n  bookingDate: string;\n  status: string;\n  createdAt: string;\n  user: {\n    id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone?: string;\n  };\n  gymClass: {\n    id: string;\n    name: string;\n    description?: string;\n    instructor: string;\n    schedule: string;\n    capacity: number;\n    currentEnrollment: number;\n  };\n}\n\nexport default function AdminClassBookings() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [statusFilter, setStatusFilter] = useState(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: bookings, isLoading: bookingsLoading } = useQuery<ClassBooking[]>({\n    queryKey: [\"/api/admin/class-bookings\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: ({ id, status }: { id: string; status: string }) =>\n      apiRequest(\"PUT\", `/api/admin/class-bookings/${id}`, { status }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/class-bookings\"] });\n      toast({\n        title: \"Success\",\n        description: \"Class booking status updated successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update class booking status\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const cancelBookingMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(\"DELETE\", `/api/admin/class-bookings/${id}`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/class-bookings\"] });\n      toast({\n        title: \"Success\",\n        description: \"Class booking cancelled successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to cancel class booking\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  if (isLoading || bookingsLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const filteredBookings = bookings?.filter((booking) => {\n    const matchesSearch = !searchTerm || \n      booking.user.firstName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.user.lastName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.user.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.gymClass.name?.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesFilter = statusFilter === \"all\" || booking.status === statusFilter;\n\n    return matchesSearch && matchesFilter;\n  }) || [];\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"booked\": return <CheckCircle className=\"w-4 h-4\" />;\n      case \"attended\": return <CheckCircle className=\"w-4 h-4\" />;\n      case \"cancelled\": return <XCircle className=\"w-4 h-4\" />;\n      default: return <Clock className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getStatusVariant = (status: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n    switch (status) {\n      case \"booked\": return \"default\";\n      case \"attended\": return \"secondary\";\n      case \"cancelled\": return \"destructive\";\n      default: return \"outline\";\n    }\n  };\n\n  const handleStatusChange = (bookingId: string, newStatus: string) => {\n    updateStatusMutation.mutate({ id: bookingId, status: newStatus });\n  };\n\n  const handleCancelBooking = (bookingId: string) => {\n    if (!confirm(\"Apakah Anda yakin ingin membatalkan booking ini?\")) {\n      return;\n    }\n    cancelBookingMutation.mutate(bookingId);\n  };\n\n  const stats = {\n    total: bookings?.length || 0,\n    booked: bookings?.filter(b => b.status === 'booked').length || 0,\n    attended: bookings?.filter(b => b.status === 'attended').length || 0,\n    cancelled: bookings?.filter(b => b.status === 'cancelled').length || 0,\n  };\n\n  return (\n    <AdminLayout user={user}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"text-page-title\">Class Bookings Management</h1>\n            <p className=\"text-muted-foreground\">Kelola semua booking kelas gym</p>\n          </div>\n        </div>\n\n        <div className=\"grid gap-4 md:grid-cols-4\">\n          <Card data-testid=\"card-total-bookings\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Bookings</CardTitle>\n              <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">{stats.total}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-booked\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Booked</CardTitle>\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\" data-testid=\"text-booked-count\">{stats.booked}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-attended\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Attended</CardTitle>\n              <CheckCircle className=\"h-4 w-4 text-blue-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-600\" data-testid=\"text-attended-count\">{stats.attended}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-cancelled\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Cancelled</CardTitle>\n              <XCircle className=\"h-4 w-4 text-red-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-red-600\" data-testid=\"text-cancelled-count\">{stats.cancelled}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between\">\n              <CardTitle>All Class Bookings</CardTitle>\n              <div className=\"flex gap-4 w-full md:w-auto\">\n                <div className=\"relative flex-1 md:w-64\">\n                  <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                  <Input\n                    placeholder=\"Cari member atau kelas...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"pl-8\"\n                    data-testid=\"input-search\"\n                  />\n                </div>\n                <Select value={statusFilter} onValueChange={setStatusFilter}>\n                  <SelectTrigger className=\"w-[180px]\" data-testid=\"select-status-filter\">\n                    <SelectValue placeholder=\"Filter Status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">Semua Status</SelectItem>\n                    <SelectItem value=\"booked\">Booked</SelectItem>\n                    <SelectItem value=\"attended\">Attended</SelectItem>\n                    <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"rounded-md border\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Member</TableHead>\n                    <TableHead>Kelas</TableHead>\n                    <TableHead>Instructor</TableHead>\n                    <TableHead>Tanggal Booking</TableHead>\n                    <TableHead>Kapasitas</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead className=\"text-right\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredBookings.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={7} className=\"text-center py-8 text-muted-foreground\">\n                        Tidak ada booking ditemukan\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    filteredBookings.map((booking) => (\n                      <TableRow key={booking.id} data-testid={`row-booking-${booking.id}`}>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            <User className=\"h-4 w-4 text-muted-foreground\" />\n                            <div>\n                              <div className=\"font-medium\" data-testid={`text-member-name-${booking.id}`}>\n                                {booking.user.firstName} {booking.user.lastName}\n                              </div>\n                              <div className=\"text-sm text-muted-foreground\">{booking.user.email}</div>\n                            </div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div>\n                            <div className=\"font-medium\" data-testid={`text-class-name-${booking.id}`}>{booking.gymClass.name}</div>\n                            <div className=\"text-sm text-muted-foreground\">{booking.gymClass.schedule}</div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"font-medium\" data-testid={`text-instructor-${booking.id}`}>\n                            {booking.gymClass.instructor}\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                            <span data-testid={`text-booking-date-${booking.id}`}>\n                              {format(new Date(booking.bookingDate), 'dd MMM yyyy')}\n                            </span>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Users className=\"h-4 w-4 text-muted-foreground\" />\n                            <span data-testid={`text-capacity-${booking.id}`}>\n                              {booking.gymClass.currentEnrollment}/{booking.gymClass.capacity}\n                            </span>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <Badge variant={getStatusVariant(booking.status)} className=\"flex items-center gap-1 w-fit\" data-testid={`badge-status-${booking.id}`}>\n                            {getStatusIcon(booking.status)}\n                            {booking.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <div className=\"flex items-center gap-2 justify-end\">\n                            <Select\n                              value={booking.status}\n                              onValueChange={(value) => handleStatusChange(booking.id, value)}\n                              disabled={updateStatusMutation.isPending || booking.status === 'cancelled'}\n                            >\n                              <SelectTrigger className=\"w-[130px]\" data-testid={`select-status-${booking.id}`}>\n                                <SelectValue />\n                              </SelectTrigger>\n                              <SelectContent>\n                                <SelectItem value=\"booked\">Booked</SelectItem>\n                                <SelectItem value=\"attended\">Attended</SelectItem>\n                                <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                              </SelectContent>\n                            </Select>\n                            {booking.status !== 'cancelled' && (\n                              <Button\n                                variant=\"ghost\"\n                                size=\"icon\"\n                                onClick={() => handleCancelBooking(booking.id)}\n                                disabled={cancelBookingMutation.isPending}\n                                data-testid={`button-cancel-${booking.id}`}\n                              >\n                                <Ban className=\"h-4 w-4 text-red-600\" />\n                              </Button>\n                            )}\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":15022},"client/src/pages/admin-pt-bookings.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Calendar, Clock, User, Search, CheckCircle, XCircle, Timer, Ban } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface PTBooking {\n  id: string;\n  userId: string;\n  trainerId: string;\n  bookingDate: string;\n  duration: number;\n  sessionCount: number;\n  status: string;\n  notes?: string;\n  createdAt: string;\n  user: {\n    id: string;\n    firstName: string;\n    lastName: string;\n    email: string;\n    phone?: string;\n  };\n  trainer: {\n    id: string;\n    name: string;\n    specialization: string;\n  };\n}\n\nexport default function AdminPTBookings() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [statusFilter, setStatusFilter] = useState(\"all\");\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: bookings, isLoading: bookingsLoading } = useQuery<PTBooking[]>({\n    queryKey: [\"/api/admin/pt-bookings\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: ({ id, status }: { id: string; status: string }) =>\n      apiRequest(\"PUT\", `/api/admin/pt-bookings/${id}`, { status }),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/pt-bookings\"] });\n      toast({\n        title: \"Success\",\n        description: \"PT booking status updated successfully\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Failed to update PT booking status\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  if (isLoading || bookingsLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const filteredBookings = bookings?.filter((booking) => {\n    const matchesSearch = !searchTerm || \n      booking.user.firstName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.user.lastName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.user.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      booking.trainer.name?.toLowerCase().includes(searchTerm.toLowerCase());\n    \n    const matchesFilter = statusFilter === \"all\" || booking.status === statusFilter;\n\n    return matchesSearch && matchesFilter;\n  }) || [];\n\n  const getStatusIcon = (status: string) => {\n    switch (status) {\n      case \"confirmed\": return <CheckCircle className=\"w-4 h-4\" />;\n      case \"completed\": return <CheckCircle className=\"w-4 h-4\" />;\n      case \"pending\": return <Timer className=\"w-4 h-4\" />;\n      case \"cancelled\": return <XCircle className=\"w-4 h-4\" />;\n      default: return <Clock className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getStatusVariant = (status: string): \"default\" | \"secondary\" | \"destructive\" | \"outline\" => {\n    switch (status) {\n      case \"confirmed\": return \"default\";\n      case \"completed\": return \"secondary\";\n      case \"pending\": return \"outline\";\n      case \"cancelled\": return \"destructive\";\n      default: return \"outline\";\n    }\n  };\n\n  const handleStatusChange = (bookingId: string, newStatus: string) => {\n    updateStatusMutation.mutate({ id: bookingId, status: newStatus });\n  };\n\n  const stats = {\n    total: bookings?.length || 0,\n    pending: bookings?.filter(b => b.status === 'pending').length || 0,\n    confirmed: bookings?.filter(b => b.status === 'confirmed').length || 0,\n    completed: bookings?.filter(b => b.status === 'completed').length || 0,\n    cancelled: bookings?.filter(b => b.status === 'cancelled').length || 0,\n  };\n\n  return (\n    <AdminLayout user={user}>\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight\" data-testid=\"text-page-title\">PT Bookings Management</h1>\n            <p className=\"text-muted-foreground\">Kelola semua booking Personal Trainer</p>\n          </div>\n        </div>\n\n        <div className=\"grid gap-4 md:grid-cols-4\">\n          <Card data-testid=\"card-total-bookings\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Total Bookings</CardTitle>\n              <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\" data-testid=\"text-total-count\">{stats.total}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-pending-bookings\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Pending</CardTitle>\n              <Timer className=\"h-4 w-4 text-yellow-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-yellow-600\" data-testid=\"text-pending-count\">{stats.pending}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-confirmed-bookings\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Confirmed</CardTitle>\n              <CheckCircle className=\"h-4 w-4 text-green-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-green-600\" data-testid=\"text-confirmed-count\">{stats.confirmed}</div>\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-completed-bookings\">\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Completed</CardTitle>\n              <CheckCircle className=\"h-4 w-4 text-blue-600\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold text-blue-600\" data-testid=\"text-completed-count\">{stats.completed}</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <div className=\"flex flex-col md:flex-row gap-4 items-start md:items-center justify-between\">\n              <CardTitle>All PT Bookings</CardTitle>\n              <div className=\"flex gap-4 w-full md:w-auto\">\n                <div className=\"relative flex-1 md:w-64\">\n                  <Search className=\"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground\" />\n                  <Input\n                    placeholder=\"Cari member atau trainer...\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    className=\"pl-8\"\n                    data-testid=\"input-search\"\n                  />\n                </div>\n                <Select value={statusFilter} onValueChange={setStatusFilter}>\n                  <SelectTrigger className=\"w-[180px]\" data-testid=\"select-status-filter\">\n                    <SelectValue placeholder=\"Filter Status\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">Semua Status</SelectItem>\n                    <SelectItem value=\"pending\">Pending</SelectItem>\n                    <SelectItem value=\"confirmed\">Confirmed</SelectItem>\n                    <SelectItem value=\"completed\">Completed</SelectItem>\n                    <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"rounded-md border\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Member</TableHead>\n                    <TableHead>Trainer</TableHead>\n                    <TableHead>Tanggal & Waktu</TableHead>\n                    <TableHead>Durasi</TableHead>\n                    <TableHead>Jumlah Sesi</TableHead>\n                    <TableHead>Status</TableHead>\n                    <TableHead>Notes</TableHead>\n                    <TableHead className=\"text-right\">Actions</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {filteredBookings.length === 0 ? (\n                    <TableRow>\n                      <TableCell colSpan={8} className=\"text-center py-8 text-muted-foreground\">\n                        Tidak ada booking ditemukan\n                      </TableCell>\n                    </TableRow>\n                  ) : (\n                    filteredBookings.map((booking) => (\n                      <TableRow key={booking.id} data-testid={`row-booking-${booking.id}`}>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            <User className=\"h-4 w-4 text-muted-foreground\" />\n                            <div>\n                              <div className=\"font-medium\" data-testid={`text-member-name-${booking.id}`}>\n                                {booking.user.firstName} {booking.user.lastName}\n                              </div>\n                              <div className=\"text-sm text-muted-foreground\">{booking.user.email}</div>\n                            </div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div>\n                            <div className=\"font-medium\" data-testid={`text-trainer-name-${booking.id}`}>{booking.trainer.name}</div>\n                            <div className=\"text-sm text-muted-foreground\">{booking.trainer.specialization}</div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-2\">\n                            <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                            <div>\n                              <div className=\"font-medium\" data-testid={`text-booking-date-${booking.id}`}>\n                                {format(new Date(booking.bookingDate), 'dd MMM yyyy')}\n                              </div>\n                              <div className=\"text-sm text-muted-foreground\">\n                                {format(new Date(booking.bookingDate), 'HH:mm')}\n                              </div>\n                            </div>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex items-center gap-1\">\n                            <Clock className=\"h-4 w-4 text-muted-foreground\" />\n                            <span data-testid={`text-duration-${booking.id}`}>{booking.duration} menit</span>\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"text-center font-medium\" data-testid={`text-session-count-${booking.id}`}>\n                            {booking.sessionCount || 1} sesi\n                          </div>\n                        </TableCell>\n                        <TableCell>\n                          <Badge variant={getStatusVariant(booking.status)} className=\"flex items-center gap-1 w-fit\" data-testid={`badge-status-${booking.id}`}>\n                            {getStatusIcon(booking.status)}\n                            {booking.status}\n                          </Badge>\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"text-sm text-muted-foreground max-w-[200px] truncate\" data-testid={`text-notes-${booking.id}`}>\n                            {booking.notes || '-'}\n                          </div>\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <Select\n                            value={booking.status}\n                            onValueChange={(value) => handleStatusChange(booking.id, value)}\n                            disabled={updateStatusMutation.isPending}\n                          >\n                            <SelectTrigger className=\"w-[130px] ml-auto\" data-testid={`select-status-${booking.id}`}>\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"pending\">Pending</SelectItem>\n                              <SelectItem value=\"confirmed\">Confirmed</SelectItem>\n                              <SelectItem value=\"completed\">Completed</SelectItem>\n                              <SelectItem value=\"cancelled\">Cancelled</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </TableCell>\n                      </TableRow>\n                    ))\n                  )}\n                </TableBody>\n              </Table>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":14397},"client/src/pages/cookie-settings.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Separator } from '@/components/ui/separator';\nimport { ArrowLeft, Cookie, Shield, BarChart3, Megaphone, Settings as SettingsIcon } from 'lucide-react';\nimport { Link } from 'wouter';\nimport { useToast } from '@/hooks/use-toast';\nimport {\n  getCookiePreferences,\n  setCookiePreferences,\n  setConsent,\n  applyAnalyticsCookies,\n  applyMarketingCookies,\n  removeAnalyticsCookies,\n  removeMarketingCookies,\n  deleteAllNonEssentialCookies,\n} from '@/lib/cookies';\nimport { CookiePreferences } from '@shared/schema';\n\nexport default function CookieSettingsPage() {\n  const { toast } = useToast();\n  const [preferences, setPreferences] = useState<CookiePreferences>(getCookiePreferences());\n  const [hasChanges, setHasChanges] = useState(false);\n\n  useEffect(() => {\n    const currentPrefs = getCookiePreferences();\n    setPreferences(currentPrefs);\n  }, []);\n\n  const handlePreferenceChange = (key: keyof CookiePreferences, value: boolean) => {\n    setPreferences(prev => ({\n      ...prev,\n      [key]: value,\n    }));\n    setHasChanges(true);\n  };\n\n  const handleSave = () => {\n    const updatedPreferences: CookiePreferences = {\n      ...preferences,\n      necessary: true,\n      consentGiven: true,\n      consentDate: new Date().toISOString(),\n    };\n    \n    setCookiePreferences(updatedPreferences);\n    setConsent(true);\n    \n    if (updatedPreferences.analytics) {\n      applyAnalyticsCookies();\n    } else {\n      removeAnalyticsCookies();\n    }\n    \n    if (updatedPreferences.marketing) {\n      applyMarketingCookies();\n    } else {\n      removeMarketingCookies();\n    }\n\n    if (!updatedPreferences.preferences) {\n      deleteAllNonEssentialCookies();\n    }\n    \n    setHasChanges(false);\n    toast({\n      title: 'Preferensi Disimpan',\n      description: 'Pengaturan cookie Anda telah berhasil diperbarui.',\n    });\n  };\n\n  const handleAcceptAll = () => {\n    const allAccepted: CookiePreferences = {\n      necessary: true,\n      analytics: true,\n      marketing: true,\n      preferences: true,\n      consentGiven: true,\n      consentDate: new Date().toISOString(),\n    };\n    \n    setPreferences(allAccepted);\n    setCookiePreferences(allAccepted);\n    setConsent(true);\n    applyAnalyticsCookies();\n    applyMarketingCookies();\n    setHasChanges(false);\n    \n    toast({\n      title: 'Semua Cookie Diterima',\n      description: 'Anda telah menerima semua jenis cookie.',\n    });\n  };\n\n  const handleRejectAll = () => {\n    const rejected: CookiePreferences = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n      preferences: false,\n      consentGiven: true,\n      consentDate: new Date().toISOString(),\n    };\n    \n    setPreferences(rejected);\n    setCookiePreferences(rejected);\n    setConsent(true);\n    deleteAllNonEssentialCookies();\n    removeAnalyticsCookies();\n    removeMarketingCookies();\n    setHasChanges(false);\n    \n    toast({\n      title: 'Cookie Ditolak',\n      description: 'Hanya cookie penting yang akan digunakan.',\n    });\n  };\n\n  const cookieTypes = [\n    {\n      id: 'necessary',\n      key: 'necessary' as keyof CookiePreferences,\n      icon: Shield,\n      title: 'Cookie Penting',\n      description: 'Cookie ini diperlukan untuk fungsi dasar website seperti autentikasi, keamanan, dan navigasi. Cookie ini tidak dapat dinonaktifkan karena website tidak akan berfungsi tanpanya.',\n      required: true,\n    },\n    {\n      id: 'analytics',\n      key: 'analytics' as keyof CookiePreferences,\n      icon: BarChart3,\n      title: 'Cookie Analitik',\n      description: 'Cookie ini membantu kami memahami bagaimana pengunjung berinteraksi dengan website. Kami mengumpulkan informasi anonim tentang halaman yang dikunjungi, durasi kunjungan, dan perilaku pengguna untuk meningkatkan pengalaman website.',\n      required: false,\n    },\n    {\n      id: 'marketing',\n      key: 'marketing' as keyof CookiePreferences,\n      icon: Megaphone,\n      title: 'Cookie Pemasaran',\n      description: 'Cookie ini digunakan untuk menampilkan iklan yang relevan dengan minat Anda. Cookie ini juga membantu kami mengukur efektivitas kampanye iklan kami.',\n      required: false,\n    },\n    {\n      id: 'preferences',\n      key: 'preferences' as keyof CookiePreferences,\n      icon: SettingsIcon,\n      title: 'Cookie Preferensi',\n      description: 'Cookie ini mengingat preferensi Anda seperti tema tampilan (terang/gelap), bahasa yang dipilih, dan pengaturan antarmuka lainnya untuk memberikan pengalaman yang dipersonalisasi.',\n      required: false,\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      <div className=\"container max-w-4xl mx-auto py-8 px-4\">\n        <div className=\"mb-6\">\n          <Link href=\"/\">\n            <Button variant=\"ghost\" className=\"gap-2 mb-4\" data-testid=\"button-back\">\n              <ArrowLeft className=\"h-4 w-4\" />\n              Kembali\n            </Button>\n          </Link>\n          \n          <div className=\"flex items-center gap-3 mb-2\">\n            <Cookie className=\"h-8 w-8 text-primary\" data-testid=\"icon-cookie-settings\" />\n            <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\" data-testid=\"text-page-title\">\n              Pengaturan Cookie\n            </h1>\n          </div>\n          <p className=\"text-gray-600 dark:text-gray-400\" data-testid=\"text-page-description\">\n            Kelola preferensi cookie Anda untuk mengontrol pengalaman browsing Anda\n          </p>\n        </div>\n\n        <Card className=\"mb-6\">\n          <CardHeader>\n            <CardTitle data-testid=\"text-info-title\">Tentang Cookie Kami</CardTitle>\n            <CardDescription data-testid=\"text-info-description\">\n              Cookie adalah file kecil yang disimpan di perangkat Anda saat Anda mengunjungi website. \n              Cookie membantu kami memberikan pengalaman yang lebih baik dengan mengingat preferensi Anda \n              dan menganalisis bagaimana Anda menggunakan website kami.\n            </CardDescription>\n          </CardHeader>\n        </Card>\n\n        <div className=\"space-y-4 mb-6\">\n          {cookieTypes.map((type) => {\n            const Icon = type.icon;\n            return (\n              <Card key={type.id}>\n                <CardContent className=\"pt-6\">\n                  <div className=\"flex items-start justify-between gap-4\">\n                    <div className=\"flex gap-4 flex-1\">\n                      <div className=\"flex-shrink-0 p-2 rounded-lg bg-primary/10\">\n                        <Icon className=\"h-6 w-6 text-primary\" data-testid={`icon-${type.id}`} />\n                      </div>\n                      \n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2 mb-2\">\n                          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\" data-testid={`text-${type.id}-title`}>\n                            {type.title}\n                          </h3>\n                          {type.required && (\n                            <span className=\"text-xs px-2 py-0.5 bg-gray-200 dark:bg-gray-700 rounded-full text-gray-700 dark:text-gray-300\" data-testid={`badge-${type.id}-required`}>\n                              Wajib\n                            </span>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-gray-600 dark:text-gray-400\" data-testid={`text-${type.id}-description`}>\n                          {type.description}\n                        </p>\n                      </div>\n                    </div>\n                    \n                    <Switch\n                      id={type.id}\n                      checked={preferences[type.key] as boolean}\n                      onCheckedChange={(checked) => handlePreferenceChange(type.key, checked)}\n                      disabled={type.required}\n                      data-testid={`switch-${type.id}`}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n\n        {preferences.consentDate && (\n          <Card className=\"mb-6\">\n            <CardContent className=\"pt-6\">\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\" data-testid=\"text-consent-date\">\n                Terakhir diperbarui: {new Date(preferences.consentDate).toLocaleDateString('id-ID', {\n                  year: 'numeric',\n                  month: 'long',\n                  day: 'numeric',\n                  hour: '2-digit',\n                  minute: '2-digit',\n                })}\n              </p>\n            </CardContent>\n          </Card>\n        )}\n\n        <Separator className=\"my-6\" />\n\n        <div className=\"flex flex-wrap gap-3 justify-end\">\n          <Button \n            onClick={handleRejectAll} \n            variant=\"outline\"\n            data-testid=\"button-reject-all\"\n          >\n            Tolak Semua\n          </Button>\n          <Button \n            onClick={handleAcceptAll} \n            variant=\"outline\"\n            data-testid=\"button-accept-all\"\n          >\n            Terima Semua\n          </Button>\n          <Button \n            onClick={handleSave}\n            disabled={!hasChanges}\n            data-testid=\"button-save-changes\"\n          >\n            Simpan Perubahan\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":9616},"client/src/lib/cookies.ts":{"content":"import { CookiePreferences, CookieSettings } from \"@shared/schema\";\n\nexport const COOKIE_NAMES = {\n  CONSENT: 'cookie_consent',\n  PREFERENCES: 'cookie_preferences',\n  SETTINGS: 'user_settings',\n  SIDEBAR: 'sidebar_state',\n  THEME: 'theme',\n} as const;\n\nexport const COOKIE_EXPIRES = {\n  CONSENT: 365, // 1 year\n  PREFERENCES: 365, // 1 year  \n  SETTINGS: 365, // 1 year\n  SESSION: 7, // 1 week\n} as const;\n\nexport function setCookie(name: string, value: string, days: number = 365): void {\n  const date = new Date();\n  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n  const expires = `expires=${date.toUTCString()}`;\n  document.cookie = `${name}=${value};${expires};path=/;SameSite=Strict`;\n}\n\nexport function getCookie(name: string): string | null {\n  const nameEQ = `${name}=`;\n  const cookies = document.cookie.split(';');\n  \n  for (let i = 0; i < cookies.length; i++) {\n    let cookie = cookies[i];\n    while (cookie.charAt(0) === ' ') {\n      cookie = cookie.substring(1);\n    }\n    if (cookie.indexOf(nameEQ) === 0) {\n      return cookie.substring(nameEQ.length, cookie.length);\n    }\n  }\n  return null;\n}\n\nexport function deleteCookie(name: string): void {\n  document.cookie = `${name}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`;\n}\n\nexport function deleteAllNonEssentialCookies(): void {\n  const cookies = document.cookie.split(';');\n  const essentialCookies = [\n    COOKIE_NAMES.CONSENT,\n    COOKIE_NAMES.PREFERENCES,\n    'connect.sid',\n  ];\n  \n  for (let i = 0; i < cookies.length; i++) {\n    const cookie = cookies[i];\n    const eqPos = cookie.indexOf('=');\n    const name = eqPos > -1 ? cookie.substr(0, eqPos).trim() : cookie.trim();\n    \n    if (!essentialCookies.includes(name)) {\n      deleteCookie(name);\n    }\n  }\n}\n\nexport function getCookiePreferences(): CookiePreferences {\n  const storedPrefs = getCookie(COOKIE_NAMES.PREFERENCES);\n  \n  if (storedPrefs) {\n    try {\n      return JSON.parse(decodeURIComponent(storedPrefs));\n    } catch {\n      return getDefaultCookiePreferences();\n    }\n  }\n  \n  return getDefaultCookiePreferences();\n}\n\nexport function setCookiePreferences(preferences: CookiePreferences): void {\n  const prefsString = encodeURIComponent(JSON.stringify(preferences));\n  setCookie(COOKIE_NAMES.PREFERENCES, prefsString, COOKIE_EXPIRES.PREFERENCES);\n}\n\nexport function getDefaultCookiePreferences(): CookiePreferences {\n  return {\n    necessary: true,\n    analytics: false,\n    marketing: false,\n    preferences: false,\n    consentGiven: false,\n  };\n}\n\nexport function hasGivenConsent(): boolean {\n  const consent = getCookie(COOKIE_NAMES.CONSENT);\n  return consent === 'true';\n}\n\nexport function setConsent(given: boolean): void {\n  setCookie(COOKIE_NAMES.CONSENT, given.toString(), COOKIE_EXPIRES.CONSENT);\n  \n  if (given) {\n    const preferences = getCookiePreferences();\n    preferences.consentGiven = true;\n    preferences.consentDate = new Date().toISOString();\n    setCookiePreferences(preferences);\n  }\n}\n\nexport function getCookieSettings(): CookieSettings {\n  const storedSettings = getCookie(COOKIE_NAMES.SETTINGS);\n  \n  if (storedSettings) {\n    try {\n      return JSON.parse(decodeURIComponent(storedSettings));\n    } catch {\n      return getDefaultCookieSettings();\n    }\n  }\n  \n  return getDefaultCookieSettings();\n}\n\nexport function setCookieSettings(settings: CookieSettings): void {\n  const settingsString = encodeURIComponent(JSON.stringify(settings));\n  setCookie(COOKIE_NAMES.SETTINGS, settingsString, COOKIE_EXPIRES.SETTINGS);\n}\n\nexport function getDefaultCookieSettings(): CookieSettings {\n  return {\n    theme: 'system',\n    language: 'id',\n    sidebarState: 'expanded',\n    notificationsEnabled: true,\n  };\n}\n\nexport function applyAnalyticsCookies(): void {\n  console.log('Analytics cookies enabled');\n}\n\nexport function applyMarketingCookies(): void {\n  console.log('Marketing cookies enabled');\n}\n\nexport function removeAnalyticsCookies(): void {\n  console.log('Analytics cookies disabled');\n}\n\nexport function removeMarketingCookies(): void {\n  console.log('Marketing cookies disabled');\n}\n","size_bytes":4074},"client/src/components/cookie-consent-banner.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\nimport { Switch } from '@/components/ui/switch';\nimport { Label } from '@/components/ui/label';\nimport { Cookie, Settings, X } from 'lucide-react';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from '@/components/ui/dialog';\nimport {\n  hasGivenConsent,\n  setConsent,\n  getCookiePreferences,\n  setCookiePreferences,\n  applyAnalyticsCookies,\n  applyMarketingCookies,\n  removeAnalyticsCookies,\n  removeMarketingCookies,\n  deleteAllNonEssentialCookies,\n} from '@/lib/cookies';\nimport { CookiePreferences } from '@shared/schema';\n\nexport function CookieConsentBanner() {\n  const [showBanner, setShowBanner] = useState(false);\n  const [showSettings, setShowSettings] = useState(false);\n  const [preferences, setPreferences] = useState<CookiePreferences>(getCookiePreferences());\n\n  useEffect(() => {\n    const consentGiven = hasGivenConsent();\n    if (!consentGiven) {\n      setTimeout(() => setShowBanner(true), 1000);\n    }\n  }, []);\n\n  const handleAcceptAll = () => {\n    const allAccepted: CookiePreferences = {\n      necessary: true,\n      analytics: true,\n      marketing: true,\n      preferences: true,\n      consentGiven: true,\n      consentDate: new Date().toISOString(),\n    };\n    \n    setCookiePreferences(allAccepted);\n    setConsent(true);\n    applyAnalyticsCookies();\n    applyMarketingCookies();\n    setShowBanner(false);\n  };\n\n  const handleRejectAll = () => {\n    const rejected: CookiePreferences = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n      preferences: false,\n      consentGiven: true,\n      consentDate: new Date().toISOString(),\n    };\n    \n    setCookiePreferences(rejected);\n    setConsent(true);\n    deleteAllNonEssentialCookies();\n    removeAnalyticsCookies();\n    removeMarketingCookies();\n    setShowBanner(false);\n  };\n\n  const handleSavePreferences = () => {\n    const updatedPreferences: CookiePreferences = {\n      ...preferences,\n      necessary: true,\n      consentGiven: true,\n      consentDate: new Date().toISOString(),\n    };\n    \n    setCookiePreferences(updatedPreferences);\n    setConsent(true);\n    \n    if (updatedPreferences.analytics) {\n      applyAnalyticsCookies();\n    } else {\n      removeAnalyticsCookies();\n    }\n    \n    if (updatedPreferences.marketing) {\n      applyMarketingCookies();\n    } else {\n      removeMarketingCookies();\n    }\n    \n    setShowSettings(false);\n    setShowBanner(false);\n  };\n\n  const handlePreferenceChange = (key: keyof CookiePreferences, value: boolean) => {\n    setPreferences(prev => ({\n      ...prev,\n      [key]: value,\n    }));\n  };\n\n  if (!showBanner) return null;\n\n  return (\n    <>\n      <div className=\"fixed bottom-0 left-0 right-0 z-50 p-4 bg-gradient-to-t from-black/50 to-transparent pointer-events-none\">\n        <Card className=\"max-w-6xl mx-auto pointer-events-auto bg-white dark:bg-gray-900 shadow-2xl border-2 border-gray-200 dark:border-gray-700\">\n          <div className=\"p-6\">\n            <div className=\"flex items-start gap-4\">\n              <div className=\"flex-shrink-0\">\n                <Cookie className=\"h-8 w-8 text-primary\" data-testid=\"icon-cookie\" />\n              </div>\n              \n              <div className=\"flex-1\">\n                <h3 className=\"text-lg font-semibold mb-2 text-gray-900 dark:text-white\" data-testid=\"text-cookie-title\">\n                  Kami Menggunakan Cookie\n                </h3>\n                <p className=\"text-sm text-gray-600 dark:text-gray-300 mb-4\" data-testid=\"text-cookie-description\">\n                  Kami menggunakan cookie untuk meningkatkan pengalaman Anda, menganalisis lalu lintas situs, \n                  dan memberikan konten yang dipersonalisasi. Dengan mengklik \"Terima Semua\", Anda menyetujui \n                  penggunaan cookie kami.\n                </p>\n                \n                <div className=\"flex flex-wrap gap-3\">\n                  <Button \n                    onClick={handleAcceptAll} \n                    className=\"bg-primary hover:bg-primary/90\"\n                    data-testid=\"button-accept-all-cookies\"\n                  >\n                    Terima Semua\n                  </Button>\n                  \n                  <Button \n                    onClick={handleRejectAll} \n                    variant=\"outline\"\n                    data-testid=\"button-reject-all-cookies\"\n                  >\n                    Tolak Semua\n                  </Button>\n                  \n                  <Button \n                    onClick={() => setShowSettings(true)} \n                    variant=\"ghost\"\n                    className=\"gap-2\"\n                    data-testid=\"button-customize-cookies\"\n                  >\n                    <Settings className=\"h-4 w-4\" />\n                    Sesuaikan\n                  </Button>\n                </div>\n              </div>\n              \n              <button\n                onClick={handleRejectAll}\n                className=\"flex-shrink-0 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors\"\n                aria-label=\"Close\"\n                data-testid=\"button-close-banner\"\n              >\n                <X className=\"h-5 w-5 text-gray-500\" />\n              </button>\n            </div>\n          </div>\n        </Card>\n      </div>\n\n      <Dialog open={showSettings} onOpenChange={setShowSettings}>\n        <DialogContent className=\"max-w-2xl\" data-testid=\"dialog-cookie-settings\">\n          <DialogHeader>\n            <DialogTitle data-testid=\"text-settings-title\">Pengaturan Cookie</DialogTitle>\n            <DialogDescription data-testid=\"text-settings-description\">\n              Kelola preferensi cookie Anda. Cookie yang diperlukan selalu aktif karena diperlukan untuk fungsi dasar website.\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"space-y-6 py-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-1\">\n                <Label htmlFor=\"necessary\" className=\"text-base font-medium\" data-testid=\"label-necessary\">\n                  Cookie Penting\n                </Label>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\" data-testid=\"text-necessary-description\">\n                  Cookie ini diperlukan untuk fungsi dasar website dan tidak dapat dinonaktifkan.\n                </p>\n              </div>\n              <Switch\n                id=\"necessary\"\n                checked={true}\n                disabled\n                data-testid=\"switch-necessary\"\n              />\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-1\">\n                <Label htmlFor=\"analytics\" className=\"text-base font-medium\" data-testid=\"label-analytics\">\n                  Cookie Analitik\n                </Label>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\" data-testid=\"text-analytics-description\">\n                  Membantu kami memahami bagaimana pengunjung berinteraksi dengan website.\n                </p>\n              </div>\n              <Switch\n                id=\"analytics\"\n                checked={preferences.analytics}\n                onCheckedChange={(checked) => handlePreferenceChange('analytics', checked)}\n                data-testid=\"switch-analytics\"\n              />\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-1\">\n                <Label htmlFor=\"marketing\" className=\"text-base font-medium\" data-testid=\"label-marketing\">\n                  Cookie Pemasaran\n                </Label>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\" data-testid=\"text-marketing-description\">\n                  Digunakan untuk menampilkan iklan yang relevan dengan minat Anda.\n                </p>\n              </div>\n              <Switch\n                id=\"marketing\"\n                checked={preferences.marketing}\n                onCheckedChange={(checked) => handlePreferenceChange('marketing', checked)}\n                data-testid=\"switch-marketing\"\n              />\n            </div>\n\n            <div className=\"flex items-center justify-between\">\n              <div className=\"space-y-1\">\n                <Label htmlFor=\"preferences\" className=\"text-base font-medium\" data-testid=\"label-preferences\">\n                  Cookie Preferensi\n                </Label>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\" data-testid=\"text-preferences-description\">\n                  Mengingat preferensi Anda seperti tema dan bahasa.\n                </p>\n              </div>\n              <Switch\n                id=\"preferences\"\n                checked={preferences.preferences}\n                onCheckedChange={(checked) => handlePreferenceChange('preferences', checked)}\n                data-testid=\"switch-preferences\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex justify-end gap-3 pt-4 border-t\">\n            <Button \n              onClick={() => setShowSettings(false)} \n              variant=\"outline\"\n              data-testid=\"button-cancel-settings\"\n            >\n              Batal\n            </Button>\n            <Button \n              onClick={handleSavePreferences}\n              data-testid=\"button-save-preferences\"\n            >\n              Simpan Preferensi\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </>\n  );\n}\n","size_bytes":9649},"client/src/pages/reset-password.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation, useSearch } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { resetPasswordSchema, type ResetPasswordInput } from \"@shared/schema\";\nimport { Dumbbell, CheckCircle2 } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport { useState, useEffect } from \"react\";\n\nexport default function ResetPasswordPage() {\n  const [, setLocation] = useLocation();\n  const searchParams = useSearch();\n  const { toast } = useToast();\n  const [successMessage, setSuccessMessage] = useState(false);\n\n  const urlParams = new URLSearchParams(searchParams);\n  const tokenFromUrl = urlParams.get('token') || '';\n\n  const form = useForm<ResetPasswordInput>({\n    resolver: zodResolver(resetPasswordSchema),\n    defaultValues: {\n      token: tokenFromUrl,\n      newPassword: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (tokenFromUrl) {\n      form.setValue('token', tokenFromUrl);\n    }\n  }, [tokenFromUrl, form]);\n\n  const resetPasswordMutation = useMutation({\n    mutationFn: async (data: ResetPasswordInput) => {\n      const res = await apiRequest(\"POST\", \"/api/reset-password\", data);\n      return res.json();\n    },\n    onSuccess: (data: any) => {\n      setSuccessMessage(true);\n      toast({\n        title: \"Berhasil\",\n        description: data.message || \"Password berhasil direset\",\n      });\n      setTimeout(() => {\n        setLocation(\"/login\");\n      }, 3000);\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: error.message || \"Gagal mereset password\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ResetPasswordInput) => {\n    resetPasswordMutation.mutate(data);\n  };\n\n  if (successMessage) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-yellow-50 via-white to-yellow-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4 relative overflow-hidden\">\n        <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n          <div className=\"absolute top-20 left-10 w-72 h-72 bg-yellow-200/30 dark:bg-yellow-500/10 rounded-full blur-3xl animate-pulse\"></div>\n          <div className=\"absolute bottom-20 right-10 w-96 h-96 bg-yellow-300/20 dark:bg-yellow-400/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n          <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-yellow-100/20 dark:bg-yellow-600/5 rounded-full blur-3xl animate-pulse delay-500\"></div>\n        </div>\n\n        <Card className=\"w-full max-w-md relative z-10 shadow-xl border-yellow-200 dark:border-yellow-900/30 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm\">\n          <CardContent className=\"pt-10 pb-10 text-center\">\n            <div className=\"flex justify-center mb-6\">\n              <div className=\"p-4 bg-green-100 dark:bg-green-900/30 rounded-full\">\n                <CheckCircle2 className=\"h-16 w-16 text-green-600 dark:text-green-400\" />\n              </div>\n            </div>\n            <h3 className=\"text-2xl font-bold mb-2 text-gray-900 dark:text-white\">\n              Password Berhasil Direset!\n            </h3>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n              Anda akan diarahkan ke halaman login...\n            </p>\n            <Link href=\"/login\">\n              <Button\n                className=\"bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white\"\n                data-testid=\"button-go-to-login\"\n              >\n                Ke Halaman Login\n              </Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-yellow-50 via-white to-yellow-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4 relative overflow-hidden\">\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-20 left-10 w-72 h-72 bg-yellow-200/30 dark:bg-yellow-500/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-20 right-10 w-96 h-96 bg-yellow-300/20 dark:bg-yellow-400/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n        <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-yellow-100/20 dark:bg-yellow-600/5 rounded-full blur-3xl animate-pulse delay-500\"></div>\n      </div>\n\n      <Card className=\"w-full max-w-md relative z-10 shadow-xl border-yellow-200 dark:border-yellow-900/30 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"p-3 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full\">\n              <Dumbbell className=\"h-8 w-8 text-white\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-3xl font-bold bg-gradient-to-r from-yellow-600 to-yellow-500 bg-clip-text text-transparent\">\n            Reset Password\n          </CardTitle>\n          <CardDescription className=\"text-gray-600 dark:text-gray-400\">\n            Masukkan kode verifikasi dan password baru Anda\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"token\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-gray-700 dark:text-gray-300\">Kode Verifikasi</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"text\"\n                        placeholder=\"Masukkan 6 digit kode\"\n                        data-testid=\"input-verification-code\"\n                        className=\"border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-500 text-center text-2xl tracking-widest font-semibold\"\n                        maxLength={6}\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"newPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-gray-700 dark:text-gray-300\">Password Baru</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Minimal 6 karakter\"\n                        data-testid=\"input-new-password\"\n                        className=\"border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-500\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <FormField\n                control={form.control}\n                name=\"confirmPassword\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-gray-700 dark:text-gray-300\">Konfirmasi Password</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"password\"\n                        placeholder=\"Ulangi password baru\"\n                        data-testid=\"input-confirm-password\"\n                        className=\"border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-500\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-semibold\"\n                disabled={resetPasswordMutation.isPending}\n                data-testid=\"button-reset-password\"\n              >\n                {resetPasswordMutation.isPending ? \"Mereset...\" : \"Reset Password\"}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"mt-6 text-center\">\n            <Link href=\"/login\">\n              <Button\n                variant=\"ghost\"\n                className=\"text-yellow-600 hover:text-yellow-700 dark:text-yellow-500 dark:hover:text-yellow-400\"\n                data-testid=\"link-back-to-login\"\n              >\n                Kembali ke Login\n              </Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":9451},"server/email/resend.ts":{"content":"import { Resend } from 'resend';\n\nlet resendClient: Resend | null = null;\nlet fromEmail: string | null = null;\n\nfunction getResendClient() {\n  if (!process.env.RESEND_API_KEY) {\n    throw new Error('RESEND_API_KEY environment variable is required for email functionality');\n  }\n\n  if (!resendClient) {\n    resendClient = new Resend(process.env.RESEND_API_KEY);\n    fromEmail = process.env.RESEND_FROM_EMAIL || 'onboarding@resend.dev';\n  }\n\n  return {\n    client: resendClient,\n    fromEmail: fromEmail!\n  };\n}\n\nexport async function getUncachableResendClient() {\n  return getResendClient();\n}\n\nexport async function sendPasswordResetEmail(toEmail: string, resetToken: string) {\n  try {\n    const { client, fromEmail } = await getUncachableResendClient();\n    \n    const baseUrl = process.env.APP_URL || 'http://localhost:5000';\n    const resetUrl = `${baseUrl}/reset-password?token=${resetToken}`;\n    \n    console.log(`[Resend] Attempting to send password reset email to: ${toEmail}`);\n    console.log(`[Resend] From email: ${fromEmail}`);\n    \n    const result = await client.emails.send({\n      from: fromEmail,\n      to: toEmail,\n      subject: 'Reset Password - Idachi Fitness',\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2 style=\"color: #EAB308;\">Reset Password Anda</h2>\n          <p>Kami menerima permintaan untuk mereset password akun Anda di Idachi Fitness.</p>\n          <p>Kode verifikasi Anda adalah:</p>\n          <div style=\"background-color: #FEF3C7; padding: 15px; border-radius: 5px; text-align: center; margin: 20px 0;\">\n            <h1 style=\"color: #92400E; margin: 0; letter-spacing: 5px;\">${resetToken}</h1>\n          </div>\n          <p>Kode ini akan kadaluarsa dalam 15 menit.</p>\n          <p>Atau klik link berikut untuk langsung reset password:</p>\n          <p><a href=\"${resetUrl}\" style=\"background-color: #EAB308; color: white; padding: 12px 30px; text-decoration: none; border-radius: 5px; display: inline-block;\">Reset Password</a></p>\n          <p style=\"color: #666; font-size: 12px; margin-top: 30px;\">Jika Anda tidak meminta reset password, abaikan email ini.</p>\n          <p style=\"color: #666; font-size: 12px;\">- Tim Idachi Fitness</p>\n        </div>\n      `\n    });\n    \n    console.log(`[Resend] Email sent successfully.`, result);\n    return result;\n  } catch (error) {\n    console.error('[Resend] Error sending password reset email:', error);\n    throw error;\n  }\n}\n\nexport async function sendVerificationEmail(toEmail: string, verificationCode: string) {\n  try {\n    const { client, fromEmail } = await getUncachableResendClient();\n    \n    console.log(`[Resend] Attempting to send verification email to: ${toEmail}`);\n    console.log(`[Resend] From email: ${fromEmail}`);\n    \n    const result = await client.emails.send({\n      from: fromEmail,\n      to: toEmail,\n      subject: 'Verifikasi Email Anda - Idachi Fitness',\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2 style=\"color: #EAB308;\">Selamat Datang di Idachi Fitness!</h2>\n          <p>Terima kasih telah mendaftar. Untuk melanjutkan, mohon verifikasi email Anda dengan kode berikut:</p>\n          <div style=\"background-color: #FEF3C7; padding: 20px; border-radius: 8px; text-align: center; margin: 30px 0;\">\n            <h1 style=\"color: #92400E; margin: 0; letter-spacing: 8px; font-size: 36px;\">${verificationCode}</h1>\n          </div>\n          <p>Kode verifikasi ini akan kadaluarsa dalam <strong>15 menit</strong>.</p>\n          <p>Masukkan kode ini pada halaman verifikasi untuk mengaktifkan akun Anda.</p>\n          <p style=\"color: #666; font-size: 12px; margin-top: 30px;\">Jika Anda tidak mendaftar di Idachi Fitness, abaikan email ini.</p>\n          <p style=\"color: #666; font-size: 12px;\">- Tim Idachi Fitness</p>\n        </div>\n      `\n    });\n    \n    console.log(`[Resend] Verification email sent successfully.`, result);\n    return result;\n  } catch (error) {\n    console.error('[Resend] Error sending verification email:', error);\n    throw error;\n  }\n}\n\nexport async function sendInactivityReminderEmail(toEmail: string, memberName: string, daysInactive: number) {\n  try {\n    const { client, fromEmail } = await getUncachableResendClient();\n    \n    console.log(`[Resend] Attempting to send inactivity reminder email to: ${toEmail}`);\n    console.log(`[Resend] From email: ${fromEmail}`);\n    \n    const result = await client.emails.send({\n      from: fromEmail,\n      to: toEmail,\n      subject: 'Ayo Nge-gym Lagi! ðŸ’ª - Idachi Fitness',\n      html: `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n          <div style=\"text-align: center; margin-bottom: 30px;\">\n            <h1 style=\"color: #EAB308; font-size: 32px; margin: 0;\">ðŸ’ª Idachi Fitness ðŸ’ª</h1>\n          </div>\n          \n          <div style=\"background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%); padding: 30px; border-radius: 12px; margin-bottom: 20px;\">\n            <h2 style=\"color: #92400E; margin-top: 0; text-align: center;\">Hai ${memberName}!</h2>\n            <p style=\"font-size: 18px; text-align: center; color: #78350F; margin: 20px 0;\">\n              <strong>Ayo nge-gym lagi! Jangan tunggu nanti â€” mulai hari ini! ðŸ’ª</strong>\n            </p>\n          </div>\n          \n          <div style=\"background-color: #FFFBEB; padding: 20px; border-radius: 8px; border-left: 4px solid #EAB308;\">\n            <p style=\"color: #92400E; margin: 0;\">\n              Sudah ${daysInactive} hari kamu tidak terlihat di gym. Kami tahu hidup sibuk, tapi jangan biarkan rutinitas fitnesmu terbengkalai!\n            </p>\n          </div>\n          \n          <div style=\"margin: 30px 0; text-align: center;\">\n            <p style=\"color: #78350F; font-size: 16px; margin-bottom: 20px;\">\n              <strong>Ingat: Konsistensi adalah kunci kesuksesan!</strong>\n            </p>\n            <p style=\"color: #666;\">\n              Tubuh yang kuat dimulai dari keputusan kecil setiap hari. Yuk, mulai lagi dari sekarang!\n            </p>\n          </div>\n          \n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${process.env.APP_URL || 'http://localhost:5000'}\" \n               style=\"background-color: #EAB308; color: white; padding: 15px 40px; text-decoration: none; border-radius: 8px; display: inline-block; font-weight: bold; font-size: 16px;\">\n              Booking Class Sekarang\n            </a>\n          </div>\n          \n          <div style=\"margin-top: 40px; padding-top: 20px; border-top: 1px solid #E5E7EB; text-align: center;\">\n            <p style=\"color: #666; font-size: 12px; margin: 5px 0;\">\n              Kami tunggu kehadiranmu di Idachi Fitness!\n            </p>\n            <p style=\"color: #666; font-size: 12px; margin: 5px 0;\">\n              - Tim Idachi Fitness\n            </p>\n          </div>\n        </div>\n      `\n    });\n    \n    console.log(`[Resend] Inactivity reminder email sent successfully to ${toEmail}`);\n    return result;\n  } catch (error) {\n    console.error('[Resend] Error sending inactivity reminder email:', error);\n    throw error;\n  }\n}\n","size_bytes":7225},"client/src/pages/forgot-password.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { forgotPasswordRequestSchema, type ForgotPasswordRequest } from \"@shared/schema\";\nimport { Dumbbell, ArrowLeft } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function ForgotPasswordPage() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n\n  const form = useForm<ForgotPasswordRequest>({\n    resolver: zodResolver(forgotPasswordRequestSchema),\n    defaultValues: {\n      email: \"\",\n    },\n  });\n\n  const forgotPasswordMutation = useMutation({\n    mutationFn: async (data: ForgotPasswordRequest) => {\n      const res = await apiRequest(\"POST\", \"/api/forgot-password\", data);\n      return res.json();\n    },\n    onSuccess: (data: any) => {\n      toast({\n        title: \"Email Terkirim\",\n        description: data.message || \"Kode verifikasi telah dikirim ke email Anda\",\n      });\n      // Redirect to reset password page\n      setLocation(\"/reset-password\");\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Error\",\n        description: error.message || \"Gagal mengirim kode verifikasi\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ForgotPasswordRequest) => {\n    forgotPasswordMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-yellow-50 via-white to-yellow-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center p-4 relative overflow-hidden\">\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-20 left-10 w-72 h-72 bg-yellow-200/30 dark:bg-yellow-500/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-20 right-10 w-96 h-96 bg-yellow-300/20 dark:bg-yellow-400/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n        <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-yellow-100/20 dark:bg-yellow-600/5 rounded-full blur-3xl animate-pulse delay-500\"></div>\n      </div>\n\n      <Card className=\"w-full max-w-md relative z-10 shadow-xl border-yellow-200 dark:border-yellow-900/30 bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm\">\n        <CardHeader className=\"space-y-1 text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"p-3 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full\">\n              <Dumbbell className=\"h-8 w-8 text-white\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-3xl font-bold bg-gradient-to-r from-yellow-600 to-yellow-500 bg-clip-text text-transparent\">\n            Lupa Password\n          </CardTitle>\n          <CardDescription className=\"text-gray-600 dark:text-gray-400\">\n            Masukkan email Anda untuk menerima kode verifikasi\n          </CardDescription>\n        </CardHeader>\n        <CardContent>\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n              <FormField\n                control={form.control}\n                name=\"email\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"text-gray-700 dark:text-gray-300\">Email</FormLabel>\n                    <FormControl>\n                      <Input\n                        type=\"email\"\n                        placeholder=\"nama@example.com\"\n                        data-testid=\"input-email\"\n                        className=\"border-gray-300 dark:border-gray-600 focus:border-yellow-500 dark:focus:border-yellow-500\"\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              <Button\n                type=\"submit\"\n                className=\"w-full bg-gradient-to-r from-yellow-500 to-yellow-600 hover:from-yellow-600 hover:to-yellow-700 text-white font-semibold\"\n                disabled={forgotPasswordMutation.isPending}\n                data-testid=\"button-send-code\"\n              >\n                {forgotPasswordMutation.isPending ? \"Mengirim...\" : \"Kirim Kode Verifikasi\"}\n              </Button>\n            </form>\n          </Form>\n\n          <div className=\"mt-6 text-center\">\n            <Link href=\"/login\">\n              <Button\n                variant=\"ghost\"\n                className=\"text-yellow-600 hover:text-yellow-700 dark:text-yellow-500 dark:hover:text-yellow-400\"\n                data-testid=\"link-back-to-login\"\n              >\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Kembali ke Login\n              </Button>\n            </Link>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":5341},"client/src/components/ui/notifications-sheet.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Sheet, SheetContent, SheetHeader, SheetTitle, SheetTrigger } from \"@/components/ui/sheet\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Bell, Check, Trash2, CheckCheck } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport type { Notification } from \"@shared/schema\";\n\ninterface NotificationsSheetProps {\n  children: React.ReactNode;\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n}\n\nexport default function NotificationsSheet({ children, open, onOpenChange }: NotificationsSheetProps) {\n  const { data: notifications, isLoading } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n    refetchInterval: 30000, // Refresh every 30 seconds\n  });\n\n  const markAsReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      await apiRequest(\"PUT\", `/api/notifications/${id}/read`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n    },\n  });\n\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      await apiRequest(\"PUT\", \"/api/notifications/read-all\");\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n    },\n  });\n\n  const deleteNotificationMutation = useMutation({\n    mutationFn: async (id: string) => {\n      await apiRequest(\"DELETE\", `/api/notifications/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n    },\n  });\n\n  const unreadCount = notifications?.filter(n => !n.isRead).length || 0;\n\n  return (\n    <Sheet open={open} onOpenChange={onOpenChange}>\n      <SheetTrigger asChild>\n        {children}\n      </SheetTrigger>\n      <SheetContent className=\"w-full sm:max-w-md\">\n        <SheetHeader>\n          <SheetTitle className=\"flex items-center justify-between\">\n            <span className=\"flex items-center gap-2\">\n              <Bell size={20} />\n              Notifikasi\n            </span>\n            {unreadCount > 0 && (\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => markAllAsReadMutation.mutate()}\n                disabled={markAllAsReadMutation.isPending}\n                data-testid=\"button-mark-all-read\"\n              >\n                <CheckCheck size={16} className=\"mr-1\" />\n                Tandai Semua Dibaca\n              </Button>\n            )}\n          </SheetTitle>\n        </SheetHeader>\n\n        <ScrollArea className=\"h-[calc(100vh-120px)] mt-6\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n            </div>\n          ) : notifications && notifications.length > 0 ? (\n            <div className=\"space-y-3\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={`\n                    p-4 rounded-lg border transition-colors\n                    ${notification.isRead \n                      ? 'bg-background border-border' \n                      : 'bg-primary/5 border-primary/20'\n                    }\n                  `}\n                  data-testid={`notification-${notification.id}`}\n                >\n                  <div className=\"flex items-start justify-between gap-3\">\n                    <div className=\"flex-1\">\n                      <h4 className=\"font-semibold text-foreground flex items-center gap-2\">\n                        {notification.title}\n                        {!notification.isRead && (\n                          <span className=\"w-2 h-2 bg-primary rounded-full\" />\n                        )}\n                      </h4>\n                      <p className=\"text-sm text-muted-foreground mt-1\">\n                        {notification.message}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mt-2\">\n                        {notification.createdAt && format(new Date(notification.createdAt), \"dd MMM yyyy, HH:mm\")}\n                      </p>\n                    </div>\n                    \n                    <div className=\"flex gap-1\">\n                      {!notification.isRead && (\n                        <Button\n                          variant=\"ghost\"\n                          size=\"icon\"\n                          className=\"h-8 w-8\"\n                          onClick={() => markAsReadMutation.mutate(notification.id)}\n                          disabled={markAsReadMutation.isPending}\n                          data-testid={`button-mark-read-${notification.id}`}\n                        >\n                          <Check size={16} />\n                        </Button>\n                      )}\n                      <Button\n                        variant=\"ghost\"\n                        size=\"icon\"\n                        className=\"h-8 w-8 text-destructive hover:text-destructive\"\n                        onClick={() => deleteNotificationMutation.mutate(notification.id)}\n                        disabled={deleteNotificationMutation.isPending}\n                        data-testid={`button-delete-${notification.id}`}\n                      >\n                        <Trash2 size={16} />\n                      </Button>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"flex flex-col items-center justify-center py-12 text-muted-foreground\">\n              <Bell size={48} className=\"mb-3 opacity-50\" />\n              <p className=\"text-lg font-medium\">Tidak Ada Notifikasi</p>\n              <p className=\"text-sm mt-1\">Notifikasi Anda akan muncul di sini</p>\n            </div>\n          )}\n        </ScrollArea>\n      </SheetContent>\n    </Sheet>\n  );\n}\n","size_bytes":6060},"client/src/pages/verify-email.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { verifyEmailSchema } from \"@shared/schema\";\nimport type { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Link, useLocation, useSearch } from \"wouter\";\nimport { Mail, CheckCircle } from \"lucide-react\";\nimport idachiLogo from \"@assets/image_1759411904981.png\";\n\ntype VerifyEmailFormData = z.infer<typeof verifyEmailSchema>;\n\nexport default function VerifyEmail() {\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const searchParams = useSearch();\n  const urlParams = new URLSearchParams(searchParams);\n  const emailFromUrl = urlParams.get('email') || '';\n  const [isResending, setIsResending] = useState(false);\n\n  const form = useForm<VerifyEmailFormData>({\n    resolver: zodResolver(verifyEmailSchema),\n    defaultValues: {\n      email: emailFromUrl,\n      verificationCode: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (emailFromUrl) {\n      form.setValue('email', emailFromUrl);\n    }\n  }, [emailFromUrl, form]);\n\n  const verifyMutation = useMutation({\n    mutationFn: async (data: VerifyEmailFormData) => {\n      return await apiRequest(\"POST\", \"/api/verify-email\", data);\n    },\n    onSuccess: async () => {\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/user\"] });\n      toast({\n        title: \"Verifikasi Berhasil!\",\n        description: \"Email Anda telah diverifikasi. Selamat datang!\",\n      });\n      setLocation(\"/\");\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Verifikasi Gagal\",\n        description: error.message || \"Kode verifikasi tidak valid atau sudah kadaluarsa\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: VerifyEmailFormData) => {\n    verifyMutation.mutate(data);\n  };\n\n  const handleResendCode = async () => {\n    const currentEmail = form.getValues('email');\n    \n    if (!currentEmail) {\n      toast({\n        title: \"Error\",\n        description: \"Mohon masukkan email Anda terlebih dahulu\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsResending(true);\n    try {\n      await apiRequest(\"POST\", \"/api/resend-verification-code\", { email: currentEmail });\n      toast({\n        title: \"Kode Terkirim!\",\n        description: \"Kode verifikasi baru telah dikirim ke email Anda\",\n      });\n    } catch (error: any) {\n      toast({\n        title: \"Gagal Mengirim Kode\",\n        description: error.message || \"Terjadi kesalahan saat mengirim kode verifikasi\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsResending(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen w-full bg-gradient-to-br from-yellow-50 via-amber-50 to-orange-100 dark:from-gray-950 dark:via-yellow-950 dark:to-amber-950 relative overflow-hidden\">\n      {/* Animated background elements */}\n      <div className=\"absolute inset-0 overflow-hidden pointer-events-none\">\n        <div className=\"absolute top-0 right-0 w-96 h-96 bg-yellow-300/20 dark:bg-yellow-500/10 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-amber-400/20 dark:bg-amber-500/10 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n        <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-yellow-200/10 dark:bg-yellow-600/5 rounded-full blur-3xl\"></div>\n      </div>\n\n      <div className=\"container mx-auto min-h-screen flex items-center justify-center p-4 relative z-10\">\n        <div className=\"w-full max-w-md\">\n          <Card className=\"border-2 border-yellow-200 dark:border-yellow-800/50 shadow-2xl bg-white/90 dark:bg-gray-900/90 backdrop-blur-xl\">\n            <CardHeader className=\"space-y-2 pb-6\">\n              <div className=\"flex justify-center mb-4\">\n                <div className=\"relative\">\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-2xl blur-2xl opacity-60 animate-pulse\"></div>\n                  <img \n                    src={idachiLogo} \n                    alt=\"Idachi Fitness Logo\" \n                    className=\"relative h-16 w-16 object-contain rounded-xl\"\n                    data-testid=\"img-logo\"\n                  />\n                </div>\n              </div>\n              <CardTitle className=\"text-3xl font-bold text-center text-gray-900 dark:text-white\">\n                Verifikasi Email\n              </CardTitle>\n              <CardDescription className=\"text-center text-base\">\n                Masukkan kode verifikasi yang telah dikirim ke email Anda\n              </CardDescription>\n            </CardHeader>\n            \n            <CardContent className=\"space-y-6\">\n              <div className=\"flex justify-center\">\n                <div className=\"p-4 rounded-full bg-yellow-100 dark:bg-yellow-900/30\">\n                  <Mail className=\"h-12 w-12 text-yellow-600 dark:text-yellow-400\" />\n                </div>\n              </div>\n\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-5\">\n                  {!emailFromUrl && (\n                    <FormField\n                      control={form.control}\n                      name=\"email\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Email</FormLabel>\n                          <FormControl>\n                            <Input\n                              type=\"email\"\n                              placeholder=\"nama@gmail.com\"\n                              className=\"h-12 bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700\"\n                              data-testid=\"input-email\"\n                              {...field}\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  )}\n                  {emailFromUrl && (\n                    <FormField\n                      control={form.control}\n                      name=\"email\"\n                      render={({ field }) => (\n                        <FormItem className=\"hidden\">\n                          <FormControl>\n                            <Input\n                              type=\"email\"\n                              data-testid=\"input-email-hidden\"\n                              readOnly\n                              {...field}\n                            />\n                          </FormControl>\n                        </FormItem>\n                      )}\n                    />\n                  )}\n\n                  <FormField\n                    control={form.control}\n                    name=\"verificationCode\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-gray-700 dark:text-gray-300 font-medium\">Kode Verifikasi</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"Masukkan 6 digit kode\"\n                            maxLength={6}\n                            className=\"h-14 text-center text-2xl tracking-widest font-bold bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700 focus:border-yellow-500 dark:focus:border-yellow-400\"\n                            data-testid=\"input-verification-code\"\n                            {...field}\n                          />\n                        </FormControl>\n                        <FormDescription className=\"text-center text-sm\">\n                          Kode verifikasi berlaku selama 15 menit\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <Button\n                    type=\"submit\"\n                    className=\"w-full h-12 bg-gradient-to-r from-yellow-500 to-amber-500 hover:from-yellow-600 hover:to-amber-600 text-white font-semibold text-base shadow-lg shadow-yellow-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-yellow-500/40\"\n                    disabled={verifyMutation.isPending}\n                    data-testid=\"button-verify\"\n                  >\n                    {verifyMutation.isPending ? (\n                      <span className=\"flex items-center gap-2\">\n                        <div className=\"h-5 w-5 border-3 border-white/30 border-t-white rounded-full animate-spin\" />\n                        Memverifikasi...\n                      </span>\n                    ) : (\n                      <span className=\"flex items-center gap-2\">\n                        <CheckCircle className=\"h-5 w-5\" />\n                        Verifikasi Email\n                      </span>\n                    )}\n                  </Button>\n\n                  <Button\n                    type=\"button\"\n                    variant=\"outline\"\n                    className=\"w-full h-12 border-yellow-500 dark:border-yellow-600 text-yellow-600 dark:text-yellow-400 hover:bg-yellow-50 dark:hover:bg-yellow-950/30\"\n                    onClick={handleResendCode}\n                    disabled={isResending}\n                    data-testid=\"button-resend-code\"\n                  >\n                    {isResending ? (\n                      <span className=\"flex items-center gap-2\">\n                        <div className=\"h-5 w-5 border-3 border-yellow-500/30 border-t-yellow-500 rounded-full animate-spin\" />\n                        Mengirim ulang...\n                      </span>\n                    ) : (\n                      <span className=\"flex items-center gap-2\">\n                        <Mail className=\"h-5 w-5\" />\n                        Kirim Ulang Kode\n                      </span>\n                    )}\n                  </Button>\n                </form>\n              </Form>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10573},"client/src/pages/admin-pt-sessions.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport AdminLayout from \"@/components/ui/admin-layout\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Dumbbell, CheckCircle, Clock, Search, AlertCircle, User } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\nexport default function AdminPTSessions() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [activeTab, setActiveTab] = useState(\"packages\");\n\n  useEffect(() => {\n    if (!isLoading && (!isAuthenticated || user?.role !== 'admin')) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"Admin access required. Redirecting...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, user, toast]);\n\n  const { data: packages, isLoading: packagesLoading } = useQuery<any[]>({\n    queryKey: [\"/api/admin/pt-session-packages\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const { data: allSessions, isLoading: sessionsLoading } = useQuery<any[]>({\n    queryKey: [\"/api/admin/pt-session-attendance\"],\n    enabled: isAuthenticated && user?.role === 'admin',\n    retry: false,\n  });\n\n  const confirmSessionMutation = useMutation({\n    mutationFn: (sessionId: string) =>\n      apiRequest(\"PUT\", `/api/admin/pt-session-attendance/${sessionId}/confirm`, {}),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/pt-session-attendance\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/pt-session-packages\"] });\n      toast({\n        title: \"Berhasil\",\n        description: \"Sesi PT berhasil dikonfirmasi\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal mengkonfirmasi sesi\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  if (isLoading || packagesLoading || sessionsLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user || user.role !== 'admin') {\n    return null;\n  }\n\n  const filteredPackages = packages?.filter((pkg) => {\n    const matchesSearch = !searchTerm || \n      pkg.user?.firstName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      pkg.user?.lastName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      pkg.user?.email?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      pkg.trainer?.name?.toLowerCase().includes(searchTerm.toLowerCase());\n    return matchesSearch;\n  }) || [];\n\n  const filteredSessions = allSessions?.filter((session) => {\n    const matchesSearch = !searchTerm || \n      session.user?.firstName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      session.user?.lastName?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      session.trainer?.name?.toLowerCase().includes(searchTerm.toLowerCase());\n    return matchesSearch;\n  }) || [];\n\n  const pendingSessions = filteredSessions.filter(s => !s.adminConfirmed && s.status === 'completed');\n\n  return (\n    <AdminLayout>\n      <div className=\"space-y-6\">\n        <div>\n          <h1 className=\"text-3xl font-bold text-foreground\">Manajemen Sesi PT</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            Kelola paket sesi dan konfirmasi kehadiran member\n          </p>\n        </div>\n\n        {/* Search */}\n        <div className=\"relative max-w-md\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n          <Input\n            type=\"text\"\n            placeholder=\"Cari member atau trainer...\"\n            className=\"pl-10\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            data-testid=\"input-search\"\n          />\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab}>\n          <TabsList className=\"grid w-full max-w-md grid-cols-2\">\n            <TabsTrigger value=\"packages\" data-testid=\"tab-packages\">\n              <Dumbbell className=\"h-4 w-4 mr-2\" />\n              Paket Sesi ({filteredPackages.length})\n            </TabsTrigger>\n            <TabsTrigger value=\"sessions\" data-testid=\"tab-sessions\">\n              <Clock className=\"h-4 w-4 mr-2\" />\n              Konfirmasi ({pendingSessions.length})\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Packages Tab */}\n          <TabsContent value=\"packages\" className=\"mt-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Paket Sesi PT Member</CardTitle>\n                <CardDescription>\n                  Lihat semua paket sesi PT yang dimiliki member\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {filteredPackages.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead>Member</TableHead>\n                          <TableHead>Trainer</TableHead>\n                          <TableHead className=\"text-center\">Total Sesi</TableHead>\n                          <TableHead className=\"text-center\">Terpakai</TableHead>\n                          <TableHead className=\"text-center\">Sisa</TableHead>\n                          <TableHead>Status</TableHead>\n                          <TableHead>Tanggal Beli</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {filteredPackages.map((pkg) => (\n                          <TableRow key={pkg.id}>\n                            <TableCell>\n                              <div>\n                                <p className=\"font-medium\">{pkg.user?.firstName} {pkg.user?.lastName}</p>\n                                <p className=\"text-sm text-muted-foreground\">{pkg.user?.email}</p>\n                              </div>\n                            </TableCell>\n                            <TableCell>\n                              <div>\n                                <p className=\"font-medium\">{pkg.trainer?.name}</p>\n                                <p className=\"text-sm text-muted-foreground\">{pkg.trainer?.specialization}</p>\n                              </div>\n                            </TableCell>\n                            <TableCell className=\"text-center\">\n                              <Badge variant=\"outline\">{pkg.totalSessions}</Badge>\n                            </TableCell>\n                            <TableCell className=\"text-center\">\n                              <Badge variant=\"secondary\">{pkg.usedSessions || 0}</Badge>\n                            </TableCell>\n                            <TableCell className=\"text-center\">\n                              <Badge variant={pkg.remainingSessions > 0 ? \"default\" : \"destructive\"}>\n                                {pkg.remainingSessions}\n                              </Badge>\n                            </TableCell>\n                            <TableCell>\n                              <Badge variant={pkg.status === 'active' ? 'default' : 'secondary'}>\n                                {pkg.status === 'active' ? 'Aktif' : pkg.status === 'completed' ? 'Selesai' : pkg.status}\n                              </Badge>\n                            </TableCell>\n                            <TableCell>\n                              {pkg.purchaseDate ? format(new Date(pkg.purchaseDate), \"dd MMM yyyy\") : '-'}\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Dumbbell className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>Belum ada paket sesi PT</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Sessions Tab */}\n          <TabsContent value=\"sessions\" className=\"mt-6\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Konfirmasi Kehadiran</CardTitle>\n                <CardDescription>\n                  Konfirmasi kehadiran member pada sesi PT\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {filteredSessions.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead>Member</TableHead>\n                          <TableHead>Trainer</TableHead>\n                          <TableHead>Sesi</TableHead>\n                          <TableHead>Tanggal Sesi</TableHead>\n                          <TableHead>Check-in</TableHead>\n                          <TableHead>Status</TableHead>\n                          <TableHead className=\"text-right\">Aksi</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {filteredSessions.map((session) => (\n                          <TableRow key={session.id}>\n                            <TableCell>\n                              <div>\n                                <p className=\"font-medium\">{session.user?.firstName} {session.user?.lastName}</p>\n                                <p className=\"text-sm text-muted-foreground\">{session.user?.email}</p>\n                              </div>\n                            </TableCell>\n                            <TableCell>{session.trainer?.name}</TableCell>\n                            <TableCell>\n                              <Badge variant=\"outline\">#{session.sessionNumber}</Badge>\n                            </TableCell>\n                            <TableCell>\n                              {format(new Date(session.sessionDate), \"dd MMM yyyy, HH:mm\")}\n                            </TableCell>\n                            <TableCell>\n                              {session.checkInTime ? (\n                                <div className=\"flex items-center gap-1 text-green-600\">\n                                  <CheckCircle className=\"h-4 w-4\" />\n                                  <span className=\"text-sm\">\n                                    {format(new Date(session.checkInTime), \"HH:mm\")}\n                                  </span>\n                                </div>\n                              ) : (\n                                <span className=\"text-sm text-muted-foreground\">Belum check-in</span>\n                              )}\n                            </TableCell>\n                            <TableCell>\n                              <div className=\"flex flex-col gap-1\">\n                                <Badge variant={\n                                  session.status === 'completed' ? 'default' :\n                                  session.status === 'scheduled' ? 'secondary' :\n                                  'destructive'\n                                }>\n                                  {session.status === 'completed' ? 'Selesai' : \n                                   session.status === 'scheduled' ? 'Dijadwalkan' : \n                                   session.status}\n                                </Badge>\n                                {session.adminConfirmed && (\n                                  <Badge variant=\"success\" className=\"text-xs\">\n                                    <CheckCircle className=\"h-3 w-3 mr-1\" />\n                                    Terkonfirmasi\n                                  </Badge>\n                                )}\n                              </div>\n                            </TableCell>\n                            <TableCell className=\"text-right\">\n                              {!session.adminConfirmed && session.status === 'completed' ? (\n                                <Button\n                                  size=\"sm\"\n                                  className=\"bg-green-500 hover:bg-green-600 text-white\"\n                                  onClick={() => confirmSessionMutation.mutate(session.id)}\n                                  disabled={confirmSessionMutation.isPending}\n                                  data-testid={`button-confirm-${session.id}`}\n                                >\n                                  <CheckCircle className=\"h-4 w-4 mr-2\" />\n                                  Konfirmasi\n                                </Button>\n                              ) : session.adminConfirmed ? (\n                                <Badge variant=\"success\">\n                                  <CheckCircle className=\"h-3 w-3 mr-1\" />\n                                  Dikonfirmasi\n                                </Badge>\n                              ) : (\n                                <Badge variant=\"secondary\">Menunggu Check-in</Badge>\n                              )}\n                            </TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Clock className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>Belum ada sesi yang perlu dikonfirmasi</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </AdminLayout>\n  );\n}\n","size_bytes":14486},"client/src/pages/my-pt-sessions.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport Navigation from \"@/components/ui/navigation\";\nimport BottomNavigation from \"@/components/ui/bottom-navigation\";\nimport {\n  Dumbbell,\n  Calendar,\n  CheckCircle2,\n  Clock,\n  AlertCircle,\n  Plus,\n  ChevronRight,\n} from \"lucide-react\";\nimport { format } from \"date-fns\";\n\nexport default function MyPtSessions() {\n  const { toast } = useToast();\n  const { user, isAuthenticated } = useAuth();\n  const [selectedPackage, setSelectedPackage] = useState<any>(null);\n  const [showScheduleModal, setShowScheduleModal] = useState(false);\n  const [sessionDate, setSessionDate] = useState(\"\");\n  const [sessionNotes, setSessionNotes] = useState(\"\");\n\n  // Fetch PT session packages\n  const { data: packages, isLoading: packagesLoading } = useQuery<any[]>({\n    queryKey: [\"/api/pt-session-packages\"],\n    enabled: isAuthenticated,\n  });\n\n  // Fetch PT session attendance\n  const { data: sessions, isLoading: sessionsLoading } = useQuery<any[]>({\n    queryKey: [\"/api/pt-session-attendance\"],\n    enabled: isAuthenticated,\n  });\n\n  // Schedule session mutation\n  const scheduleSessionMutation = useMutation({\n    mutationFn: async (data: { packageId: string; sessionDate: string; notes?: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/pt-session-attendance\", data);\n      return await response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/pt-session-attendance\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/pt-session-packages\"] });\n      setShowScheduleModal(false);\n      setSessionDate(\"\");\n      setSessionNotes(\"\");\n      setSelectedPackage(null);\n      toast({\n        title: \"Berhasil\",\n        description: \"Sesi PT berhasil dijadwalkan!\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal menjadwalkan sesi\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Check-in mutation\n  const checkInMutation = useMutation({\n    mutationFn: async (sessionId: string) => {\n      const response = await apiRequest(\"PUT\", `/api/pt-session-attendance/${sessionId}/check-in`, {});\n      return await response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/pt-session-attendance\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/pt-session-packages\"] });\n      toast({\n        title: \"Berhasil\",\n        description: \"Check-in berhasil!\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Error\",\n        description: error.message || \"Gagal check-in\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleScheduleSession = () => {\n    if (!selectedPackage || !sessionDate) {\n      toast({\n        title: \"Error\",\n        description: \"Mohon lengkapi semua field\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    scheduleSessionMutation.mutate({\n      packageId: selectedPackage.id,\n      sessionDate,\n      notes: sessionNotes,\n    });\n  };\n\n  const handleCheckIn = (sessionId: string) => {\n    checkInMutation.mutate(sessionId);\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusMap: Record<string, { variant: any; label: string }> = {\n      scheduled: { variant: \"default\", label: \"Dijadwalkan\" },\n      completed: { variant: \"success\", label: \"Selesai\" },\n      cancelled: { variant: \"destructive\", label: \"Dibatalkan\" },\n      no_show: { variant: \"destructive\", label: \"Tidak Hadir\" },\n    };\n    const config = statusMap[status] || { variant: \"default\", label: status };\n    return <Badge variant={config.variant as any}>{config.label}</Badge>;\n  };\n\n  if (packagesLoading || sessionsLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n        <Navigation />\n        <div className=\"pt-16 pb-20 px-4\">\n          <div className=\"flex items-center justify-center h-64\">\n            <div className=\"h-8 w-8 border-4 border-yellow-500 border-t-transparent rounded-full animate-spin\" />\n          </div>\n        </div>\n        <BottomNavigation />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      <Navigation />\n      <div className=\"pt-16 pb-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <h1 className=\"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2\">\n            Sesi Personal Trainer\n          </h1>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            Kelola paket dan jadwal sesi PT Anda\n          </p>\n        </div>\n\n        {/* Active Packages */}\n        <div className=\"mb-8\">\n          <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n            <Dumbbell className=\"h-5 w-5 text-yellow-500\" />\n            Paket Aktif\n          </h2>\n          \n          {packages && packages.length > 0 ? (\n            <div className=\"grid gap-4 sm:grid-cols-2\">\n              {packages.filter(pkg => pkg.status === 'active').map((pkg) => (\n                <Card key={pkg.id} className=\"border-l-4 border-l-yellow-500\">\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <CardTitle className=\"text-lg\">{pkg.trainer.name}</CardTitle>\n                        <CardDescription className=\"mt-1\">\n                          {pkg.trainer.specialization}\n                        </CardDescription>\n                      </div>\n                      <Badge variant={pkg.remainingSessions > 0 ? \"default\" : \"secondary\"}>\n                        {pkg.status === 'active' ? 'Aktif' : 'Selesai'}\n                      </Badge>\n                    </div>\n                  </CardHeader>\n                  <CardContent className=\"space-y-3\">\n                    <div className=\"grid grid-cols-3 gap-4 text-center\">\n                      <div className=\"space-y-1\">\n                        <p className=\"text-2xl font-bold text-yellow-500\">{pkg.totalSessions}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">Total</p>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <p className=\"text-2xl font-bold text-green-500\">{pkg.usedSessions || 0}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">Terpakai</p>\n                      </div>\n                      <div className=\"space-y-1\">\n                        <p className=\"text-2xl font-bold text-blue-500\">{pkg.remainingSessions}</p>\n                        <p className=\"text-xs text-gray-500 dark:text-gray-400\">Sisa</p>\n                      </div>\n                    </div>\n                    \n                    {pkg.remainingSessions > 0 && (\n                      <Button \n                        className=\"w-full bg-yellow-500 hover:bg-yellow-600 text-white\"\n                        onClick={() => {\n                          setSelectedPackage(pkg);\n                          setShowScheduleModal(true);\n                        }}\n                        data-testid={`button-schedule-${pkg.id}`}\n                      >\n                        <Plus className=\"h-4 w-4 mr-2\" />\n                        Jadwalkan Sesi\n                      </Button>\n                    )}\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"py-8 text-center text-gray-500 dark:text-gray-400\">\n                <Dumbbell className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                <p>Belum ada paket PT aktif</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        {/* Upcoming & Past Sessions */}\n        <div>\n          <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5 text-yellow-500\" />\n            Jadwal Sesi\n          </h2>\n\n          {sessions && sessions.length > 0 ? (\n            <div className=\"space-y-3\">\n              {sessions.map((session) => {\n                const isUpcoming = new Date(session.sessionDate) > new Date();\n                const canCheckIn = isUpcoming && session.status === 'scheduled';\n                \n                return (\n                  <Card key={session.id} className=\"overflow-hidden\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center justify-between p-4 sm:p-6 gap-4\">\n                      <div className=\"flex-1 space-y-2\">\n                        <div className=\"flex items-center gap-2 flex-wrap\">\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            Sesi #{session.sessionNumber}\n                          </Badge>\n                          {getStatusBadge(session.status)}\n                          {session.adminConfirmed && (\n                            <Badge variant=\"success\" className=\"text-xs\">\n                              <CheckCircle2 className=\"h-3 w-3 mr-1\" />\n                              Terkonfirmasi\n                            </Badge>\n                          )}\n                        </div>\n                        \n                        <div className=\"space-y-1\">\n                          <p className=\"font-semibold text-gray-900 dark:text-white\">\n                            {session.trainer.name}\n                          </p>\n                          <div className=\"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400\">\n                            <Clock className=\"h-4 w-4\" />\n                            {format(new Date(session.sessionDate), \"dd MMM yyyy, HH:mm\")}\n                          </div>\n                        </div>\n\n                        {session.notes && (\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                            {session.notes}\n                          </p>\n                        )}\n                      </div>\n\n                      <div className=\"flex sm:flex-col gap-2\">\n                        {canCheckIn && !session.adminConfirmed && (\n                          <Button\n                            size=\"sm\"\n                            className=\"bg-green-500 hover:bg-green-600 text-white flex-1 sm:flex-none\"\n                            onClick={() => handleCheckIn(session.id)}\n                            disabled={checkInMutation.isPending}\n                            data-testid={`button-checkin-${session.id}`}\n                          >\n                            <CheckCircle2 className=\"h-4 w-4 sm:mr-2\" />\n                            <span className=\"hidden sm:inline\">Check-in</span>\n                          </Button>\n                        )}\n                        \n                        {session.adminConfirmed && (\n                          <div className=\"flex items-center gap-1 text-sm text-green-600 dark:text-green-400\">\n                            <CheckCircle2 className=\"h-4 w-4\" />\n                            <span className=\"hidden sm:inline\">Dikonfirmasi Admin</span>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </Card>\n                );\n              })}\n            </div>\n          ) : (\n            <Card>\n              <CardContent className=\"py-8 text-center text-gray-500 dark:text-gray-400\">\n                <Calendar className=\"h-12 w-12 mx-auto mb-2 opacity-50\" />\n                <p>Belum ada jadwal sesi</p>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      </div>\n\n      {/* Schedule Session Modal */}\n      <Dialog open={showScheduleModal} onOpenChange={setShowScheduleModal}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Jadwalkan Sesi PT</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4 pt-4\">\n            {selectedPackage && (\n              <div className=\"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg\">\n                <p className=\"font-semibold text-gray-900 dark:text-white\">\n                  {selectedPackage.trainer.name}\n                </p>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                  Sisa sesi: {selectedPackage.remainingSessions}\n                </p>\n              </div>\n            )}\n            \n            <div className=\"space-y-2\">\n              <Label htmlFor=\"session-date\">Tanggal & Waktu</Label>\n              <Input\n                id=\"session-date\"\n                type=\"datetime-local\"\n                value={sessionDate}\n                onChange={(e) => setSessionDate(e.target.value)}\n                data-testid=\"input-session-date\"\n              />\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"session-notes\">Catatan (Opsional)</Label>\n              <Textarea\n                id=\"session-notes\"\n                placeholder=\"Tambahkan catatan untuk sesi ini...\"\n                value={sessionNotes}\n                onChange={(e) => setSessionNotes(e.target.value)}\n                rows={3}\n                data-testid=\"input-session-notes\"\n              />\n            </div>\n\n            <div className=\"flex gap-2 pt-2\">\n              <Button\n                variant=\"outline\"\n                className=\"flex-1\"\n                onClick={() => {\n                  setShowScheduleModal(false);\n                  setSessionDate(\"\");\n                  setSessionNotes(\"\");\n                  setSelectedPackage(null);\n                }}\n                data-testid=\"button-cancel-schedule\"\n              >\n                Batal\n              </Button>\n              <Button\n                className=\"flex-1 bg-yellow-500 hover:bg-yellow-600 text-white\"\n                onClick={handleScheduleSession}\n                disabled={scheduleSessionMutation.isPending || !sessionDate}\n                data-testid=\"button-confirm-schedule\"\n              >\n                {scheduleSessionMutation.isPending ? \"Menjadwalkan...\" : \"Jadwalkan\"}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <BottomNavigation />\n    </div>\n  );\n}\n","size_bytes":15087},"client/src/lib/push-notifications.ts":{"content":"import { apiRequest } from './queryClient';\n\nconst urlBase64ToUint8Array = (base64String: string): Uint8Array => {\n  const padding = '='.repeat((4 - base64String.length % 4) % 4);\n  const base64 = (base64String + padding)\n    .replace(/\\-/g, '+')\n    .replace(/_/g, '/');\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n};\n\nexport const registerServiceWorker = async (): Promise<ServiceWorkerRegistration | null> => {\n  if (!('serviceWorker' in navigator)) {\n    console.log('Service Worker tidak didukung browser ini');\n    return null;\n  }\n\n  try {\n    const registration = await navigator.serviceWorker.register('/sw.js', {\n      scope: '/',\n    });\n    console.log('Service Worker berhasil didaftarkan');\n    return registration;\n  } catch (error) {\n    console.error('Gagal mendaftarkan Service Worker:', error);\n    return null;\n  }\n};\n\nexport const subscribeToPushNotifications = async (): Promise<boolean> => {\n  try {\n    const permission = await Notification.requestPermission();\n    \n    if (permission !== 'granted') {\n      console.log('Notifikasi permission ditolak');\n      return false;\n    }\n\n    const registration = await navigator.serviceWorker.ready;\n    \n    const response = await fetch('/api/push/public-key');\n    const { publicKey } = await response.json();\n    \n    if (!publicKey) {\n      throw new Error('VAPID public key tidak tersedia');\n    }\n\n    const subscription = await registration.pushManager.subscribe({\n      userVisibleOnly: true,\n      applicationServerKey: urlBase64ToUint8Array(publicKey),\n    });\n\n    const p256dh = subscription.getKey('p256dh');\n    const auth = subscription.getKey('auth');\n    \n    await apiRequest('POST', '/api/push/subscribe', {\n      endpoint: subscription.endpoint,\n      keys: {\n        p256dh: btoa(String.fromCharCode.apply(null, Array.from(new Uint8Array(p256dh!)))),\n        auth: btoa(String.fromCharCode.apply(null, Array.from(new Uint8Array(auth!)))),\n      },\n    });\n\n    console.log('Push subscription berhasil');\n    return true;\n  } catch (error) {\n    console.error('Error subscribing to push notifications:', error);\n    return false;\n  }\n};\n\nexport const unsubscribeFromPushNotifications = async (): Promise<boolean> => {\n  try {\n    const registration = await navigator.serviceWorker.ready;\n    const subscription = await registration.pushManager.getSubscription();\n    \n    if (!subscription) {\n      return false;\n    }\n\n    await apiRequest('DELETE', '/api/push/unsubscribe', {\n      endpoint: subscription.endpoint,\n    });\n\n    await subscription.unsubscribe();\n    \n    console.log('Push subscription dibatalkan');\n    return true;\n  } catch (error) {\n    console.error('Error unsubscribing from push notifications:', error);\n    return false;\n  }\n};\n\nexport const checkPushSubscription = async (): Promise<boolean> => {\n  try {\n    if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\n      return false;\n    }\n\n    const registration = await navigator.serviceWorker.ready;\n    const subscription = await registration.pushManager.getSubscription();\n    \n    return subscription !== null;\n  } catch (error) {\n    console.error('Error checking push subscription:', error);\n    return false;\n  }\n};\n","size_bytes":3370},"client/src/components/push-notification-toggle.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Bell, BellOff } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { \n  subscribeToPushNotifications, \n  unsubscribeFromPushNotifications,\n  checkPushSubscription,\n  registerServiceWorker\n} from '@/lib/push-notifications';\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from '@/components/ui/card';\nimport { Switch } from '@/components/ui/switch';\n\nexport default function PushNotificationToggle() {\n  const [isSubscribed, setIsSubscribed] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSupported, setIsSupported] = useState(true);\n  const { toast } = useToast();\n\n  useEffect(() => {\n    const initPushNotifications = async () => {\n      if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\n        setIsSupported(false);\n        return;\n      }\n\n      await registerServiceWorker();\n      const subscribed = await checkPushSubscription();\n      setIsSubscribed(subscribed);\n    };\n\n    initPushNotifications();\n  }, []);\n\n  const handleToggle = async () => {\n    if (!isSupported) {\n      toast({\n        title: \"Tidak Didukung\",\n        description: \"Browser Anda tidak mendukung push notifications\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      if (isSubscribed) {\n        const success = await unsubscribeFromPushNotifications();\n        if (success) {\n          setIsSubscribed(false);\n          toast({\n            title: \"Notifikasi Dinonaktifkan\",\n            description: \"Anda tidak akan menerima push notifications\",\n          });\n        }\n      } else {\n        const success = await subscribeToPushNotifications();\n        if (success) {\n          setIsSubscribed(true);\n          toast({\n            title: \"Notifikasi Diaktifkan\",\n            description: \"Anda akan menerima push notifications untuk update penting\",\n          });\n        } else {\n          toast({\n            title: \"Gagal\",\n            description: \"Gagal mengaktifkan notifikasi. Pastikan Anda memberikan izin.\",\n            variant: \"destructive\",\n          });\n        }\n      }\n    } catch (error) {\n      console.error('Error toggling push notifications:', error);\n      toast({\n        title: \"Error\",\n        description: \"Terjadi kesalahan saat mengatur notifikasi\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  if (!isSupported) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <BellOff className=\"h-5 w-5\" />\n            Push Notifications\n          </CardTitle>\n          <CardDescription>\n            Browser Anda tidak mendukung push notifications\n          </CardDescription>\n        </CardHeader>\n      </Card>\n    );\n  }\n\n  return (\n    <Card data-testid=\"card-push-notifications\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Bell className=\"h-5 w-5\" />\n          Push Notifications\n        </CardTitle>\n        <CardDescription>\n          Terima notifikasi langsung di perangkat Anda untuk update penting\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex-1\">\n            <p className=\"text-sm font-medium\" data-testid=\"text-notification-status\">\n              {isSubscribed ? 'Aktif' : 'Nonaktif'}\n            </p>\n            <p className=\"text-sm text-muted-foreground\">\n              {isSubscribed \n                ? 'Anda akan menerima notifikasi untuk booking, membership, dan update lainnya'\n                : 'Aktifkan untuk menerima notifikasi penting'\n              }\n            </p>\n          </div>\n          <Switch\n            checked={isSubscribed}\n            onCheckedChange={handleToggle}\n            disabled={isLoading}\n            data-testid=\"switch-push-notifications\"\n          />\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","size_bytes":4109},"client/public/sw.js":{"content":"self.addEventListener('push', function(event) {\n  const data = event.data ? event.data.json() : {};\n  const title = data.title || 'Notifikasi Baru';\n  const options = {\n    body: data.message || data.body || 'Anda memiliki notifikasi baru',\n    icon: '/icon-192.png',\n    badge: '/badge-72.png',\n    data: {\n      url: data.url || '/',\n      notificationId: data.notificationId,\n    },\n    tag: data.tag || 'notification',\n    requireInteraction: false,\n  };\n\n  event.waitUntil(\n    self.registration.showNotification(title, options)\n  );\n});\n\nself.addEventListener('notificationclick', function(event) {\n  event.notification.close();\n  \n  const urlToOpen = event.notification.data?.url || '/';\n  \n  event.waitUntil(\n    clients.matchAll({ type: 'window', includeUncontrolled: true })\n      .then(function(clientList) {\n        for (let i = 0; i < clientList.length; i++) {\n          const client = clientList[i];\n          if (client.url === urlToOpen && 'focus' in client) {\n            return client.focus();\n          }\n        }\n        if (clients.openWindow) {\n          return clients.openWindow(urlToOpen);\n        }\n      })\n  );\n});\n\nself.addEventListener('pushsubscriptionchange', function(event) {\n  event.waitUntil(\n    self.registration.pushManager.subscribe({\n      userVisibleOnly: true,\n      applicationServerKey: self.vapidPublicKey\n    }).then(function(subscription) {\n      return fetch('/api/push/subscribe', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(subscription),\n      });\n    })\n  );\n});\n","size_bytes":1604},"server/push.ts":{"content":"import webpush from 'web-push';\nimport { storage } from './storage';\nimport type { InsertNotification } from '@shared/schema';\n\nconst vapidPublicKey = process.env.VAPID_PUBLIC_KEY;\nconst vapidPrivateKey = process.env.VAPID_PRIVATE_KEY;\nconst vapidMailto = process.env.VAPID_MAILTO || 'mailto:admin@yourgym.com';\n\nif (vapidPublicKey && vapidPrivateKey) {\n  webpush.setVapidDetails(\n    vapidMailto,\n    vapidPublicKey,\n    vapidPrivateKey\n  );\n}\n\nexport interface PushNotificationPayload {\n  title: string;\n  message: string;\n  url?: string;\n  notificationId?: string;\n  tag?: string;\n}\n\nexport async function sendPushNotification(\n  userId: string,\n  payload: PushNotificationPayload\n): Promise<void> {\n  try {\n    if (!vapidPublicKey || !vapidPrivateKey) {\n      console.warn('VAPID keys not configured, skipping push notification');\n      return;\n    }\n\n    const subscriptions = await storage.getUserPushSubscriptions(userId);\n    \n    if (subscriptions.length === 0) {\n      console.log(`No push subscriptions found for user ${userId}`);\n      return;\n    }\n\n    const notificationData = JSON.stringify(payload);\n\n    const sendPromises = subscriptions.map(async (subscription) => {\n      try {\n        await webpush.sendNotification(\n          {\n            endpoint: subscription.endpoint,\n            keys: {\n              p256dh: subscription.p256dh,\n              auth: subscription.auth,\n            },\n          },\n          notificationData\n        );\n        console.log(`Push notification sent to ${subscription.endpoint}`);\n      } catch (error: any) {\n        console.error(`Error sending push notification to ${subscription.endpoint}:`, error);\n        \n        if (error.statusCode === 404 || error.statusCode === 410) {\n          console.log(`Subscription expired, removing: ${subscription.endpoint}`);\n          await storage.deletePushSubscription(subscription.endpoint, userId);\n        }\n      }\n    });\n\n    await Promise.allSettled(sendPromises);\n  } catch (error) {\n    console.error('Error in sendPushNotification:', error);\n  }\n}\n\nexport async function sendNotificationWithPush(\n  userId: string,\n  notification: InsertNotification\n): Promise<void> {\n  try {\n    const createdNotification = await storage.createNotification(notification);\n\n    await sendPushNotification(userId, {\n      title: notification.title,\n      message: notification.message,\n      url: '/',\n      notificationId: createdNotification.id,\n      tag: notification.type,\n    });\n  } catch (error) {\n    console.error('Error in sendNotificationWithPush:', error);\n  }\n}\n","size_bytes":2569},"client/src/components/CameraSelfie.tsx":{"content":"import { useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Camera, CheckCircle2, RotateCcw } from \"lucide-react\";\n\ninterface CameraSelfieProps {\n  onCapture: (imageData: string) => void;\n  capturedImage: string | null;\n}\n\nexport default function CameraSelfie({ onCapture, capturedImage }: CameraSelfieProps) {\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const compressImage = (file: File): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        const img = new Image();\n        img.onload = () => {\n          const canvas = document.createElement('canvas');\n          \n          // Set max dimensions\n          const MAX_WIDTH = 800;\n          const MAX_HEIGHT = 800;\n          \n          let width = img.width;\n          let height = img.height;\n          \n          // Calculate new dimensions\n          if (width > height) {\n            if (width > MAX_WIDTH) {\n              height = height * (MAX_WIDTH / width);\n              width = MAX_WIDTH;\n            }\n          } else {\n            if (height > MAX_HEIGHT) {\n              width = width * (MAX_HEIGHT / height);\n              height = MAX_HEIGHT;\n            }\n          }\n          \n          canvas.width = width;\n          canvas.height = height;\n          \n          const ctx = canvas.getContext('2d');\n          if (ctx) {\n            ctx.drawImage(img, 0, 0, width, height);\n            // Compress with quality 0.7 (70%)\n            const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.7);\n            resolve(compressedDataUrl);\n          } else {\n            reject(new Error('Failed to get canvas context'));\n          }\n        };\n        img.onerror = () => reject(new Error('Failed to load image'));\n        img.src = e.target?.result as string;\n      };\n      reader.onerror = () => reject(new Error('Failed to read file'));\n      reader.readAsDataURL(file);\n    });\n  };\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      try {\n        const compressedImage = await compressImage(file);\n        onCapture(compressedImage);\n      } catch (error) {\n        console.error('Error compressing image:', error);\n        // Fallback to original\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          const imageData = event.target?.result as string;\n          onCapture(imageData);\n        };\n        reader.readAsDataURL(file);\n      }\n    }\n  };\n\n  const retakePhoto = () => {\n    onCapture(\"\");\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  if (capturedImage) {\n    return (\n      <div className=\"space-y-4\">\n        <div className=\"relative rounded-lg overflow-hidden bg-gray-100 dark:bg-gray-800\">\n          <img\n            src={capturedImage}\n            alt=\"Selfie preview\"\n            className=\"w-full h-auto object-contain mx-auto\"\n            style={{ maxHeight: \"400px\" }}\n          />\n          <div className=\"absolute top-3 right-3 bg-green-500 text-white rounded-full p-2 shadow-lg\">\n            <CheckCircle2 className=\"h-5 w-5\" />\n          </div>\n        </div>\n        <Button\n          type=\"button\"\n          onClick={retakePhoto}\n          variant=\"outline\"\n          className=\"w-full border-yellow-500 text-yellow-600 hover:bg-yellow-50 dark:hover:bg-yellow-950\"\n          data-testid=\"button-retake-photo\"\n        >\n          <RotateCcw className=\"h-5 w-5 mr-2\" />\n          Ambil Ulang Foto\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"bg-gray-100 dark:bg-gray-800 rounded-lg p-8 text-center border-2 border-dashed border-gray-300 dark:border-gray-600\">\n        <Camera className=\"h-16 w-16 mx-auto mb-4 text-gray-400\" />\n        <p className=\"text-gray-600 dark:text-gray-400 mb-4\">\n          Ambil foto selfie untuk melanjutkan registrasi\n        </p>\n        <p className=\"text-sm text-gray-500 dark:text-gray-500 mb-4\">\n          Pastikan wajah Anda terlihat jelas\n        </p>\n      </div>\n\n      <input\n        ref={fileInputRef}\n        type=\"file\"\n        accept=\"image/*\"\n        capture=\"user\"\n        onChange={handleFileSelect}\n        className=\"hidden\"\n        data-testid=\"input-camera-file\"\n      />\n      \n      <Button\n        type=\"button\"\n        onClick={() => fileInputRef.current?.click()}\n        className=\"w-full bg-yellow-500 hover:bg-yellow-600 text-white h-12\"\n        data-testid=\"button-take-selfie\"\n      >\n        <Camera className=\"h-5 w-5 mr-2\" />\n        Ambil Foto Selfie\n      </Button>\n    </div>\n  );\n}\n","size_bytes":4709},"client/src/components/checkin-notification-popup.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { CheckCircle2, XCircle, Calendar, CreditCard, X } from \"lucide-react\";\nimport { format, differenceInDays } from \"date-fns\";\nimport { cn } from \"@/lib/utils\";\n\ninterface CheckInNotificationProps {\n  show: boolean;\n  data: any;\n  onClose: () => void;\n}\n\nexport default function CheckInNotificationPopup({ show, data, onClose }: CheckInNotificationProps) {\n  const [visible, setVisible] = useState(false);\n\n  useEffect(() => {\n    if (show) {\n      setVisible(true);\n      // Auto close after 5 seconds\n      const timer = setTimeout(() => {\n        handleClose();\n      }, 5000);\n      return () => clearTimeout(timer);\n    }\n  }, [show]);\n\n  const handleClose = () => {\n    setVisible(false);\n    setTimeout(() => {\n      onClose();\n    }, 300);\n  };\n\n  if (!show && !visible) return null;\n\n  const isSuccess = data?.success;\n  const user = data?.user;\n  const membership = data?.membership;\n  \n  const daysUntilExpiry = membership?.endDate \n    ? differenceInDays(new Date(membership.endDate), new Date()) \n    : 0;\n\n  const getExpiryBadge = () => {\n    if (!membership?.endDate) return null;\n    \n    if (daysUntilExpiry < 0) {\n      return <Badge variant=\"destructive\" className=\"text-xs\">Expired</Badge>;\n    } else if (daysUntilExpiry <= 7) {\n      return <Badge variant=\"destructive\" className=\"text-xs\">Expiring Soon</Badge>;\n    } else if (daysUntilExpiry <= 20) {\n      return <Badge className=\"text-xs bg-yellow-500\">Active</Badge>;\n    }\n    return <Badge className=\"text-xs bg-green-500\">Active</Badge>;\n  };\n\n  return (\n    <div \n      className={cn(\n        \"fixed top-20 right-6 z-50 transition-all duration-300 transform\",\n        visible ? \"translate-x-0 opacity-100\" : \"translate-x-full opacity-0\"\n      )}\n      data-testid=\"checkin-notification-popup\"\n    >\n      <div className={cn(\n        \"w-96 rounded-2xl shadow-2xl border-2 overflow-hidden\",\n        isSuccess \n          ? \"bg-gradient-to-br from-green-50 to-emerald-50 border-green-500 dark:from-green-950/50 dark:to-emerald-950/50\" \n          : \"bg-gradient-to-br from-red-50 to-rose-50 border-red-500 dark:from-red-950/50 dark:to-rose-950/50\"\n      )}>\n        {/* Header */}\n        <div className={cn(\n          \"px-6 py-4 flex items-center justify-between\",\n          isSuccess ? \"bg-green-500\" : \"bg-red-500\"\n        )}>\n          <div className=\"flex items-center gap-3\">\n            {isSuccess ? (\n              <CheckCircle2 className=\"w-6 h-6 text-white\" data-testid=\"icon-success\" />\n            ) : (\n              <XCircle className=\"w-6 h-6 text-white\" data-testid=\"icon-error\" />\n            )}\n            <h3 className=\"text-lg font-bold text-white\" data-testid=\"text-notification-title\">\n              {isSuccess ? \"Check-in Berhasil!\" : \"Check-in Gagal\"}\n            </h3>\n          </div>\n          <button \n            onClick={handleClose}\n            className=\"text-white/80 hover:text-white transition-colors\"\n            data-testid=\"button-close-notification\"\n          >\n            <X size={20} />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-4\">\n          {/* Member Info */}\n          <div className=\"flex items-center gap-4\">\n            <div className=\"relative\">\n              <Avatar className=\"w-16 h-16 border-4 border-white dark:border-slate-800 shadow-lg\" data-testid=\"img-member-photo\">\n                <AvatarImage src={user?.profileImageUrl} />\n                <AvatarFallback className=\"text-lg font-semibold\">\n                  {`${user?.firstName?.[0] || ''}${user?.lastName?.[0] || ''}`}\n                </AvatarFallback>\n              </Avatar>\n              <div className={cn(\n                \"absolute -bottom-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center border-2 border-white dark:border-slate-800\",\n                isSuccess ? \"bg-green-500\" : \"bg-red-500\"\n              )}>\n                {isSuccess ? (\n                  <CheckCircle2 className=\"w-3.5 h-3.5 text-white\" />\n                ) : (\n                  <XCircle className=\"w-3.5 h-3.5 text-white\" />\n                )}\n              </div>\n            </div>\n            \n            <div className=\"flex-1\">\n              <h4 className=\"text-xl font-bold text-foreground\" data-testid=\"text-member-name\">\n                {user?.firstName} {user?.lastName}\n              </h4>\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-member-email\">\n                {user?.email}\n              </p>\n            </div>\n          </div>\n\n          {/* Membership Details */}\n          {membership ? (\n            <div className=\"space-y-3 p-4 rounded-xl bg-white/60 dark:bg-slate-900/30 border border-border/50\">\n              <div className=\"flex items-center justify-between\">\n                <div className=\"flex items-center gap-2\">\n                  <div className={cn(\n                    \"w-8 h-8 rounded-lg flex items-center justify-center\",\n                    isSuccess ? \"bg-green-500/20\" : \"bg-red-500/20\"\n                  )}>\n                    <CreditCard className={cn(\n                      \"w-4 h-4\",\n                      isSuccess ? \"text-green-600 dark:text-green-400\" : \"text-red-600 dark:text-red-400\"\n                    )} />\n                  </div>\n                  <span className=\"text-sm font-medium text-foreground\">Membership</span>\n                </div>\n                {getExpiryBadge()}\n              </div>\n              \n              <div className=\"space-y-2\">\n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-xs text-muted-foreground\">Plan</span>\n                  <span className=\"text-sm font-semibold text-foreground\" data-testid=\"text-plan-name\">\n                    {membership.plan?.name || 'Unknown'}\n                  </span>\n                </div>\n                \n                <div className=\"flex justify-between items-center\">\n                  <span className=\"text-xs text-muted-foreground flex items-center gap-1\">\n                    <Calendar className=\"w-3 h-3\" />\n                    Expired Date\n                  </span>\n                  <span className={cn(\n                    \"text-sm font-semibold\",\n                    daysUntilExpiry <= 7 ? \"text-red-600 dark:text-red-400\" : \"text-foreground\"\n                  )} data-testid=\"text-expiry-date\">\n                    {format(new Date(membership.endDate), \"dd MMM yyyy\")}\n                  </span>\n                </div>\n\n                {daysUntilExpiry >= 0 && (\n                  <div className=\"flex justify-between items-center pt-2 border-t border-border/30\">\n                    <span className=\"text-xs text-muted-foreground\">Remaining</span>\n                    <span className={cn(\n                      \"text-sm font-bold\",\n                      daysUntilExpiry <= 7 ? \"text-red-600 dark:text-red-400\" : \"text-green-600 dark:text-green-400\"\n                    )} data-testid=\"text-days-remaining\">\n                      {daysUntilExpiry} days\n                    </span>\n                  </div>\n                )}\n              </div>\n            </div>\n          ) : (\n            <div className=\"p-4 rounded-xl bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-800\">\n              <p className=\"text-sm text-red-600 dark:text-red-400 text-center font-medium\">\n                {data?.message || \"Tidak ada membership aktif\"}\n              </p>\n            </div>\n          )}\n\n          {/* Timestamp */}\n          <div className=\"text-center pt-2 border-t border-border/30\">\n            <p className=\"text-xs text-muted-foreground\" data-testid=\"text-checkin-time\">\n              {data?.checkInTime ? format(new Date(data.checkInTime), \"HH:mm, dd MMMM yyyy\") : format(new Date(), \"HH:mm, dd MMMM yyyy\")}\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8053},"client/src/components/ui/member-sidebar.tsx":{"content":"import { useLocation } from \"wouter\";\nimport { \n  LayoutDashboard, \n  Dumbbell,\n  QrCode, \n  Calendar,\n  Phone,\n  X,\n  HelpCircle\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport logoPath from \"@assets/image_1759411904981.png\";\nimport { Button } from \"@/components/ui/button\";\n\ninterface MemberSidebarProps {\n  className?: string;\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport default function MemberSidebar({ className, isOpen, onClose }: MemberSidebarProps) {\n  const [location] = useLocation();\n\n  const menuItems = [\n    { href: \"/\", icon: LayoutDashboard, label: \"Dashboard\", color: \"bg-green-500/10 text-green-500\" },\n    { href: \"/my-bookings\", icon: Dumbbell, label: \"Class\", color: \"bg-purple-500/10 text-purple-500\" },\n    { href: \"/\", icon: QrCode, label: \"Check-In\", color: \"bg-yellow-500/10 text-yellow-500\", action: \"checkin\" },\n    { href: \"/my-bookings\", icon: Calendar, label: \"Booking\", color: \"bg-red-500/10 text-red-500\" },\n  ];\n\n  const handleNavClick = (e: React.MouseEvent, href: string, action?: string) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    if (action === \"checkin\") {\n      window.dispatchEvent(new CustomEvent('open-checkin'));\n    } else {\n      window.location.href = href;\n    }\n    onClose();\n  };\n\n  const handleContactUs = () => {\n    const whatsappNumber = \"6281234567890\";\n    const message = encodeURIComponent(\"Halo, saya ingin bertanya tentang Idachi Fitness\");\n    window.open(`https://wa.me/${whatsappNumber}?text=${message}`, '_blank');\n  };\n\n  return (\n    <>\n      {/* Overlay */}\n      {isOpen && (\n        <div \n          className=\"fixed inset-0 bg-black/50 z-40 lg:hidden\"\n          onClick={onClose}\n        />\n      )}\n\n      {/* Sidebar */}\n      <aside \n        className={cn(\n          \"fixed lg:sticky top-0 left-0 h-screen z-50 flex flex-col\",\n          \"bg-[#0a0e27] dark:bg-[#0a0e27]\",\n          \"transition-transform duration-200\",\n          \"w-64\",\n          isOpen ? \"translate-x-0\" : \"-translate-x-full lg:translate-x-0\",\n          className\n        )}\n      >\n        {/* Header with Logo */}\n        <div className=\"px-6 py-6 border-b border-slate-700/50\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <img \n              src={logoPath} \n              alt=\"Idachi Fitness Logo\" \n              className=\"w-12 h-12 object-contain\"\n              data-testid=\"img-sidebar-logo\"\n            />\n            <button\n              onClick={onClose}\n              className=\"lg:hidden p-1 hover:bg-slate-800 rounded text-slate-400\"\n              data-testid=\"button-close-sidebar\"\n            >\n              <X size={20} />\n            </button>\n          </div>\n          <h2 className=\"text-sm font-semibold text-white tracking-wide\">\n            IDACHI FITNESS JAKARTA\n          </h2>\n        </div>\n\n        {/* Navigation Items */}\n        <nav className=\"flex-1 px-4 py-6 space-y-2\">\n          {menuItems.map((item) => {\n            const Icon = item.icon;\n            const isActive = location === item.href;\n            \n            return (\n              <button\n                key={item.label}\n                onClick={(e) => handleNavClick(e, item.href, item.action)}\n                className={cn(\n                  \"w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all\",\n                  \"text-slate-300 hover:bg-slate-800/50\",\n                  isActive && \"bg-slate-800/50\"\n                )}\n                data-testid={`button-nav-${item.label.toLowerCase()}`}\n              >\n                <div className={cn(\"p-2 rounded-lg\", item.color)}>\n                  <Icon className=\"w-4 h-4\" />\n                </div>\n                <span className=\"font-medium text-sm\">{item.label}</span>\n              </button>\n            );\n          })}\n        </nav>\n\n        {/* Bottom Section */}\n        <div className=\"px-4 pb-6 space-y-4\">\n          <div className=\"px-4\">\n            <button\n              className=\"flex items-center gap-2 text-slate-400 hover:text-slate-300 transition-colors\"\n              data-testid=\"button-help-center\"\n            >\n              <HelpCircle className=\"w-4 h-4\" />\n              <span className=\"text-sm\">Help Center</span>\n            </button>\n          </div>\n          \n          <Button\n            onClick={handleContactUs}\n            className=\"w-full bg-green-500 hover:bg-green-600 text-white font-medium shadow-lg\"\n            size=\"lg\"\n            data-testid=\"button-contact-us\"\n          >\n            <Phone className=\"w-4 h-4 mr-2\" />\n            Contact Us\n          </Button>\n        </div>\n      </aside>\n    </>\n  );\n}\n","size_bytes":4644},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ninterface ThemeContextType {\n  theme: Theme;\n  toggleTheme: () => void;\n  setTheme: (theme: Theme) => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport function ThemeProvider({ children }: { children: React.ReactNode }) {\n  const [theme, setTheme] = useState<Theme>(() => {\n    const stored = localStorage.getItem(\"theme\");\n    if (stored === \"light\" || stored === \"dark\") {\n      return stored;\n    }\n    return window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\";\n  });\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  const toggleTheme = () => {\n    setTheme((prev) => (prev === \"light\" ? \"dark\" : \"light\"));\n  };\n\n  return (\n    <ThemeContext.Provider value={{ theme, toggleTheme, setTheme }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n}\n\nexport function useTheme() {\n  const context = useContext(ThemeContext);\n  if (!context) {\n    throw new Error(\"useTheme must be used within ThemeProvider\");\n  }\n  return context;\n}\n","size_bytes":1258},"client/src/pages/member-dashboard-old.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { isUnauthorizedError } from \"@/lib/authUtils\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport QRModal from \"@/components/qr-modal\";\nimport PaymentModal from \"@/components/payment-modal\";\nimport FeedbackModal from \"@/components/feedback-modal\";\nimport MemberSidebar from \"@/components/ui/member-sidebar\";\nimport BottomNavigation from \"@/components/ui/bottom-navigation\";\nimport {\n  CalendarCheck,\n  IdCard,\n  Users,\n  QrCode,\n  Crown,\n  CreditCard,\n  UserCog,\n  Clock,\n  TriangleAlert,\n  MessageSquarePlus,\n  Activity,\n  TrendingUp,\n  Dumbbell,\n  Menu,\n  Bell,\n  LogOut,\n} from \"lucide-react\";\n\nexport default function MemberDashboard() {\n  const { toast } = useToast();\n  const { user, isLoading, isAuthenticated } = useAuth();\n  const [showQRModal, setShowQRModal] = useState(false);\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\n  const [showFeedbackModal, setShowFeedbackModal] = useState(false);\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  useEffect(() => {\n    if (!isLoading && !isAuthenticated) {\n      toast({\n        title: \"Unauthorized\",\n        description: \"You are logged out. Logging in again...\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => {\n        window.location.href = \"/api/login\";\n      }, 500);\n      return;\n    }\n  }, [isAuthenticated, isLoading, toast]);\n\n  useEffect(() => {\n    const handleOpenCheckin = () => {\n      generateQRMutation.mutate();\n    };\n    window.addEventListener('open-checkin', handleOpenCheckin);\n    return () => window.removeEventListener('open-checkin', handleOpenCheckin);\n  }, []);\n\n  const handleLogout = async () => {\n    try {\n      await apiRequest(\"POST\", \"/api/logout\");\n      queryClient.clear();\n      window.location.href = \"/login\";\n    } catch (error) {\n      console.error(\"Logout error:\", error);\n      queryClient.clear();\n      window.location.href = \"/login\";\n    }\n  };\n\n  const { data: dashboardData, isLoading: dashboardLoading } = useQuery({\n    queryKey: [\"/api/member/dashboard\"],\n    enabled: isAuthenticated,\n    retry: false,\n  });\n\n  const { data: classes } = useQuery({\n    queryKey: [\"/api/classes\"],\n    enabled: isAuthenticated,\n    retry: false,\n  });\n\n  const { data: expiringMemberships } = useQuery({\n    queryKey: [\"/api/notifications/expiring\"],\n    enabled: isAuthenticated,\n    retry: false,\n  });\n\n  const { data: trainers } = useQuery({\n    queryKey: [\"/api/trainers\"],\n    enabled: isAuthenticated,\n    retry: false,\n  });\n\n  const [selectedTrainer, setSelectedTrainer] = useState<any>(null);\n  const [ptBookingDate, setPtBookingDate] = useState(\"\");\n  const [ptSessionCount, setPtSessionCount] = useState(1);\n  const [ptNotes, setPtNotes] = useState(\"\");\n  const [showPtBookingModal, setShowPtBookingModal] = useState(false);\n\n  const bookPtMutation = useMutation({\n    mutationFn: async (data: { trainerId: string; bookingDate: string; sessionCount?: number; notes?: string }) => {\n      const response = await apiRequest(\"POST\", \"/api/pt-bookings\", data);\n      return await response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/pt-bookings\"] });\n      setShowPtBookingModal(false);\n      setPtBookingDate(\"\");\n      setPtSessionCount(1);\n      setPtNotes(\"\");\n      setSelectedTrainer(null);\n      toast({\n        title: \"Success\",\n        description: \"PT session booked successfully!\",\n      });\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to book PT session\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const generateQRMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"POST\", \"/api/checkin/generate\");\n      return await response.json();\n    },\n    onSuccess: () => {\n      setShowQRModal(true);\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to generate QR code\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const bookClassMutation = useMutation({\n    mutationFn: async ({ classId, bookingDate }: { classId: string; bookingDate: string }) => {\n      const response = await apiRequest(\"POST\", `/api/classes/${classId}/book`, { bookingDate });\n      return await response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/member/dashboard\"] });\n      toast({\n        title: \"Success\",\n        description: \"Class booked successfully!\",\n      });\n    },\n    onError: (error) => {\n      if (isUnauthorizedError(error)) {\n        toast({\n          title: \"Unauthorized\",\n          description: \"You are logged out. Logging in again...\",\n          variant: \"destructive\",\n        });\n        setTimeout(() => {\n          window.location.href = \"/api/login\";\n        }, 500);\n        return;\n      }\n      toast({\n        title: \"Error\",\n        description: \"Failed to book class\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (isLoading || dashboardLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-background\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!user) {\n    return null;\n  }\n\n  const membership = dashboardData?.membership;\n  const checkIns = dashboardData?.checkIns || [];\n  const stats = dashboardData?.stats || {};\n  const payments = dashboardData?.payments || [];\n  const isExpiringSoon = expiringMemberships && expiringMemberships.length > 0;\n\n  const getDaysUntilExpiry = () => {\n    if (!membership?.endDate) return 0;\n    const now = new Date();\n    const expiry = new Date(membership.endDate);\n    const diffTime = expiry.getTime() - now.getTime();\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  };\n\n  const formatDuration = (checkIn: any) => {\n    if (!checkIn.checkOutTime) return \"Active\";\n    const duration = new Date(checkIn.checkOutTime).getTime() - new Date(checkIn.checkInTime).getTime();\n    const hours = Math.floor(duration / (1000 * 60 * 60));\n    const minutes = Math.floor((duration % (1000 * 60 * 60)) / (1000 * 60));\n    return `${hours}h ${minutes}m`;\n  };\n\n  const getCrowdLevel = (count: number) => {\n    if (count < 10) return { level: \"Low\", color: \"success-gradient\", text: \"Quiet time - perfect for workouts!\" };\n    if (count < 25) return { level: \"Medium\", color: \"warning-gradient\", text: \"Moderate crowd - good availability\" };\n    return { level: \"High\", color: \"danger-gradient\", text: \"Busy time - popular hours\" };\n  };\n\n  const crowdCount = stats.currentCrowd || 0;\n  const crowdInfo = getCrowdLevel(crowdCount);\n\n  return (\n    <div className=\"flex h-screen overflow-hidden bg-slate-50 dark:bg-slate-950\">\n      <MemberSidebar isOpen={sidebarOpen} onClose={() => setSidebarOpen(false)} />\n      \n      <div className=\"flex-1 flex flex-col overflow-hidden\">\n        {/* Top Bar */}\n        <header className=\"h-16 bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between px-4 lg:px-6\">\n          <div className=\"flex items-center gap-4\">\n            <button\n              onClick={() => setSidebarOpen(!sidebarOpen)}\n              className=\"lg:hidden p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg\"\n              data-testid=\"button-toggle-sidebar\"\n            >\n              <Menu className=\"h-5 w-5 text-slate-600 dark:text-slate-400\" />\n            </button>\n            <h1 className=\"text-lg font-semibold text-slate-900 dark:text-white hidden sm:block\">\n              Dashboard\n            </h1>\n          </div>\n          \n          <div className=\"flex items-center gap-2\">\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              className=\"relative\"\n              data-testid=\"button-notifications\"\n            >\n              <Bell className=\"h-5 w-5\" />\n              {isExpiringSoon && (\n                <span className=\"absolute -top-1 -right-1 h-4 w-4 bg-red-500 rounded-full text-[10px] text-white flex items-center justify-center\">\n                  1\n                </span>\n              )}\n            </Button>\n            <Button\n              onClick={handleLogout}\n              variant=\"ghost\"\n              size=\"sm\"\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"h-5 w-5\" />\n            </Button>\n          </div>\n        </header>\n\n        {/* Main Content */}\n        <main className=\"flex-1 overflow-y-auto bg-gradient-to-br from-muted/30 via-background to-muted/20 pb-20 md:pb-0\">\n          <div className=\"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 py-4 sm:py-8\">\n        {/* Welcome Section - More Compact */}\n        <div className=\"mb-6 sm:mb-8\">\n          <div className=\"flex flex-col gap-3 sm:gap-4\">\n            <div>\n              <h1 className=\"text-xl sm:text-2xl md:text-3xl font-bold text-foreground\">\n                Hi, {user.firstName || \"Member\"}! ðŸ‘‹\n              </h1>\n              <p className=\"text-xs sm:text-sm text-muted-foreground mt-1\">Ready for your workout today?</p>\n            </div>\n            <div className=\"grid grid-cols-2 gap-2 sm:flex sm:flex-row sm:gap-3\">\n              <Button\n                onClick={() => generateQRMutation.mutate()}\n                disabled={generateQRMutation.isPending}\n                className=\"success-gradient text-white shadow-lg hover:shadow-xl transition-all\"\n                size=\"default\"\n                data-testid=\"button-generate-qr\"\n              >\n                <QrCode className=\"mr-2 h-4 w-4\" />\n                <span className=\"hidden sm:inline\">{generateQRMutation.isPending ? \"Generating...\" : \"Check-in QR\"}</span>\n                <span className=\"sm:hidden\">{generateQRMutation.isPending ? \"Generating...\" : \"Check-in\"}</span>\n              </Button>\n              <Button\n                onClick={() => setShowFeedbackModal(true)}\n                variant=\"outline\"\n                size=\"default\"\n                data-testid=\"button-feedback\"\n              >\n                <MessageSquarePlus className=\"mr-2 h-4 w-4\" />\n                Feedback\n              </Button>\n            </div>\n          </div>\n        </div>\n\n        {/* Expiring Membership Warning - More Compact */}\n        {isExpiringSoon && (\n          <Card className=\"mb-6 border-yellow-300 bg-yellow-50/80 dark:bg-yellow-950/20 dark:border-yellow-800\">\n            <CardContent className=\"p-4 flex items-start gap-3\">\n              <TriangleAlert className=\"text-yellow-600 dark:text-yellow-500 mt-0.5 flex-shrink-0\" size={20} />\n              <div className=\"flex-1 min-w-0\">\n                <h4 className=\"text-sm font-semibold text-yellow-900 dark:text-yellow-200\">\n                  Membership Expiring Soon\n                </h4>\n                <p className=\"text-sm text-yellow-800 dark:text-yellow-300 mt-0.5\">\n                  {getDaysUntilExpiry()} days left. Renew to continue your fitness journey.\n                </p>\n              </div>\n              <Button\n                onClick={() => setShowPaymentModal(true)}\n                className=\"warning-gradient text-white flex-shrink-0\"\n                size=\"sm\"\n                data-testid=\"button-renew-membership\"\n              >\n                Renew Now\n              </Button>\n            </CardContent>\n          </Card>\n        )}\n\n        {/* Quick Stats - Improved Design */}\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3 md:gap-4 mb-6 sm:mb-8\">\n          <Card className=\"border-none shadow-sm bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/40 dark:to-emerald-950/40\">\n            <CardContent className=\"p-3 sm:p-4\">\n              <div className=\"flex items-center justify-between mb-1 sm:mb-2\">\n                <div className=\"p-1.5 sm:p-2 rounded-lg bg-green-100 dark:bg-green-900/50\">\n                  <CalendarCheck className=\"h-4 w-4 sm:h-5 sm:w-5 text-green-600 dark:text-green-400\" />\n                </div>\n                <TrendingUp className=\"h-3 w-3 sm:h-4 sm:w-4 text-green-500 hidden sm:block\" />\n              </div>\n              <p className=\"text-xl sm:text-2xl font-bold text-foreground\" data-testid=\"text-monthly-checkins\">\n                {stats.monthlyCheckIns || 0}\n              </p>\n              <p className=\"text-[10px] sm:text-xs text-muted-foreground mt-0.5 sm:mt-1\">Check-ins this month</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-none shadow-sm bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/40 dark:to-indigo-950/40\">\n            <CardContent className=\"p-3 sm:p-4\">\n              <div className=\"flex items-center justify-between mb-1 sm:mb-2\">\n                <div className=\"p-1.5 sm:p-2 rounded-lg bg-blue-100 dark:bg-blue-900/50\">\n                  <IdCard className=\"h-4 w-4 sm:h-5 sm:w-5 text-blue-600 dark:text-blue-400\" />\n                </div>\n                <Activity className=\"h-3 w-3 sm:h-4 sm:w-4 text-blue-500 hidden sm:block\" />\n              </div>\n              <p className=\"text-xl sm:text-2xl font-bold text-foreground\" data-testid=\"text-days-remaining\">\n                {getDaysUntilExpiry()}\n              </p>\n              <p className=\"text-[10px] sm:text-xs text-muted-foreground mt-0.5 sm:mt-1\">Days remaining</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-none shadow-sm bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-950/40 dark:to-violet-950/40\">\n            <CardContent className=\"p-3 sm:p-4\">\n              <div className=\"flex items-center justify-between mb-1 sm:mb-2\">\n                <div className=\"p-1.5 sm:p-2 rounded-lg bg-purple-100 dark:bg-purple-900/50\">\n                  <Dumbbell className=\"h-4 w-4 sm:h-5 sm:w-5 text-purple-600 dark:text-purple-400\" />\n                </div>\n                <Users className=\"h-3 w-3 sm:h-4 sm:w-4 text-purple-500 hidden sm:block\" />\n              </div>\n              <p className=\"text-xl sm:text-2xl font-bold text-foreground\" data-testid=\"text-upcoming-classes\">\n                {stats.upcomingClasses || 0}\n              </p>\n              <p className=\"text-[10px] sm:text-xs text-muted-foreground mt-0.5 sm:mt-1\">Classes booked</p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"border-none shadow-sm bg-gradient-to-br from-orange-50 to-amber-50 dark:from-orange-950/40 dark:to-amber-950/40\">\n            <CardContent className=\"p-3 sm:p-4\">\n              <div className=\"flex items-center justify-between mb-1 sm:mb-2\">\n                <div className=\"p-1.5 sm:p-2 rounded-lg bg-orange-100 dark:bg-orange-900/50\">\n                  <Users className=\"h-4 w-4 sm:h-5 sm:w-5 text-orange-600 dark:text-orange-400\" />\n                </div>\n                <Badge variant={crowdInfo.level === \"Low\" ? \"default\" : crowdInfo.level === \"Medium\" ? \"secondary\" : \"destructive\"} className=\"text-[10px] sm:text-xs\">\n                  {crowdInfo.level}\n                </Badge>\n              </div>\n              <p className=\"text-xl sm:text-2xl font-bold text-foreground\" data-testid=\"text-crowd-count\">\n                {crowdCount}\n              </p>\n              <p className=\"text-[10px] sm:text-xs text-muted-foreground mt-0.5 sm:mt-1\">People now</p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Main Content Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6\">\n          {/* Left Column */}\n          <div className=\"lg:col-span-2 space-y-4 sm:space-y-6\">\n            {/* Check-in History - Simplified */}\n            <Card className=\"border-none shadow-sm\">\n              <CardHeader className=\"pb-2 sm:pb-3 px-4 sm:px-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle className=\"text-base sm:text-lg\">Recent Check-ins</CardTitle>\n                    <CardDescription className=\"text-xs hidden sm:block\">Your latest gym visits</CardDescription>\n                  </div>\n                  <CalendarCheck className=\"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground\" />\n                </div>\n              </CardHeader>\n              <CardContent className=\"px-3 sm:px-6 pb-4 sm:pb-6\">\n                {checkIns.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <div className=\"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-3\">\n                      <CalendarCheck className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">No check-ins yet</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Start your fitness journey today!</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3 px-4 sm:px-0\">\n                    {checkIns.slice(0, 5).map((checkIn: any) => (\n                      <div \n                        key={checkIn.id} \n                        className=\"flex items-center justify-between p-3 rounded-lg border bg-card hover:bg-accent/50 transition-colors\"\n                        data-testid={`row-checkin-${checkIn.id}`}\n                      >\n                        <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                          <div className=\"p-2 rounded-lg bg-primary/10\">\n                            <Clock className=\"h-4 w-4 text-primary\" />\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"text-sm font-medium text-foreground\">\n                              {new Date(checkIn.checkInTime).toLocaleDateString('id-ID', { \n                                day: 'numeric', \n                                month: 'short',\n                                year: 'numeric'\n                              })}\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {new Date(checkIn.checkInTime).toLocaleTimeString('id-ID', { \n                                hour: '2-digit', \n                                minute: '2-digit' \n                              })} â€¢ {formatDuration(checkIn)}\n                            </p>\n                          </div>\n                        </div>\n                        <Badge \n                          variant={checkIn.status === \"completed\" ? \"default\" : \"secondary\"} \n                          className=\"text-xs flex-shrink-0\"\n                        >\n                          {checkIn.status === \"completed\" ? \"Done\" : \"Active\"}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Gym Classes - Simplified */}\n            <Card className=\"border-none shadow-sm\">\n              <CardHeader className=\"pb-2 sm:pb-3 px-4 sm:px-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle className=\"text-base sm:text-lg\">Available Classes</CardTitle>\n                    <CardDescription className=\"text-xs hidden sm:block\">Book your next workout</CardDescription>\n                  </div>\n                  <Dumbbell className=\"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground\" />\n                </div>\n              </CardHeader>\n              <CardContent className=\"px-3 sm:px-6\">\n                {!classes || classes.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <div className=\"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-3\">\n                      <Dumbbell className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">No classes available</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Check back soon for new classes</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {classes.slice(0, 3).map((gymClass: any) => (\n                      <div \n                        key={gymClass.id} \n                        className=\"p-4 rounded-lg border bg-card hover:border-primary/50 transition-all\"\n                      >\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <div className=\"flex-1 min-w-0\">\n                            <h4 className=\"font-semibold text-foreground\">{gymClass.name}</h4>\n                            <p className=\"text-xs text-muted-foreground mt-1 line-clamp-1\">{gymClass.description}</p>\n                          </div>\n                          <Badge \n                            variant={gymClass.currentEnrollment < gymClass.maxCapacity * 0.9 ? \"default\" : \"secondary\"}\n                            className=\"ml-2 flex-shrink-0\"\n                          >\n                            {gymClass.currentEnrollment < gymClass.maxCapacity * 0.9 ? \"Available\" : \"Few Spots\"}\n                          </Badge>\n                        </div>\n                        <div className=\"flex items-center gap-4 text-xs text-muted-foreground mb-3\">\n                          <div className=\"flex items-center gap-1\">\n                            <Clock className=\"h-3 w-3\" />\n                            <span>{gymClass.schedule}</span>\n                          </div>\n                          <div className=\"flex items-center gap-1\">\n                            <Users className=\"h-3 w-3\" />\n                            <span>{gymClass.currentEnrollment}/{gymClass.maxCapacity}</span>\n                          </div>\n                        </div>\n                        <Button\n                          onClick={() => bookClassMutation.mutate({\n                            classId: gymClass.id,\n                            bookingDate: new Date().toISOString()\n                          })}\n                          disabled={bookClassMutation.isPending}\n                          className=\"w-full gym-gradient text-white\"\n                          size=\"sm\"\n                          data-testid={`button-book-class-${gymClass.id}`}\n                        >\n                          {bookClassMutation.isPending ? \"Booking...\" : \"Book Class\"}\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Personal Trainers - Simplified */}\n            <Card className=\"border-none shadow-sm\">\n              <CardHeader className=\"pb-2 sm:pb-3 px-4 sm:px-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <CardTitle className=\"text-base sm:text-lg\">Personal Trainers</CardTitle>\n                    <CardDescription className=\"text-xs hidden sm:block\">Expert guidance for your goals</CardDescription>\n                  </div>\n                  <UserCog className=\"h-4 w-4 sm:h-5 sm:w-5 text-muted-foreground\" />\n                </div>\n              </CardHeader>\n              <CardContent className=\"px-3 sm:px-6\">\n                {!trainers || trainers.length === 0 ? (\n                  <div className=\"text-center py-12\">\n                    <div className=\"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-3\">\n                      <UserCog className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">No trainers available</p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">Check back later</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {trainers.map((trainer: any) => (\n                      <div \n                        key={trainer.id} \n                        className=\"p-4 rounded-lg border bg-card hover:border-primary/50 transition-all\"\n                      >\n                        <div className=\"flex items-center gap-3 mb-3\">\n                          <Avatar className=\"h-12 w-12 border-2 border-primary/20\">\n                            <AvatarImage src={trainer.imageUrl} alt={trainer.name} />\n                            <AvatarFallback className=\"bg-primary/10 text-primary font-semibold\">\n                              {trainer.name.split(' ').map((n: string) => n[0]).join('').slice(0, 2).toUpperCase()}\n                            </AvatarFallback>\n                          </Avatar>\n                          <div className=\"flex-1 min-w-0\">\n                            <h4 className=\"font-semibold text-foreground\">{trainer.name}</h4>\n                            <p className=\"text-xs text-muted-foreground\">{trainer.specialization}</p>\n                          </div>\n                          <div className=\"text-right flex-shrink-0\">\n                            <p className=\"text-sm font-bold text-primary\">\n                              Rp{parseFloat(trainer.pricePerSession).toLocaleString('id-ID')}\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">per session</p>\n                          </div>\n                        </div>\n                        <Button\n                          onClick={() => {\n                            setSelectedTrainer(trainer);\n                            setShowPtBookingModal(true);\n                          }}\n                          variant=\"outline\"\n                          className=\"w-full\"\n                          size=\"sm\"\n                          data-testid={`button-book-trainer-${trainer.id}`}\n                        >\n                          Book Session\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Right Column */}\n          <div className=\"space-y-6\">\n            {/* Membership Status - Improved */}\n            <Card className=\"border-none shadow-sm\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg\">Membership</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {membership ? (\n                  <div className=\"space-y-4\">\n                    <div className=\"text-center pb-4 border-b\">\n                      <div className=\"inline-flex items-center justify-center w-16 h-16 rounded-full success-gradient mb-3\">\n                        <Crown className=\"h-8 w-8 text-white\" />\n                      </div>\n                      <h4 className=\"font-bold text-foreground text-lg\">{membership.plan.name}</h4>\n                      <p className=\"text-xs text-muted-foreground mt-1\">{membership.plan.description}</p>\n                    </div>\n\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between items-center py-2\">\n                        <span className=\"text-sm text-muted-foreground\">Member Since</span>\n                        <span className=\"text-sm font-medium text-foreground\">\n                          {new Date(membership.startDate).toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' })}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2\">\n                        <span className=\"text-sm text-muted-foreground\">Expires</span>\n                        <span className=\"text-sm font-medium text-foreground\">\n                          {new Date(membership.endDate).toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' })}\n                        </span>\n                      </div>\n                      <div className=\"flex justify-between items-center py-2\">\n                        <span className=\"text-sm text-muted-foreground\">Auto Renewal</span>\n                        <Badge variant={membership.autoRenewal ? \"default\" : \"secondary\"} className=\"text-xs\">\n                          {membership.autoRenewal ? \"Active\" : \"Inactive\"}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8\">\n                    <div className=\"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-3\">\n                      <Crown className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <p className=\"text-sm text-muted-foreground mb-3\">No active membership</p>\n                    <Button\n                      onClick={() => setShowPaymentModal(true)}\n                      className=\"gym-gradient text-white w-full\"\n                      data-testid=\"button-get-membership\"\n                    >\n                      Get Membership\n                    </Button>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Payment History - Improved */}\n            <Card className=\"border-none shadow-sm\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg\">Recent Payments</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {payments.length === 0 ? (\n                  <div className=\"text-center py-8\">\n                    <div className=\"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-3\">\n                      <CreditCard className=\"h-8 w-8 text-muted-foreground\" />\n                    </div>\n                    <p className=\"text-sm text-muted-foreground\">No payments yet</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {payments.slice(0, 3).map((payment: any) => (\n                      <div \n                        key={payment.id} \n                        className=\"flex items-center justify-between p-3 rounded-lg bg-muted/50\"\n                        data-testid={`payment-${payment.id}`}\n                      >\n                        <div className=\"flex items-center gap-3 flex-1 min-w-0\">\n                          <div className=\"p-2 rounded-lg bg-primary/10\">\n                            <CreditCard className=\"h-4 w-4 text-primary\" />\n                          </div>\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"text-sm font-medium text-foreground\">\n                              Rp{parseFloat(payment.amount).toLocaleString('id-ID')}\n                            </p>\n                            <p className=\"text-xs text-muted-foreground\">\n                              {new Date(payment.createdAt).toLocaleDateString('id-ID', { \n                                day: 'numeric', \n                                month: 'short' \n                              })}\n                            </p>\n                          </div>\n                        </div>\n                        <Badge \n                          variant={payment.status === \"success\" ? \"default\" : \"secondary\"}\n                          className=\"text-xs flex-shrink-0\"\n                        >\n                          {payment.status}\n                        </Badge>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Quick Actions - Simplified */}\n            <Card className=\"border-none shadow-sm\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-lg\">Quick Actions</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-2\">\n                <Button \n                  onClick={() => setShowPaymentModal(true)}\n                  variant=\"outline\" \n                  className=\"w-full justify-start\"\n                  data-testid=\"button-renew-quick\"\n                >\n                  <CreditCard className=\"mr-2 h-4 w-4\" />\n                  Renew Membership\n                </Button>\n                <Button \n                  variant=\"outline\" \n                  className=\"w-full justify-start\"\n                >\n                  <UserCog className=\"mr-2 h-4 w-4\" />\n                  Update Profile\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n          </div>\n        </main>\n\n        {/* Modals */}\n      <QRModal\n        isOpen={showQRModal}\n        onClose={() => setShowQRModal(false)}\n        qrData={generateQRMutation.data}\n      />\n\n      <PaymentModal\n        isOpen={showPaymentModal}\n        onClose={() => setShowPaymentModal(false)}\n      />\n\n      <FeedbackModal\n        open={showFeedbackModal}\n        onOpenChange={setShowFeedbackModal}\n      />\n\n      {/* PT Booking Modal */}\n      <Dialog open={showPtBookingModal} onOpenChange={setShowPtBookingModal}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Book PT Session</DialogTitle>\n            <DialogDescription>\n              Schedule a personal training session with {selectedTrainer?.name}\n            </DialogDescription>\n          </DialogHeader>\n          {selectedTrainer && (\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center gap-3 p-3 bg-muted rounded-lg\">\n                <Avatar className=\"h-12 w-12\">\n                  <AvatarImage src={selectedTrainer.imageUrl} alt={selectedTrainer.name} />\n                  <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                    {selectedTrainer.name.split(' ').map((n: string) => n[0]).join('').slice(0, 2).toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n                <div>\n                  <p className=\"font-semibold text-foreground\">{selectedTrainer.name}</p>\n                  <p className=\"text-sm text-muted-foreground\">{selectedTrainer.specialization}</p>\n                  <p className=\"text-sm font-medium text-primary\">Rp{parseFloat(selectedTrainer.pricePerSession).toLocaleString('id-ID')}/session</p>\n                </div>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"booking-date\">Booking Date & Time</Label>\n                <Input\n                  id=\"booking-date\"\n                  type=\"datetime-local\"\n                  value={ptBookingDate}\n                  onChange={(e) => setPtBookingDate(e.target.value)}\n                  required\n                  data-testid=\"input-pt-booking-date\"\n                />\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"session-count\">Jumlah Sesi</Label>\n                <Input\n                  id=\"session-count\"\n                  type=\"number\"\n                  min=\"1\"\n                  value={ptSessionCount}\n                  onChange={(e) => setPtSessionCount(parseInt(e.target.value) || 1)}\n                  required\n                  data-testid=\"input-pt-session-count\"\n                />\n                <p className=\"text-sm text-muted-foreground\">\n                  Total: Rp{(parseFloat(selectedTrainer.pricePerSession) * ptSessionCount).toLocaleString('id-ID')}\n                </p>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <Label htmlFor=\"booking-notes\">Notes (Optional)</Label>\n                <Textarea\n                  id=\"booking-notes\"\n                  placeholder=\"Any specific goals or requirements...\"\n                  value={ptNotes}\n                  onChange={(e) => setPtNotes(e.target.value)}\n                  rows={3}\n                  data-testid=\"textarea-pt-notes\"\n                />\n              </div>\n\n              <Button\n                onClick={() => {\n                  if (!ptBookingDate) {\n                    toast({\n                      title: \"Error\",\n                      description: \"Please select a date and time\",\n                      variant: \"destructive\",\n                    });\n                    return;\n                  }\n                  bookPtMutation.mutate({\n                    trainerId: selectedTrainer.id,\n                    bookingDate: ptBookingDate,\n                    sessionCount: ptSessionCount,\n                    notes: ptNotes || undefined,\n                  });\n                }}\n                disabled={bookPtMutation.isPending}\n                className=\"w-full gym-gradient text-white\"\n                data-testid=\"button-confirm-pt-booking\"\n              >\n                {bookPtMutation.isPending ? \"Booking...\" : \"Confirm Booking\"}\n              </Button>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n\n        {/* Bottom Navigation for Mobile */}\n        <BottomNavigation notificationCount={isExpiringSoon ? 1 : 0} />\n      </div>\n    </div>\n  );\n}\n","size_bytes":38576},"DEPLOYMENT.md":{"content":"# Panduan Deployment Idachi Fitness ke Server Sendiri\n\nDokumen ini menjelaskan cara menjalankan aplikasi Idachi Fitness di server Anda sendiri (VPS, cloud server, atau hosting lainnya).\n\n## ðŸ“‹ Persyaratan\n\n### Software yang Dibutuhkan\n- **Node.js** versi 18 atau lebih tinggi\n- **PostgreSQL** versi 12 atau lebih tinggi\n- **npm** atau **yarn** package manager\n- **PM2** atau process manager lainnya (opsional, untuk production)\n\n### Layanan Eksternal\n1. **PostgreSQL Database** (wajib)\n   - Bisa menggunakan Neon, Supabase, atau self-hosted\n   \n2. **Resend API** (wajib untuk fitur email)\n   - Daftar di https://resend.com\n   - Verifikasi domain untuk production\n   \n3. **Stripe** (opsional - untuk payment internasional)\n   - Daftar di https://stripe.com\n   \n4. **Midtrans** (opsional - untuk payment Indonesia)\n   - Daftar di https://midtrans.com\n\n## ðŸš€ Langkah Deployment\n\n### 1. Clone atau Upload Kode\n\nUpload semua file aplikasi ke server Anda, atau clone dari repository:\n\n```bash\n# Jika menggunakan git\ngit clone <repository-url>\ncd idachi-fitness\n\n# Atau upload manual via FTP/SFTP\n```\n\n### 2. Install Dependencies\n\n```bash\nnpm install\n```\n\n### 3. Setup Environment Variables\n\nCopy file `.env.example` menjadi `.env`:\n\n```bash\ncp .env.example .env\n```\n\nKemudian edit file `.env` dengan nilai yang sesuai:\n\n```env\n# DATABASE (WAJIB)\nDATABASE_URL=postgresql://username:password@host:port/database\n\n# SERVER\nPORT=5000\nNODE_ENV=production\nAPP_URL=https://yourdomain.com\n\n# SECURITY (WAJIB UNTUK PRODUCTION)\nSESSION_SECRET=<generate-random-string-panjang>\n\n# ADMIN\nADMIN_SECRET_KEY=<secret-key-untuk-admin-registration>\n\n# EMAIL (WAJIB UNTUK FITUR EMAIL)\nRESEND_API_KEY=re_xxxxxxxxxxxxx\nRESEND_FROM_EMAIL=noreply@yourdomain.com\n\n# PAYMENT (OPSIONAL)\nSTRIPE_SECRET_KEY=sk_live_xxxxx\nSTRIPE_PUBLIC_KEY=pk_live_xxxxx\n\nMIDTRANS_SERVER_KEY=xxxxx\nMIDTRANS_CLIENT_KEY=xxxxx\nMIDTRANS_ENVIRONMENT=production\n```\n\n#### Generate SESSION_SECRET\n\nGunakan command berikut untuk generate random string yang aman:\n\n```bash\nopenssl rand -base64 32\n```\n\n### 4. Setup Database\n\nPastikan PostgreSQL sudah running dan buat database baru:\n\n```sql\nCREATE DATABASE idachi_fitness;\n```\n\nKemudian jalankan migration untuk membuat tabel:\n\n```bash\nnpm run db:push\n```\n\n### 5. Setup Email (Resend)\n\n1. Daftar di https://resend.com\n2. Buat API key di https://resend.com/api-keys\n3. Verifikasi domain Anda di https://resend.com/domains\n4. Update `RESEND_API_KEY` dan `RESEND_FROM_EMAIL` di file `.env`\n\n> **Penting**: Untuk production, Anda harus verifikasi domain. Email dari \"onboarding@resend.dev\" hanya untuk development.\n\n### 6. Build Aplikasi\n\nBuild frontend dan backend:\n\n```bash\nnpm run build\n```\n\nIni akan menghasilkan:\n- `dist/public/` - Frontend files\n- `dist/index.js` - Backend server\n\n### 7. Jalankan Aplikasi\n\n#### Development Mode\n\n```bash\nnpm run dev\n```\n\n#### Production Mode\n\nMenggunakan npm:\n\n```bash\nnpm start\n```\n\nMenggunakan PM2 (recommended):\n\n```bash\n# Install PM2 globally\nnpm install -g pm2\n\n# Start aplikasi\npm2 start npm --name \"idachi-fitness\" -- start\n\n# Auto-restart on reboot\npm2 startup\npm2 save\n\n# Monitor logs\npm2 logs idachi-fitness\n```\n\n### 8. Setup Web Server (Nginx)\n\nUntuk production, gunakan Nginx sebagai reverse proxy:\n\n```nginx\nserver {\n    listen 80;\n    server_name yourdomain.com;\n\n    location / {\n        proxy_pass http://localhost:5000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n```\n\nAktifkan HTTPS dengan Let's Encrypt:\n\n```bash\nsudo certbot --nginx -d yourdomain.com\n```\n\n### 9. Firewall Configuration\n\nPastikan port yang diperlukan terbuka:\n\n```bash\n# UFW (Ubuntu)\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\nsudo ufw allow 5432/tcp  # PostgreSQL (jika database di server yang sama)\nsudo ufw enable\n```\n\n## ðŸ”§ Konfigurasi Lanjutan\n\n### Push Notifications (Opsional)\n\nJika ingin mengaktifkan push notifications:\n\n```bash\n# Generate VAPID keys\nnpx web-push generate-vapid-keys\n```\n\nTambahkan ke `.env`:\n\n```env\nVAPID_PUBLIC_KEY=<public-key>\nVAPID_PRIVATE_KEY=<private-key>\nVAPID_MAILTO=mailto:admin@yourdomain.com\n```\n\n### Payment Gateway Setup\n\n#### Stripe\n\n1. Daftar di https://dashboard.stripe.com\n2. Ambil API keys dari https://dashboard.stripe.com/apikeys\n3. Setup webhook untuk production\n\n#### Midtrans\n\n1. Daftar di https://dashboard.midtrans.com\n2. Ambil Server Key dan Client Key dari Settings > Access Keys\n3. Set `MIDTRANS_ENVIRONMENT=production` untuk live transactions\n\n## ðŸ“Š Monitoring & Maintenance\n\n### Check Status Aplikasi\n\n```bash\n# Dengan PM2\npm2 status\npm2 logs idachi-fitness\n\n# Dengan systemd\nsudo systemctl status idachi-fitness\nsudo journalctl -u idachi-fitness -f\n```\n\n### Database Backup\n\n```bash\n# Backup database\npg_dump -U username -d idachi_fitness > backup_$(date +%Y%m%d).sql\n\n# Restore database\npsql -U username -d idachi_fitness < backup_20231103.sql\n```\n\n### Update Aplikasi\n\n```bash\n# Pull latest code\ngit pull origin main\n\n# Install dependencies\nnpm install\n\n# Build\nnpm run build\n\n# Restart\npm2 restart idachi-fitness\n```\n\n## â“ Troubleshooting\n\n### Error: \"RESEND_API_KEY environment variable is required\"\n\n**Solusi**: Pastikan file `.env` berisi `RESEND_API_KEY` yang valid.\n\n### Error: \"Database connection failed\"\n\n**Solusi**: \n- Cek `DATABASE_URL` di file `.env`\n- Pastikan PostgreSQL service running: `sudo systemctl status postgresql`\n- Test koneksi: `psql -d <DATABASE_URL>`\n\n### Error: \"Port 5000 already in use\"\n\n**Solusi**: \n- Ganti `PORT` di file `.env` ke port lain (misal: 3000)\n- Atau stop aplikasi yang menggunakan port 5000\n\n### Email tidak terkirim\n\n**Solusi**:\n- Pastikan `RESEND_API_KEY` valid\n- Verifikasi domain di Resend dashboard\n- Check logs untuk error detail\n\n## ðŸ” Security Checklist\n\n- [ ] `SESSION_SECRET` diset dengan random string yang kuat\n- [ ] `NODE_ENV=production` di environment production\n- [ ] Database menggunakan password yang kuat\n- [ ] Firewall aktif dan hanya port yang diperlukan terbuka\n- [ ] SSL/HTTPS aktif menggunakan Let's Encrypt\n- [ ] Resend domain terverifikasi\n- [ ] `ADMIN_SECRET_KEY` diganti dari default value\n- [ ] File `.env` tidak di-commit ke git (ada di `.gitignore`)\n\n## ðŸ“ Catatan Penting\n\n1. **File yang Tidak Digunakan**: File `server/replitAuth.ts.disabled` adalah backup dari sistem autentikasi Replit yang sudah tidak digunakan. Bisa dihapus jika tidak diperlukan.\n\n2. **Vite Plugins**: Plugins `@replit/vite-plugin-*` hanya akan aktif jika `REPL_ID` environment variable ada. Di server sendiri, plugins ini tidak akan load - tidak masalah.\n\n3. **Database Migration**: Gunakan `npm run db:push` untuk sync schema. Untuk production yang lebih aman, pertimbangkan menggunakan migration tools.\n\n4. **Email Development**: Tanpa `RESEND_FROM_EMAIL`, sistem akan fallback ke \"onboarding@resend.dev\" yang hanya untuk development.\n\n## ðŸ’¡ Tips Optimization\n\n1. **Enable gzip compression** di Nginx\n2. **Setup database connection pooling** untuk performa lebih baik\n3. **Enable caching** untuk static assets\n4. **Monitor memory usage** dengan PM2 atau monitoring tools\n5. **Setup automated backups** untuk database\n6. **Use CDN** untuk static assets jika traffic tinggi\n\n## ðŸ“ž Bantuan\n\nJika mengalami kendala dalam deployment, check:\n- Application logs: `pm2 logs idachi-fitness`\n- Nginx logs: `/var/log/nginx/error.log`\n- PostgreSQL logs: `/var/log/postgresql/`\n\n---\n\n**Deployment berhasil?** Akses aplikasi di `https://yourdomain.com` dan test semua fitur!\n","size_bytes":7743}},"version":2}